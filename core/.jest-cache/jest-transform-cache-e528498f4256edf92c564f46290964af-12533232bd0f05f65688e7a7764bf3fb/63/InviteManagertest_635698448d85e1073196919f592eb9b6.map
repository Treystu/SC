{"file":"/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/sharing/InviteManager.test.ts","mappings":"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","names":[],"sources":["/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/sharing/InviteManager.test.ts"],"sourcesContent":["/**\n * Tests for InviteManager\n */\n\nimport { InviteManager } from './InviteManager';\nimport { generateIdentity } from '../crypto/primitives';\n\ndescribe('InviteManager', () => {\n  let inviteManager: InviteManager;\n  let identity: ReturnType<typeof generateIdentity>;\n\n  beforeEach(() => {\n    identity = generateIdentity();\n    inviteManager = new InviteManager(\n      'test-peer-id',\n      identity.publicKey,\n      identity.privateKey,\n      'Test User'\n    );\n  });\n\n  describe('Invite Creation', () => {\n    it('should create a valid invite with default TTL', async () => {\n      const invite = await inviteManager.createInvite();\n\n      expect(invite.code).toBeDefined();\n      expect(invite.code).toHaveLength(64); // 32 bytes as hex\n      expect(invite.inviterPeerId).toBe('test-peer-id');\n      expect(invite.inviterPublicKey).toEqual(identity.publicKey);\n      expect(invite.inviterName).toBe('Test User');\n      expect(invite.signature).toHaveLength(64);\n      expect(invite.expiresAt).toBeGreaterThan(invite.createdAt);\n      expect(invite.bootstrapPeers).toEqual([]);\n    });\n\n    it('should create invites with custom TTL', async () => {\n      const customTTL = 60 * 60 * 1000; // 1 hour\n      const invite = await inviteManager.createInvite({ ttl: customTTL });\n\n      expect(invite.expiresAt - invite.createdAt).toBe(customTTL);\n    });\n\n    it('should create invites with metadata', async () => {\n      const metadata = { purpose: 'testing', priority: 'high' };\n      const invite = await inviteManager.createInvite({ metadata });\n\n      expect(invite.metadata).toEqual(metadata);\n    });\n\n    it('should generate unique invite codes', async () => {\n      const invite1 = await inviteManager.createInvite();\n      const invite2 = await inviteManager.createInvite();\n\n      expect(invite1.code).not.toBe(invite2.code);\n    });\n\n    it('should store created invites', async () => {\n      const invite = await inviteManager.createInvite();\n      const retrieved = inviteManager.getInvite(invite.code);\n\n      expect(retrieved).toEqual(invite);\n    });\n  });\n\n  describe('Invite Validation', () => {\n    it('should validate a valid invite', async () => {\n      const invite = await inviteManager.createInvite();\n      const validation = await inviteManager.validateInvite(invite.code);\n\n      expect(validation.valid).toBe(true);\n      expect(validation.error).toBeUndefined();\n      expect(validation.invite).toEqual(invite);\n    });\n\n    it('should reject invalid invite codes', async () => {\n      const validation = await inviteManager.validateInvite('invalid-code');\n\n      expect(validation.valid).toBe(false);\n      expect(validation.error).toBe('Invalid invite code');\n    });\n\n    it('should reject expired invites', async () => {\n      const invite = await inviteManager.createInvite({ ttl: -1000 }); // Expired\n      const validation = await inviteManager.validateInvite(invite.code);\n\n      expect(validation.valid).toBe(false);\n      expect(validation.error).toBe('Invite expired');\n    });\n\n    it('should reject invites with invalid signatures', async () => {\n      const invite = await inviteManager.createInvite();\n      // Tamper with the signature\n      invite.signature = new Uint8Array(64);\n      \n      // Manually update the stored invite (simulating tampering)\n      const allInvites = inviteManager.getAllInvites();\n      const inviteIndex = allInvites.findIndex(i => i.code === invite.code);\n      if (inviteIndex !== -1) {\n        // Re-create manager to test with tampered data\n        const tamperedManager = new InviteManager(\n          'test-peer-id',\n          identity.publicKey,\n          identity.privateKey\n        );\n        // Manually set the invite with tampered signature\n        await tamperedManager.createInvite();\n        const invites = (tamperedManager as any).invites as Map<string, any>;\n        const storedInvite = invites.get([...invites.keys()][0]);\n        storedInvite.signature = new Uint8Array(64);\n\n        const validation = await tamperedManager.validateInvite(storedInvite.code);\n        expect(validation.valid).toBe(false);\n        expect(validation.error).toBe('Invalid signature');\n      }\n    });\n  });\n\n  describe('Invite Redemption', () => {\n    it('should successfully redeem a valid invite', async () => {\n      const invite = await inviteManager.createInvite();\n      const result = await inviteManager.redeemInvite(invite.code, 'recipient-peer-id');\n\n      expect(result.success).toBe(true);\n      expect(result.contact.peerId).toBe(invite.inviterPeerId);\n      expect(result.contact.publicKey).toEqual(invite.inviterPublicKey);\n      expect(result.contact.verified).toBe(true);\n      expect(result.contact.addedVia).toBe('invite');\n    });\n\n    it('should remove invite after redemption', async () => {\n      const invite = await inviteManager.createInvite();\n      await inviteManager.redeemInvite(invite.code, 'recipient-peer-id');\n\n      const retrieved = inviteManager.getInvite(invite.code);\n      expect(retrieved).toBeUndefined();\n    });\n\n    it('should throw error for invalid invite code', async () => {\n      await expect(\n        inviteManager.redeemInvite('invalid-code', 'recipient-peer-id')\n      ).rejects.toThrow('Invalid invite code');\n    });\n\n    it('should throw error for expired invite', async () => {\n      const invite = await inviteManager.createInvite({ ttl: -1000 });\n      \n      await expect(\n        inviteManager.redeemInvite(invite.code, 'recipient-peer-id')\n      ).rejects.toThrow('Invite expired');\n    });\n\n    it('should include inviter name in contact', async () => {\n      const invite = await inviteManager.createInvite();\n      const result = await inviteManager.redeemInvite(invite.code, 'recipient-peer-id');\n\n      expect(result.contact.name).toBe('Test User');\n    });\n  });\n\n  describe('Invite Management', () => {\n    it('should get all pending invites', async () => {\n      await inviteManager.createInvite();\n      await inviteManager.createInvite();\n      await inviteManager.createInvite();\n\n      const invites = inviteManager.getAllInvites();\n      expect(invites).toHaveLength(3);\n    });\n\n    it('should clean up expired invites', async () => {\n      // Create some invites with different expiration times\n      await inviteManager.createInvite({ ttl: -1000 }); // Expired\n      await inviteManager.createInvite({ ttl: -1000 }); // Expired\n      await inviteManager.createInvite({ ttl: 60000 }); // Valid\n\n      const removedCount = inviteManager.cleanupExpiredInvites();\n\n      expect(removedCount).toBe(2);\n      expect(inviteManager.getPendingInviteCount()).toBe(1);\n    });\n\n    it('should revoke a specific invite', async () => {\n      const invite = await inviteManager.createInvite();\n      const result = inviteManager.revokeInvite(invite.code);\n\n      expect(result).toBe(true);\n      expect(inviteManager.getInvite(invite.code)).toBeUndefined();\n    });\n\n    it('should return false when revoking non-existent invite', () => {\n      const result = inviteManager.revokeInvite('non-existent');\n      expect(result).toBe(false);\n    });\n\n    it('should revoke all invites', async () => {\n      await inviteManager.createInvite();\n      await inviteManager.createInvite();\n      await inviteManager.createInvite();\n\n      const revokedCount = inviteManager.revokeAllInvites();\n\n      expect(revokedCount).toBe(3);\n      expect(inviteManager.getPendingInviteCount()).toBe(0);\n    });\n\n    it('should track pending invite count', async () => {\n      expect(inviteManager.getPendingInviteCount()).toBe(0);\n\n      await inviteManager.createInvite();\n      expect(inviteManager.getPendingInviteCount()).toBe(1);\n\n      await inviteManager.createInvite();\n      expect(inviteManager.getPendingInviteCount()).toBe(2);\n    });\n  });\n\n  describe('Edge Cases', () => {\n    it('should handle manager without display name', async () => {\n      const manager = new InviteManager(\n        'test-peer-id',\n        identity.publicKey,\n        identity.privateKey\n      );\n\n      const invite = await manager.createInvite();\n      expect(invite.inviterName).toBe('User'); // Default name when none provided\n    });\n\n    it('should handle zero TTL', async () => {\n      const invite = await inviteManager.createInvite({ ttl: -100 });\n      const validation = await inviteManager.validateInvite(invite.code);\n\n      expect(validation.valid).toBe(false);\n      expect(validation.error).toBe('Invite expired');\n    });\n\n    it('should handle very long TTL', async () => {\n      const veryLongTTL = 365 * 24 * 60 * 60 * 1000; // 1 year\n      const invite = await inviteManager.createInvite({ ttl: veryLongTTL });\n\n      expect(invite.expiresAt - invite.createdAt).toBe(veryLongTTL);\n    });\n\n    it('should not mutate original metadata', async () => {\n      const metadata = { key: 'value' };\n      const invite = await inviteManager.createInvite({ metadata });\n\n      metadata.key = 'changed';\n      expect(invite.metadata?.key).toBe('value');\n    });\n  });\n});\n"],"version":3}