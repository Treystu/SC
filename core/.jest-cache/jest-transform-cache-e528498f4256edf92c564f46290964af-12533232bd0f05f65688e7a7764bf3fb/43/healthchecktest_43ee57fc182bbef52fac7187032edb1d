83ef7d37f96e75b227897d0619cf095e
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const health_check_js_1 = require("./health-check.js");
describe('HealthChecker', () => {
    it('should perform a health check and return a healthy result', async () => {
        const healthChecker = new health_check_js_1.HealthChecker();
        const result = await healthChecker.performHealthCheck();
        // Check that we get a result with all required fields
        expect(result).toHaveProperty('healthy');
        expect(result).toHaveProperty('status');
        expect(result).toHaveProperty('checks');
        expect(result).toHaveProperty('timestamp');
        expect(result).toHaveProperty('uptime');
        // Check that all checks are present
        expect(result.checks).toHaveProperty('crypto');
        expect(result.checks).toHaveProperty('storage');
        expect(result.checks).toHaveProperty('network');
        expect(result.checks).toHaveProperty('performance');
        // Status should be one of the valid values
        expect(['healthy', 'degraded', 'critical']).toContain(result.status);
    });
    it('should return cached results', async () => {
        const healthChecker = new health_check_js_1.HealthChecker();
        await healthChecker.performHealthCheck();
        const cached = healthChecker.getCachedResults();
        expect(cached.size).toBe(4);
    });
    it('should return uptime', async () => {
        const healthChecker = new health_check_js_1.HealthChecker();
        await new Promise(resolve => setTimeout(resolve, 100));
        const uptime = healthChecker.getUptime();
        expect(uptime).toBeGreaterThan(50);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2NocmlzdHltYXh3ZWxsL0Rlc2t0b3AvTHVrZV9TdHVmZi9HaXRIdWIvU0MvY29yZS9zcmMvaGVhbHRoLWNoZWNrLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSx1REFBa0Q7QUFFbEQsUUFBUSxDQUFDLGVBQWUsRUFBRSxHQUFHLEVBQUU7SUFDN0IsRUFBRSxDQUFDLDJEQUEyRCxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQ3pFLE1BQU0sYUFBYSxHQUFHLElBQUksK0JBQWEsRUFBRSxDQUFDO1FBQzFDLE1BQU0sTUFBTSxHQUFHLE1BQU0sYUFBYSxDQUFDLGtCQUFrQixFQUFFLENBQUM7UUFFeEQsc0RBQXNEO1FBQ3RELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDekMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUN4QyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3hDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDM0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUV4QyxvQ0FBb0M7UUFDcEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDL0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDaEQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDaEQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLENBQUM7UUFFcEQsMkNBQTJDO1FBQzNDLE1BQU0sQ0FBQyxDQUFDLFNBQVMsRUFBRSxVQUFVLEVBQUUsVUFBVSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3ZFLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLDhCQUE4QixFQUFFLEtBQUssSUFBSSxFQUFFO1FBQzVDLE1BQU0sYUFBYSxHQUFHLElBQUksK0JBQWEsRUFBRSxDQUFDO1FBQzFDLE1BQU0sYUFBYSxDQUFDLGtCQUFrQixFQUFFLENBQUM7UUFDekMsTUFBTSxNQUFNLEdBQUcsYUFBYSxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDaEQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDOUIsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsc0JBQXNCLEVBQUUsS0FBSyxJQUFJLEVBQUU7UUFDcEMsTUFBTSxhQUFhLEdBQUcsSUFBSSwrQkFBYSxFQUFFLENBQUM7UUFDMUMsTUFBTSxJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUN2RCxNQUFNLE1BQU0sR0FBRyxhQUFhLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDekMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGVBQWUsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUNyQyxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9jaHJpc3R5bWF4d2VsbC9EZXNrdG9wL0x1a2VfU3R1ZmYvR2l0SHViL1NDL2NvcmUvc3JjL2hlYWx0aC1jaGVjay50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEhlYWx0aENoZWNrZXIgfSBmcm9tICcuL2hlYWx0aC1jaGVjay5qcyc7XG5cbmRlc2NyaWJlKCdIZWFsdGhDaGVja2VyJywgKCkgPT4ge1xuICBpdCgnc2hvdWxkIHBlcmZvcm0gYSBoZWFsdGggY2hlY2sgYW5kIHJldHVybiBhIGhlYWx0aHkgcmVzdWx0JywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGhlYWx0aENoZWNrZXIgPSBuZXcgSGVhbHRoQ2hlY2tlcigpO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhlYWx0aENoZWNrZXIucGVyZm9ybUhlYWx0aENoZWNrKCk7XG4gICAgXG4gICAgLy8gQ2hlY2sgdGhhdCB3ZSBnZXQgYSByZXN1bHQgd2l0aCBhbGwgcmVxdWlyZWQgZmllbGRzXG4gICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2hlYWx0aHknKTtcbiAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnc3RhdHVzJyk7XG4gICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2NoZWNrcycpO1xuICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCd0aW1lc3RhbXAnKTtcbiAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgndXB0aW1lJyk7XG4gICAgXG4gICAgLy8gQ2hlY2sgdGhhdCBhbGwgY2hlY2tzIGFyZSBwcmVzZW50XG4gICAgZXhwZWN0KHJlc3VsdC5jaGVja3MpLnRvSGF2ZVByb3BlcnR5KCdjcnlwdG8nKTtcbiAgICBleHBlY3QocmVzdWx0LmNoZWNrcykudG9IYXZlUHJvcGVydHkoJ3N0b3JhZ2UnKTtcbiAgICBleHBlY3QocmVzdWx0LmNoZWNrcykudG9IYXZlUHJvcGVydHkoJ25ldHdvcmsnKTtcbiAgICBleHBlY3QocmVzdWx0LmNoZWNrcykudG9IYXZlUHJvcGVydHkoJ3BlcmZvcm1hbmNlJyk7XG4gICAgXG4gICAgLy8gU3RhdHVzIHNob3VsZCBiZSBvbmUgb2YgdGhlIHZhbGlkIHZhbHVlc1xuICAgIGV4cGVjdChbJ2hlYWx0aHknLCAnZGVncmFkZWQnLCAnY3JpdGljYWwnXSkudG9Db250YWluKHJlc3VsdC5zdGF0dXMpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHJldHVybiBjYWNoZWQgcmVzdWx0cycsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBoZWFsdGhDaGVja2VyID0gbmV3IEhlYWx0aENoZWNrZXIoKTtcbiAgICBhd2FpdCBoZWFsdGhDaGVja2VyLnBlcmZvcm1IZWFsdGhDaGVjaygpO1xuICAgIGNvbnN0IGNhY2hlZCA9IGhlYWx0aENoZWNrZXIuZ2V0Q2FjaGVkUmVzdWx0cygpO1xuICAgIGV4cGVjdChjYWNoZWQuc2l6ZSkudG9CZSg0KTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCByZXR1cm4gdXB0aW1lJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGhlYWx0aENoZWNrZXIgPSBuZXcgSGVhbHRoQ2hlY2tlcigpO1xuICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDApKTtcbiAgICBjb25zdCB1cHRpbWUgPSBoZWFsdGhDaGVja2VyLmdldFVwdGltZSgpO1xuICAgIGV4cGVjdCh1cHRpbWUpLnRvQmVHcmVhdGVyVGhhbig1MCk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9