{"file":"/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/file-validation.ts","mappings":"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","names":[],"sources":["/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/file-validation.ts"],"sourcesContent":["export interface FileValidationResult {\n  valid: boolean;\n  error?: string;\n  sanitizedName?: string;\n}\n\nexport const FILE_LIMITS = {\n  MAX_SIZE: 100 * 1024 * 1024, // 100MB\n  MAX_FILES_PER_MESSAGE: 10,\n  ALLOWED_TYPES: [\n    // Images\n    \"image/jpeg\",\n    \"image/png\",\n    \"image/gif\",\n    \"image/webp\",\n    // Videos\n    \"video/mp4\",\n    \"video/webm\",\n    \"video/quicktime\",\n    // Audio\n    \"audio/mpeg\",\n    \"audio/ogg\",\n    \"audio/wav\",\n    \"audio/webm\",\n    // Documents\n    \"application/pdf\",\n    \"text/plain\",\n    // Archives\n    \"application/zip\",\n    \"application/x-7z-compressed\",\n  ],\n  BLOCKED_EXTENSIONS: [\n    \".exe\",\n    \".bat\",\n    \".cmd\",\n    \".com\",\n    \".pif\",\n    \".scr\",\n    \".vbs\",\n    \".js\",\n    \".jar\",\n    \".app\",\n    \".deb\",\n    \".rpm\",\n  ],\n};\n\nexport function validateFile(file: File): FileValidationResult {\n  // Check file size\n  if (file.size > FILE_LIMITS.MAX_SIZE) {\n    return {\n      valid: false,\n      error: `File too large. Maximum size is ${FILE_LIMITS.MAX_SIZE / 1024 / 1024}MB`,\n    };\n  }\n\n  // Check file type\n  if (!FILE_LIMITS.ALLOWED_TYPES.includes(file.type)) {\n    return {\n      valid: false,\n      error: `File type not allowed: ${file.type}`,\n    };\n  }\n\n  // Check file extension\n  const extension = \".\" + file.name.split(\".\").pop()?.toLowerCase();\n  if (FILE_LIMITS.BLOCKED_EXTENSIONS.includes(extension)) {\n    return {\n      valid: false,\n      error: `File extension not allowed: ${extension}`,\n    };\n  }\n\n  // Sanitize filename\n  const sanitizedName = sanitizeFilename(file.name);\n\n  return {\n    valid: true,\n    sanitizedName,\n  };\n}\n\nexport function validateFileList(\n  files: FileList | File[],\n): FileValidationResult {\n  if (files.length > FILE_LIMITS.MAX_FILES_PER_MESSAGE) {\n    return {\n      valid: false,\n      error: `Too many files. Maximum is ${FILE_LIMITS.MAX_FILES_PER_MESSAGE} files per message`,\n    };\n  }\n\n  for (const file of Array.from(files)) {\n    const result = validateFile(file);\n    if (!result.valid) {\n      return result;\n    }\n  }\n\n  return { valid: true };\n}\n\nfunction sanitizeFilename(filename: string): string {\n  // Remove path traversal attempts\n  let sanitized = filename.replace(/\\.\\./g, \"\");\n\n  // Remove special characters except dots, dashes, underscores\n  sanitized = sanitized.replace(/[^a-zA-Z0-9.\\-_]/g, \"_\");\n\n  // Limit length\n  if (sanitized.length > 255) {\n    const ext = filename.toLowerCase().split(\".\").pop();\n    sanitized = sanitized.substring(0, 250) + \".\" + ext;\n  }\n\n  return sanitized;\n}\n"],"version":3}