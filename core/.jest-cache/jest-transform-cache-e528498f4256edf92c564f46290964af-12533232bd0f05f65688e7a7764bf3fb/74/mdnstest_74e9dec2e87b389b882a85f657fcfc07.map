{"file":"/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/discovery/mdns.test.ts","mappings":"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","names":[],"sources":["/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/discovery/mdns.test.ts"],"sourcesContent":["/**\n * Tests for mDNS/Bonjour Discovery Implementation\n */\n\nimport {\n  MDNSBroadcaster,\n  MDNSDiscoverer,\n  MDNSManager,\n  MDNSServiceInfo,\n  MDNSCapabilities,\n  MDNS_SERVICE_TYPE,\n  MDNS_DEFAULT_PORT,\n  TXT_RECORD_KEYS,\n  parseCapabilities,\n  serializeCapabilities,\n  parseTxtRecord,\n  buildTxtRecord,\n  filterService,\n} from './mdns.js';\n\ndescribe('mDNS Discovery', () => {\n  describe('parseCapabilities', () => {\n    it('should parse capability string', () => {\n      const caps = parseCapabilities('text:1,file:1,voice:0,ble:1,maxmsg:65536');\n      \n      expect(caps.text).toBe(true);\n      expect(caps.file).toBe(true);\n      expect(caps.voice).toBe(false);\n      expect(caps.ble).toBe(true);\n      expect(caps.maxMessageSize).toBe(65536);\n    });\n\n    it('should handle empty string', () => {\n      const caps = parseCapabilities('');\n      expect(Object.keys(caps)).toHaveLength(0);\n    });\n\n    it('should handle single capability', () => {\n      const caps = parseCapabilities('text:1');\n      expect(caps.text).toBe(true);\n    });\n  });\n\n  describe('serializeCapabilities', () => {\n    it('should serialize capabilities to string', () => {\n      const caps: MDNSCapabilities = {\n        text: true,\n        file: false,\n        webrtc: true,\n        maxMessageSize: 1024,\n      };\n      \n      const str = serializeCapabilities(caps);\n      \n      expect(str).toContain('text:1');\n      expect(str).toContain('file:0');\n      expect(str).toContain('rtc:1');\n      expect(str).toContain('maxmsg:1024');\n    });\n\n    it('should handle empty capabilities', () => {\n      const str = serializeCapabilities({});\n      expect(str).toBe('');\n    });\n  });\n\n  describe('parseTxtRecord', () => {\n    it('should parse TXT record to service info', () => {\n      const txtRecord = new Map([\n        [TXT_RECORD_KEYS.VERSION, '1.0'],\n        [TXT_RECORD_KEYS.PUBLIC_KEY, 'abc123'],\n        [TXT_RECORD_KEYS.INSTANCE_ID, 'test-id'],\n        [TXT_RECORD_KEYS.CAPABILITIES, 'text:1,file:1'],\n      ]);\n      \n      const parsed = parseTxtRecord(txtRecord);\n      \n      expect(parsed.version).toBe('1.0');\n      expect(parsed.publicKey).toBe('abc123');\n      expect(parsed.instanceId).toBe('test-id');\n      expect(parsed.capabilities?.text).toBe(true);\n      expect(parsed.capabilities?.file).toBe(true);\n    });\n\n    it('should handle empty TXT record', () => {\n      const parsed = parseTxtRecord(new Map());\n      expect(parsed.version).toBeUndefined();\n      expect(parsed.publicKey).toBeUndefined();\n    });\n  });\n\n  describe('buildTxtRecord', () => {\n    it('should build TXT record from config', () => {\n      const txtRecord = buildTxtRecord({\n        serviceName: 'Test',\n        publicKey: 'testkey',\n        version: '2.0',\n        instanceId: 'my-id',\n        capabilities: { text: true, voice: true },\n      });\n      \n      expect(txtRecord.get(TXT_RECORD_KEYS.VERSION)).toBe('2.0');\n      expect(txtRecord.get(TXT_RECORD_KEYS.PUBLIC_KEY)).toBe('testkey');\n      expect(txtRecord.get(TXT_RECORD_KEYS.INSTANCE_ID)).toBe('my-id');\n      expect(txtRecord.has(TXT_RECORD_KEYS.CAPABILITIES)).toBe(true);\n    });\n\n    it('should include custom TXT records', () => {\n      const txtRecord = buildTxtRecord({\n        serviceName: 'Test',\n        customTxtRecords: new Map([['custom', 'value']]),\n      });\n      \n      expect(txtRecord.get('custom')).toBe('value');\n    });\n  });\n\n  describe('filterService', () => {\n    const createService = (overrides: Partial<MDNSServiceInfo> = {}): MDNSServiceInfo => ({\n      instanceName: 'Test',\n      serviceType: MDNS_SERVICE_TYPE,\n      domain: 'local.',\n      port: 8988,\n      addresses: [],\n      txtRecord: new Map(),\n      discoveredAt: Date.now(),\n      lastSeen: Date.now(),\n      version: '1.0',\n      instanceId: 'test-id',\n      capabilities: { text: true, webrtc: true },\n      ...overrides,\n    });\n\n    it('should exclude self when configured', () => {\n      const service = createService({ instanceId: 'my-id' });\n      const result = filterService(service, {\n        excludeSelf: true,\n        selfInstanceId: 'my-id',\n      });\n      \n      expect(result).toBe(false);\n    });\n\n    it('should not exclude different instance', () => {\n      const service = createService({ instanceId: 'other-id' });\n      const result = filterService(service, {\n        excludeSelf: true,\n        selfInstanceId: 'my-id',\n      });\n      \n      expect(result).toBe(true);\n    });\n\n    it('should filter by minimum version', () => {\n      const service = createService({ version: '0.9' });\n      const result = filterService(service, { minVersion: '1.0' });\n      \n      expect(result).toBe(false);\n    });\n\n    it('should pass version check', () => {\n      const service = createService({ version: '1.0' });\n      const result = filterService(service, { minVersion: '1.0' });\n      \n      expect(result).toBe(true);\n    });\n\n    it('should filter by required capabilities', () => {\n      const service = createService({ capabilities: { text: true, voice: false } });\n      const result = filterService(service, {\n        requiredCapabilities: { voice: true },\n      });\n      \n      expect(result).toBe(false);\n    });\n\n    it('should pass capability check', () => {\n      const service = createService({ capabilities: { text: true, voice: true } });\n      const result = filterService(service, {\n        requiredCapabilities: { voice: true },\n      });\n      \n      expect(result).toBe(true);\n    });\n  });\n});\n\ndescribe('MDNSBroadcaster', () => {\n  let broadcaster: MDNSBroadcaster;\n\n  beforeEach(() => {\n    broadcaster = new MDNSBroadcaster({\n      serviceName: 'TestNode',\n      port: 9000,\n      publicKey: 'testpk',\n      capabilities: { text: true, file: true },\n      version: '1.0',\n    });\n  });\n\n  afterEach(async () => {\n    await broadcaster.stop();\n  });\n\n  describe('Lifecycle', () => {\n    it('should start advertising', async () => {\n      await broadcaster.start();\n      expect(broadcaster.getIsAdvertising()).toBe(true);\n    });\n\n    it('should stop advertising', async () => {\n      await broadcaster.start();\n      await broadcaster.stop();\n      expect(broadcaster.getIsAdvertising()).toBe(false);\n    });\n\n    it('should not start twice', async () => {\n      await broadcaster.start();\n      await broadcaster.start();\n      expect(broadcaster.getIsAdvertising()).toBe(true);\n    });\n  });\n\n  describe('TXT Record', () => {\n    it('should build TXT record', () => {\n      const txtRecord = broadcaster.getTxtRecord();\n      \n      expect(txtRecord.get(TXT_RECORD_KEYS.VERSION)).toBe('1.0');\n      expect(txtRecord.get(TXT_RECORD_KEYS.PUBLIC_KEY)).toBe('testpk');\n      expect(txtRecord.has(TXT_RECORD_KEYS.INSTANCE_ID)).toBe(true);\n    });\n\n    it('should update TXT record', async () => {\n      await broadcaster.updateTxtRecord({ publicKey: 'newkey' });\n      const txtRecord = broadcaster.getTxtRecord();\n      \n      expect(txtRecord.get(TXT_RECORD_KEYS.PUBLIC_KEY)).toBe('newkey');\n    });\n  });\n\n  describe('Service Info', () => {\n    it('should return service info', () => {\n      const info = broadcaster.getServiceInfo();\n      \n      expect(info.instanceName).toBe('TestNode');\n      expect(info.serviceType).toBe(MDNS_SERVICE_TYPE);\n      expect(info.port).toBe(9000);\n      expect(info.capabilities?.text).toBe(true);\n    });\n\n    it('should generate instance ID', () => {\n      const id = broadcaster.getInstanceId();\n      expect(id).toBeDefined();\n      expect(id.length).toBeGreaterThan(0);\n    });\n  });\n});\n\ndescribe('MDNSDiscoverer', () => {\n  let discoverer: MDNSDiscoverer;\n\n  beforeEach(() => {\n    discoverer = new MDNSDiscoverer({\n      excludeSelf: true,\n      selfInstanceId: 'my-instance',\n    });\n  });\n\n  afterEach(async () => {\n    await discoverer.stop();\n  });\n\n  describe('Lifecycle', () => {\n    it('should start discovery', async () => {\n      await discoverer.start();\n      expect(discoverer.getIsDiscovering()).toBe(true);\n    });\n\n    it('should stop discovery', async () => {\n      await discoverer.start();\n      await discoverer.stop();\n      expect(discoverer.getIsDiscovering()).toBe(false);\n    });\n  });\n\n  describe('Service Handling', () => {\n    beforeEach(async () => {\n      await discoverer.start();\n    });\n\n    it('should handle found service', () => {\n      const service: MDNSServiceInfo = {\n        instanceName: 'Peer1',\n        serviceType: MDNS_SERVICE_TYPE,\n        domain: 'local.',\n        port: 8988,\n        addresses: ['192.168.1.100'],\n        txtRecord: new Map([\n          [TXT_RECORD_KEYS.VERSION, '1.0'],\n          [TXT_RECORD_KEYS.INSTANCE_ID, 'other-instance'],\n        ]),\n        discoveredAt: Date.now(),\n        lastSeen: Date.now(),\n      };\n      \n      discoverer.handleServiceFound(service);\n      \n      expect(discoverer.getServiceCount()).toBe(1);\n      expect(discoverer.getService('Peer1')).toBeDefined();\n    });\n\n    it('should exclude self', () => {\n      const service: MDNSServiceInfo = {\n        instanceName: 'Self',\n        serviceType: MDNS_SERVICE_TYPE,\n        domain: 'local.',\n        port: 8988,\n        addresses: [],\n        txtRecord: new Map([\n          [TXT_RECORD_KEYS.INSTANCE_ID, 'my-instance'],\n        ]),\n        discoveredAt: Date.now(),\n        lastSeen: Date.now(),\n      };\n      \n      discoverer.handleServiceFound(service);\n      \n      expect(discoverer.getServiceCount()).toBe(0);\n    });\n\n    it('should update existing service', () => {\n      const service: MDNSServiceInfo = {\n        instanceName: 'Peer1',\n        serviceType: MDNS_SERVICE_TYPE,\n        domain: 'local.',\n        port: 8988,\n        addresses: ['192.168.1.100'],\n        txtRecord: new Map([\n          [TXT_RECORD_KEYS.INSTANCE_ID, 'peer1-id'],\n        ]),\n        discoveredAt: Date.now(),\n        lastSeen: Date.now(),\n      };\n      \n      discoverer.handleServiceFound(service);\n      \n      const updatedService = { ...service, addresses: ['192.168.1.101'] };\n      discoverer.handleServiceFound(updatedService);\n      \n      expect(discoverer.getServiceCount()).toBe(1);\n      const stored = discoverer.getService('Peer1');\n      expect(stored?.addresses).toContain('192.168.1.101');\n    });\n\n    it('should handle lost service', () => {\n      const service: MDNSServiceInfo = {\n        instanceName: 'Peer1',\n        serviceType: MDNS_SERVICE_TYPE,\n        domain: 'local.',\n        port: 8988,\n        addresses: [],\n        txtRecord: new Map([\n          [TXT_RECORD_KEYS.INSTANCE_ID, 'peer1-id'],\n        ]),\n        discoveredAt: Date.now(),\n        lastSeen: Date.now(),\n      };\n      \n      discoverer.handleServiceFound(service);\n      expect(discoverer.getServiceCount()).toBe(1);\n      \n      discoverer.handleServiceLost('Peer1');\n      expect(discoverer.getServiceCount()).toBe(0);\n    });\n  });\n\n  describe('Events', () => {\n    it('should emit serviceFound event', async () => {\n      await discoverer.start();\n      \n      const callback = jest.fn();\n      discoverer.onEvent(callback);\n      \n      const service: MDNSServiceInfo = {\n        instanceName: 'Peer1',\n        serviceType: MDNS_SERVICE_TYPE,\n        domain: 'local.',\n        port: 8988,\n        addresses: [],\n        txtRecord: new Map([\n          [TXT_RECORD_KEYS.INSTANCE_ID, 'peer1-id'],\n        ]),\n        discoveredAt: Date.now(),\n        lastSeen: Date.now(),\n      };\n      \n      discoverer.handleServiceFound(service);\n      \n      expect(callback).toHaveBeenCalledWith('serviceFound', expect.objectContaining({\n        instanceName: 'Peer1',\n      }), undefined);\n    });\n\n    it('should emit serviceLost event', async () => {\n      await discoverer.start();\n      \n      const callback = jest.fn();\n      \n      const service: MDNSServiceInfo = {\n        instanceName: 'Peer1',\n        serviceType: MDNS_SERVICE_TYPE,\n        domain: 'local.',\n        port: 8988,\n        addresses: [],\n        txtRecord: new Map([\n          [TXT_RECORD_KEYS.INSTANCE_ID, 'peer1-id'],\n        ]),\n        discoveredAt: Date.now(),\n        lastSeen: Date.now(),\n      };\n      \n      discoverer.handleServiceFound(service);\n      discoverer.onEvent(callback);\n      discoverer.handleServiceLost('Peer1');\n      \n      expect(callback).toHaveBeenCalledWith('serviceLost', expect.objectContaining({\n        instanceName: 'Peer1',\n      }), undefined);\n    });\n\n    it('should allow unsubscribing from events', async () => {\n      await discoverer.start();\n      \n      const callback = jest.fn();\n      const unsubscribe = discoverer.onEvent(callback);\n      \n      unsubscribe();\n      \n      const service: MDNSServiceInfo = {\n        instanceName: 'Peer1',\n        serviceType: MDNS_SERVICE_TYPE,\n        domain: 'local.',\n        port: 8988,\n        addresses: [],\n        txtRecord: new Map([\n          [TXT_RECORD_KEYS.INSTANCE_ID, 'peer1-id'],\n        ]),\n        discoveredAt: Date.now(),\n        lastSeen: Date.now(),\n      };\n      \n      discoverer.handleServiceFound(service);\n      \n      expect(callback).not.toHaveBeenCalled();\n    });\n  });\n\n  describe('Service Management', () => {\n    it('should return all services', async () => {\n      await discoverer.start();\n      \n      discoverer.handleServiceFound({\n        instanceName: 'Peer1',\n        serviceType: MDNS_SERVICE_TYPE,\n        domain: 'local.',\n        port: 8988,\n        addresses: [],\n        txtRecord: new Map([[TXT_RECORD_KEYS.INSTANCE_ID, 'p1']]),\n        discoveredAt: Date.now(),\n        lastSeen: Date.now(),\n      });\n      \n      discoverer.handleServiceFound({\n        instanceName: 'Peer2',\n        serviceType: MDNS_SERVICE_TYPE,\n        domain: 'local.',\n        port: 8989,\n        addresses: [],\n        txtRecord: new Map([[TXT_RECORD_KEYS.INSTANCE_ID, 'p2']]),\n        discoveredAt: Date.now(),\n        lastSeen: Date.now(),\n      });\n      \n      const services = discoverer.getServices();\n      expect(services).toHaveLength(2);\n    });\n\n    it('should clear services', async () => {\n      await discoverer.start();\n      \n      discoverer.handleServiceFound({\n        instanceName: 'Peer1',\n        serviceType: MDNS_SERVICE_TYPE,\n        domain: 'local.',\n        port: 8988,\n        addresses: [],\n        txtRecord: new Map([[TXT_RECORD_KEYS.INSTANCE_ID, 'p1']]),\n        discoveredAt: Date.now(),\n        lastSeen: Date.now(),\n      });\n      \n      discoverer.clearServices();\n      expect(discoverer.getServiceCount()).toBe(0);\n    });\n  });\n});\n\ndescribe('MDNSManager', () => {\n  let manager: MDNSManager;\n\n  beforeEach(() => {\n    manager = new MDNSManager();\n  });\n\n  afterEach(async () => {\n    await manager.stop();\n  });\n\n  describe('Broadcasting', () => {\n    it('should start broadcasting', async () => {\n      const broadcaster = await manager.startBroadcasting({\n        serviceName: 'TestNode',\n      });\n      \n      expect(broadcaster).toBeDefined();\n      expect(manager.getBroadcaster()).toBe(broadcaster);\n    });\n\n    it('should stop broadcasting', async () => {\n      await manager.startBroadcasting({ serviceName: 'TestNode' });\n      await manager.stopBroadcasting();\n      \n      expect(manager.getBroadcaster()).toBeNull();\n    });\n  });\n\n  describe('Discovery', () => {\n    it('should start discovery', async () => {\n      const discoverer = await manager.startDiscovery();\n      \n      expect(discoverer).toBeDefined();\n      expect(manager.getDiscoverer()).toBe(discoverer);\n    });\n\n    it('should stop discovery', async () => {\n      await manager.startDiscovery();\n      await manager.stopDiscovery();\n      \n      expect(manager.getDiscoverer()).toBeNull();\n    });\n\n    it('should exclude self when broadcasting', async () => {\n      await manager.startBroadcasting({\n        serviceName: 'TestNode',\n      });\n      const discoverer = await manager.startDiscovery();\n      \n      // The discoverer should be configured to exclude the broadcaster's instance\n      expect(discoverer.getIsDiscovering()).toBe(true);\n    });\n  });\n\n  describe('Stop All', () => {\n    it('should stop both broadcasting and discovery', async () => {\n      await manager.startBroadcasting({ serviceName: 'TestNode' });\n      await manager.startDiscovery();\n      \n      await manager.stop();\n      \n      expect(manager.getBroadcaster()).toBeNull();\n      expect(manager.getDiscoverer()).toBeNull();\n    });\n  });\n});\n\ndescribe('Constants', () => {\n  it('should have valid service type', () => {\n    expect(MDNS_SERVICE_TYPE).toBe('_sc._tcp.local.');\n  });\n\n  it('should have valid default port', () => {\n    expect(MDNS_DEFAULT_PORT).toBe(8988);\n  });\n\n  it('should have valid TXT record keys', () => {\n    expect(TXT_RECORD_KEYS.VERSION).toBe('v');\n    expect(TXT_RECORD_KEYS.PUBLIC_KEY).toBe('pk');\n    expect(TXT_RECORD_KEYS.CAPABILITIES).toBe('cap');\n    expect(TXT_RECORD_KEYS.FINGERPRINT).toBe('fp');\n    expect(TXT_RECORD_KEYS.INSTANCE_ID).toBe('id');\n  });\n});\n"],"version":3}