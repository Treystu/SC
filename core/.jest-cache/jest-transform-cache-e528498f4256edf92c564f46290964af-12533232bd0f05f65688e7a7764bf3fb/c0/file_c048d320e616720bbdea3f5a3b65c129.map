{"file":"/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/transfer/file.ts","mappings":"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","names":[],"sources":["/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/transfer/file.ts"],"sourcesContent":["/**\n * File Transfer Implementation (Tasks 184-192)\n * \n * Handles file transfer over mesh network with:\n * - Chunked transmission\n * - Resume capability\n * - Progress tracking\n * - Multiple simultaneous transfers\n */\n\nimport { MessageType as _MessageType } from '../protocol/message.js';\nimport { sha256 as computeSHA256 } from '@noble/hashes/sha2.js';\n\n// Helper to convert hash output to Uint8Array\nconst sha256 = (data: Uint8Array): Uint8Array => {\n  return computeSHA256(data);\n};\n\n// Task 184: Implement file metadata message\nexport interface FileMetadata {\n  fileId: string;\n  fileName: string;\n  fileSize: number;\n  mimeType: string;\n  chunkSize: number;\n  totalChunks: number;\n  checksum: Uint8Array;  // SHA-256 hash of complete file\n  timestamp: number;\n}\n\n// Task 185: Create chunk request protocol\nexport interface ChunkRequest {\n  fileId: string;\n  chunkIndex: number;\n  timestamp: number;\n}\n\n// Task 186: Implement chunk delivery\nexport interface FileChunk {\n  fileId: string;\n  chunkIndex: number;\n  data: Uint8Array;\n  checksum: Uint8Array;  // SHA-256 hash of chunk\n}\n\n// Task 187: Create partial file storage\nexport interface PartialFile {\n  metadata: FileMetadata;\n  receivedChunks: Set<number>;\n  chunks: Map<number, Uint8Array>;\n  startTime: number;\n  lastActivityTime: number;\n}\n\n// Task 188: Implement resume capability\nexport interface TransferState {\n  fileId: string;\n  metadata: FileMetadata;\n  progress: number;  // 0-100\n  bytesTransferred: number;\n  status: 'pending' | 'active' | 'paused' | 'completed' | 'failed' | 'cancelled';\n  error?: string;\n}\n\nexport class FileTransferManager {\n  private static readonly DEFAULT_CHUNK_SIZE = 16 * 1024; // 16KB (same as message fragmentation)\n  private static readonly MAX_CONCURRENT_TRANSFERS = 5;\n  private static readonly TRANSFER_TIMEOUT = 5 * 60 * 1000; // 5 minutes\n  \n  private activeTransfers: Map<string, TransferState> = new Map();\n  private partialFiles: Map<string, PartialFile> = new Map();\n  private transferQueue: string[] = [];\n  \n  // Task 184: Create file metadata from file\n  async createFileMetadata(\n    file: File | Uint8Array,\n    fileName: string,\n    mimeType: string\n  ): Promise<FileMetadata> {\n    const fileData = file instanceof File\n      ? new Uint8Array(await file.arrayBuffer())\n      : new Uint8Array(file);\n    const fileSize = fileData.byteLength;\n    const chunkSize = FileTransferManager.DEFAULT_CHUNK_SIZE;\n    const totalChunks = Math.ceil(fileSize / chunkSize);\n    const checksum = await sha256(fileData);\n    \n    return {\n      fileId: crypto.randomUUID(),\n      fileName,\n      fileSize,\n      mimeType,\n      chunkSize,\n      totalChunks,\n      checksum,\n      timestamp: Date.now()\n    };\n  }\n  \n  // Task 186: Split file into chunks\n  splitFileIntoChunks(fileData: Uint8Array, metadata: FileMetadata): FileChunk[] {\n    const chunks: FileChunk[] = [];\n    \n    for (let i = 0; i < metadata.totalChunks; i++) {\n      const start = i * metadata.chunkSize;\n      const end = Math.min(start + metadata.chunkSize, metadata.fileSize);\n      const chunkData = fileData.slice(start, end);\n      \n      chunks.push({\n        fileId: metadata.fileId,\n        chunkIndex: i,\n        data: chunkData,\n        checksum: sha256(chunkData)\n      });\n    }\n    \n    return chunks;\n  }\n  \n  // Task 187: Store partial file\n  initializePartialFile(metadata: FileMetadata): void {\n    this.partialFiles.set(metadata.fileId, {\n      metadata,\n      receivedChunks: new Set(),\n      chunks: new Map(),\n      startTime: Date.now(),\n      lastActivityTime: Date.now()\n    });\n    \n    this.activeTransfers.set(metadata.fileId, {\n      fileId: metadata.fileId,\n      metadata,\n      progress: 0,\n      bytesTransferred: 0,\n      status: 'pending'\n    });\n  }\n  \n  // Task 186: Process received chunk\n  async processChunk(chunk: FileChunk): Promise<void> {\n    const partial = this.partialFiles.get(chunk.fileId);\n    if (!partial) {\n      throw new Error(`Unknown file ID: ${chunk.fileId}`);\n    }\n    \n    // Verify chunk checksum\n    const computedChecksum = await sha256(chunk.data);\n    if (!this.arraysEqual(computedChecksum, chunk.checksum)) {\n      throw new Error(`Chunk checksum mismatch for chunk ${chunk.chunkIndex}`);\n    }\n    \n    // Store chunk\n    partial.chunks.set(chunk.chunkIndex, chunk.data);\n    partial.receivedChunks.add(chunk.chunkIndex);\n    partial.lastActivityTime = Date.now();\n    \n    // Update transfer state\n    this.internalUpdateTransferProgress(chunk.fileId);\n  }\n  \n  // Task 188: Update transfer progress internally\n  private internalUpdateTransferProgress(fileId: string): void {\n    const partial = this.partialFiles.get(fileId);\n    const state = this.activeTransfers.get(fileId);\n    \n    if (!partial || !state) return;\n    \n    const bytesTransferred = partial.receivedChunks.size * partial.metadata.chunkSize;\n    const progress = (partial.receivedChunks.size / partial.metadata.totalChunks) * 100;\n    \n    state.bytesTransferred = Math.min(bytesTransferred, partial.metadata.fileSize);\n    state.progress = Math.min(progress, 100);\n    state.status = progress >= 100 ? 'completed' : 'active';\n  }\n  \n  // Task 185: Get missing chunks\n  getMissingChunks(fileId: string): number[] {\n    const partial = this.partialFiles.get(fileId);\n    if (!partial) return [];\n    \n    const missing: number[] = [];\n    for (let i = 0; i < partial.metadata.totalChunks; i++) {\n      if (!partial.receivedChunks.has(i)) {\n        missing.push(i);\n      }\n    }\n    \n    return missing;\n  }\n  \n  // Task 188: Check if transfer is complete\n  isTransferComplete(fileId: string): boolean {\n    const partial = this.partialFiles.get(fileId);\n    if (!partial) return false;\n    \n    return partial.receivedChunks.size === partial.metadata.totalChunks;\n  }\n  \n  // Task 188: Reassemble file from chunks\n  async reassembleFile(fileId: string): Promise<Uint8Array> {\n    const partial = this.partialFiles.get(fileId);\n    if (!partial) {\n      throw new Error(`Unknown file ID: ${fileId}`);\n    }\n    \n    if (!this.isTransferComplete(fileId)) {\n      throw new Error(`Transfer not complete for file ${fileId}`);\n    }\n    \n    // Reassemble chunks in order\n    const fileData = new Uint8Array(partial.metadata.fileSize);\n    let offset = 0;\n    \n    for (let i = 0; i < partial.metadata.totalChunks; i++) {\n      const chunk = partial.chunks.get(i);\n      if (!chunk) {\n        throw new Error(`Missing chunk ${i}`);\n      }\n      \n      fileData.set(chunk, offset);\n      offset += chunk.length;\n    }\n    \n    // Verify file checksum\n    const computedChecksum = await sha256(fileData);\n    if (!this.arraysEqual(computedChecksum, partial.metadata.checksum)) {\n      throw new Error(`File checksum mismatch for ${fileId}`);\n    }\n    \n    return fileData;\n  }\n  \n  // Task 189: Cancel transfer\n  cancelTransfer(fileId: string): void {\n    const state = this.activeTransfers.get(fileId);\n    if (state) {\n      state.status = 'cancelled';\n    }\n    \n    this.partialFiles.delete(fileId);\n    this.transferQueue = this.transferQueue.filter(id => id !== fileId);\n    this.processQueue();\n  }\n  \n  // Task 190: Transfer queue management\n  queueTransfer(fileId: string): void {\n    const activeCount = this.getActiveTransferCount();\n    if (activeCount >= FileTransferManager.MAX_CONCURRENT_TRANSFERS) {\n      this.transferQueue.push(fileId);\n      const state = this.activeTransfers.get(fileId);\n      if (state) {\n        state.status = 'pending';\n      }\n    } else {\n      const state = this.activeTransfers.get(fileId);\n      if (state) {\n        state.status = 'active';\n      }\n    }\n  }\n  \n  // Task 190: Process transfer queue\n  processQueue(): void {\n    let activeCount = this.getActiveTransferCount();\n    while (\n      activeCount < FileTransferManager.MAX_CONCURRENT_TRANSFERS &&\n      this.transferQueue.length > 0\n    ) {\n      const fileId = this.transferQueue.shift();\n      if (fileId) {\n        const state = this.activeTransfers.get(fileId);\n        if (state) {\n          state.status = 'active';\n          activeCount++;\n        }\n      }\n    }\n  }\n  \n  // Task 192: Cleanup stale transfers\n  cleanupStaleTransfers(): void {\n    const now = Date.now();\n    \n    for (const [fileId, partial] of this.partialFiles.entries()) {\n      if (now - partial.lastActivityTime > FileTransferManager.TRANSFER_TIMEOUT) {\n        const state = this.activeTransfers.get(fileId);\n        if (state) {\n          state.status = 'failed';\n          state.error = 'Transfer timeout';\n        }\n        \n        this.partialFiles.delete(fileId);\n      }\n    }\n    \n    this.processQueue();\n  }\n  \n  // Get transfer state\n  getTransferState(fileId: string): TransferState | undefined {\n    return this.activeTransfers.get(fileId);\n  }\n  \n  // Get all active transfers\n  getAllTransfers(): TransferState[] {\n    return Array.from(this.activeTransfers.values());\n  }\n  \n  // Helper: Compare arrays\n  private arraysEqual(a: Uint8Array, b: Uint8Array): boolean {\n    if (a.length !== b.length) return false;\n    for (let i = 0; i < a.length; i++) {\n      if (a[i] !== b[i]) return false;\n    }\n    return true;\n  }\n\n  private getActiveTransferCount(): number {\n    let count = 0;\n    for (const state of this.activeTransfers.values()) {\n      if (state.status === 'active') {\n        count++;\n      }\n    }\n    return count;\n  }\n\n  // Assemble file from chunks\n  assembleFile(chunks: FileChunk[], metadata: FileMetadata): Uint8Array {\n    const fileData = new Uint8Array(metadata.fileSize);\n    let offset = 0;\n    \n    // Sort chunks by index\n    const sortedChunks = chunks.sort((a, b) => a.chunkIndex - b.chunkIndex);\n    \n    // Check all chunks are present\n    for (let i = 0; i < metadata.totalChunks; i++) {\n      if (!sortedChunks[i] || sortedChunks[i].chunkIndex !== i) {\n        throw new Error(`Missing chunk ${i}`);\n      }\n    }\n    \n    for (const chunk of sortedChunks) {\n      fileData.set(chunk.data, offset);\n      offset += chunk.data.length;\n    }\n    \n    return fileData;\n  }\n\n  // Verify file checksum\n  async verifyFileChecksum(fileData: Uint8Array, expectedChecksum: Uint8Array): Promise<boolean> {\n    const computedChecksum = sha256(fileData);\n    return this.arraysEqual(computedChecksum, expectedChecksum);\n  }\n\n  // Initialize transfer\n  initializeTransfer(metadata: FileMetadata): TransferState {\n    const state: TransferState = {\n      fileId: metadata.fileId,\n      metadata,\n      progress: 0,\n      bytesTransferred: 0,\n      status: 'pending'\n    };\n    \n    this.activeTransfers.set(metadata.fileId, state);\n    this.queueTransfer(metadata.fileId);\n    \n    return state;\n  }\n\n  // Update transfer progress (public version)\n  updateTransferProgress(fileId: string, progress: number, bytesTransferred: number): void {\n    const state = this.activeTransfers.get(fileId);\n    if (state) {\n      state.progress = progress;\n      state.bytesTransferred = bytesTransferred;\n      state.status = progress >= 100 ? 'completed' : 'active';\n      if (state.status === 'completed') {\n        this.processQueue();\n      }\n    }\n  }\n\n  // Complete transfer\n  completeTransfer(fileId: string): void {\n    const state = this.activeTransfers.get(fileId);\n    if (state) {\n      state.status = 'completed';\n      state.progress = 100;\n      this.processQueue();\n    }\n  }\n\n  // Pause transfer\n  pauseTransfer(fileId: string): void {\n    const state = this.activeTransfers.get(fileId);\n    if (state) {\n      state.status = 'paused';\n    }\n  }\n\n  // Resume transfer\n  resumeTransfer(fileId: string): void {\n    const state = this.activeTransfers.get(fileId);\n    if (state) {\n      if (this.getActiveTransferCount() >= FileTransferManager.MAX_CONCURRENT_TRANSFERS) {\n        state.status = 'pending';\n        if (!this.transferQueue.includes(fileId)) {\n          this.transferQueue.push(fileId);\n        }\n      } else {\n        state.status = 'active';\n      }\n    }\n  }\n\n  // Initialize receive\n  initializeReceive(metadata: FileMetadata): void {\n    this.initializePartialFile(metadata);\n  }\n\n  // Mark chunk as received\n  markChunkReceived(fileId: string, chunkIndex: number): void {\n    const partial = this.partialFiles.get(fileId);\n    if (partial) {\n      partial.receivedChunks.add(chunkIndex);\n      partial.lastActivityTime = Date.now();\n    }\n  }\n\n  // Check transfer timeouts\n  checkTransferTimeouts(): void {\n    this.cleanupStaleTransfers();\n  }\n}\n\n/**\n * Event names for file transfer\n */\nexport enum FileTransferEvents {\n  CHUNK_RECEIVED = 'chunk_received',\n  FILE_REASSEMBLED = 'file_reassembled',\n  PROGRESS = 'progress',\n  ERROR = 'error',\n  COMPLETE = 'complete',\n  CANCELLED = 'cancelled',\n}\n\n/**\n * Simple file transfer class with EventEmitter pattern\n * Used for peer-to-peer file transfers\n */\nexport class FileTransfer {\n  private static readonly DEFAULT_CHUNK_SIZE = 64 * 1024; // 64KB\n  private listeners: Map<string, Set<(...args: unknown[]) => void>> = new Map();\n  private sendFn: (chunk: Uint8Array, index: number, total: number) => void;\n\n  constructor(sendFn: (chunk: Uint8Array, index: number, total: number) => void) {\n    this.sendFn = sendFn;\n  }\n\n  /**\n   * Register event listener\n   */\n  on(event: FileTransferEvents | string, callback: (...args: unknown[]) => void): this {\n    if (!this.listeners.has(event)) {\n      this.listeners.set(event, new Set());\n    }\n    this.listeners.get(event)!.add(callback);\n    return this;\n  }\n\n  /**\n   * Remove event listener\n   */\n  off(event: FileTransferEvents | string, callback: (...args: unknown[]) => void): this {\n    const listeners = this.listeners.get(event);\n    if (listeners) {\n      listeners.delete(callback);\n    }\n    return this;\n  }\n\n  /**\n   * Emit event\n   */\n  emit(event: FileTransferEvents | string, ...args: unknown[]): boolean {\n    const listeners = this.listeners.get(event);\n    if (listeners && listeners.size > 0) {\n      listeners.forEach(callback => callback(...args));\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Send a file by chunking and emitting through the send function\n   */\n  sendFile(file: Uint8Array, chunkSize: number = FileTransfer.DEFAULT_CHUNK_SIZE): void {\n    const totalChunks = Math.ceil(file.length / chunkSize);\n    \n    for (let i = 0; i < totalChunks; i++) {\n      const start = i * chunkSize;\n      const end = Math.min(start + chunkSize, file.length);\n      const chunk = file.slice(start, end);\n      \n      this.sendFn(chunk, i, totalChunks);\n      this.emit(FileTransferEvents.PROGRESS, i + 1, totalChunks);\n    }\n    \n    this.emit(FileTransferEvents.COMPLETE);\n  }\n\n  /**\n   * Receive and reassemble chunks\n   */\n  private receivedChunks: Map<number, Uint8Array> = new Map();\n  private expectedTotal: number = 0;\n\n  receiveChunk(chunk: Uint8Array, index: number, total: number): void {\n    this.expectedTotal = total;\n    this.receivedChunks.set(index, chunk);\n    \n    this.emit(FileTransferEvents.CHUNK_RECEIVED, chunk, index, total);\n    \n    if (this.receivedChunks.size === total) {\n      const file = this.reassembleFile();\n      this.emit(FileTransferEvents.FILE_REASSEMBLED, file);\n    }\n  }\n\n  /**\n   * Reassemble chunks into complete file\n   */\n  private reassembleFile(): Uint8Array {\n    const chunks = [...this.receivedChunks.entries()]\n      .sort(([a], [b]) => a - b)\n      .map(([, chunk]) => chunk);\n    \n    const totalLength = chunks.reduce((acc, chunk) => acc + chunk.length, 0);\n    const file = new Uint8Array(totalLength);\n    \n    let offset = 0;\n    for (const chunk of chunks) {\n      file.set(chunk, offset);\n      offset += chunk.length;\n    }\n    \n    this.receivedChunks.clear();\n    return file;\n  }\n}\n"],"version":3}