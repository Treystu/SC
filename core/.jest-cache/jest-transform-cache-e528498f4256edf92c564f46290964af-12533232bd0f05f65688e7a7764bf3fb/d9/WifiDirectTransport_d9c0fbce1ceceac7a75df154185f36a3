feaaf208a81d9414fc3225e010cd4b35
"use strict";
/**
 * Wi-Fi Direct Transport Implementation
 *
 * A Transport abstraction for Wi-Fi Direct (Wi-Fi P2P) communication.
 * This provides a platform-agnostic interface that can be implemented
 * by platform-specific Wi-Fi Direct code (Android, iOS).
 *
 * Wi-Fi Direct enables high-bandwidth, low-latency peer-to-peer connections
 * without requiring a traditional Wi-Fi network infrastructure.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.MockWifiDirectTransport = exports.DEFAULT_WIFI_DIRECT_CONFIG = exports.WifiDirectDeviceStatus = exports.WifiDirectRole = void 0;
const Transport_js_1 = require("./Transport.js");
/**
 * Wi-Fi Direct group role
 */
var WifiDirectRole;
(function (WifiDirectRole) {
    /** Device that owns the group and acts as an access point */
    WifiDirectRole["GROUP_OWNER"] = "group_owner";
    /** Device that connects to a group owner */
    WifiDirectRole["CLIENT"] = "client";
    /** Role not yet determined */
    WifiDirectRole["UNDETERMINED"] = "undetermined";
})(WifiDirectRole || (exports.WifiDirectRole = WifiDirectRole = {}));
/**
 * Wi-Fi Direct device status
 */
var WifiDirectDeviceStatus;
(function (WifiDirectDeviceStatus) {
    WifiDirectDeviceStatus["CONNECTED"] = "connected";
    WifiDirectDeviceStatus["INVITED"] = "invited";
    WifiDirectDeviceStatus["FAILED"] = "failed";
    WifiDirectDeviceStatus["AVAILABLE"] = "available";
    WifiDirectDeviceStatus["UNAVAILABLE"] = "unavailable";
})(WifiDirectDeviceStatus || (exports.WifiDirectDeviceStatus = WifiDirectDeviceStatus = {}));
/**
 * Default Wi-Fi Direct transport configuration.
 */
exports.DEFAULT_WIFI_DIRECT_CONFIG = {
    serviceType: "_sc._tcp",
    serviceName: "SC Mesh Node",
    port: 8988,
    preferGroupOwner: false,
    groupOwnerIntent: 7,
    persistentGroup: true,
    discoveryTimeout: 30000,
    connectionTimeout: 30000,
    enableServiceDiscovery: true,
    maxPeers: 10,
    heartbeatInterval: 30000,
    options: {},
};
/**
 * Mock Wi-Fi Direct Transport for testing and web environments.
 */
class MockWifiDirectTransport {
    constructor(localPeerId, config = {}) {
        this.name = "wifi-direct";
        this.events = null;
        this.peers = new Map();
        this.discoveredDevices = new Map();
        this.isRunning = false;
        this._isDiscovering = false;
        this._role = WifiDirectRole.UNDETERMINED;
        this.discoveryInterval = null;
        this.localPeerId = localPeerId;
        this.config = { ...exports.DEFAULT_WIFI_DIRECT_CONFIG, ...config };
    }
    async start(events) {
        this.events = events;
        this.isRunning = true;
    }
    async stop() {
        await this.stopDiscovery();
        await this.removeGroup();
        this.peers.clear();
        this.discoveredDevices.clear();
        this.events = null;
        this.isRunning = false;
    }
    async connect(peerId) {
        if (!this.isRunning) {
            throw new Error("Transport not started");
        }
        const peerInfo = {
            peerId,
            state: "connecting",
            transportType: "wifi-direct",
            connectionQuality: 95,
            bytesSent: 0,
            bytesReceived: 0,
            lastSeen: Date.now(),
            role: WifiDirectRole.CLIENT,
            isGroupOwner: false,
            bandwidthMbps: 250,
        };
        this.peers.set(peerId, peerInfo);
        this.events?.onStateChange?.(peerId, "connecting");
        // Simulate connection delay
        await new Promise((resolve) => setTimeout(resolve, 200));
        peerInfo.state = "connected";
        peerInfo.ipAddress = `192.168.49.${Math.floor(Math.random() * 254) + 1}`;
        this.events?.onStateChange?.(peerId, "connected");
        this.events?.onPeerConnected?.(peerId, peerInfo);
    }
    async disconnect(peerId) {
        const peer = this.peers.get(peerId);
        if (peer) {
            peer.state = "disconnected";
            this.events?.onStateChange?.(peerId, "disconnected");
            this.events?.onPeerDisconnected?.(peerId, "disconnected");
            this.peers.delete(peerId);
        }
    }
    async send(peerId, payload) {
        const peer = this.peers.get(peerId);
        if (!peer || peer.state !== "connected") {
            throw new Error(`Peer ${peerId} not connected`);
        }
        peer.bytesSent = (peer.bytesSent || 0) + payload.length;
        peer.lastSeen = Date.now();
    }
    async broadcast(payload, excludePeerId) {
        const sendPromises = [];
        for (const [peerId, peer] of this.peers) {
            if (peerId !== excludePeerId && peer.state === "connected") {
                sendPromises.push(this.send(peerId, payload));
            }
        }
        await Promise.all(sendPromises);
    }
    getConnectedPeers() {
        return Array.from(this.peers.entries())
            .filter(([, peer]) => peer.state === "connected")
            .map(([id]) => id);
    }
    getPeerInfo(peerId) {
        return this.peers.get(peerId);
    }
    getConnectionState(peerId) {
        return this.peers.get(peerId)?.state;
    }
    // Wi-Fi Direct-specific methods
    async startDiscovery() {
        this._isDiscovering = true;
        this.events?.onDiscoveryStateChanged?.(true);
        // Simulate periodic device discovery
        this.discoveryInterval = setInterval(() => {
            const mockDevice = {
                deviceId: `mock-wfd-${Date.now()}`,
                name: `SC Peer ${Math.floor(Math.random() * 100)}`,
                status: WifiDirectDeviceStatus.AVAILABLE,
                isGroupOwner: Math.random() > 0.7,
                primaryDeviceType: "smartphone",
                lastSeen: Date.now(),
            };
            this.discoveredDevices.set(mockDevice.deviceId, mockDevice);
            this.events?.onDeviceDiscovered?.(mockDevice);
        }, 3000);
    }
    async stopDiscovery() {
        this._isDiscovering = false;
        if (this.discoveryInterval) {
            clearInterval(this.discoveryInterval);
            this.discoveryInterval = null;
        }
        this.events?.onDiscoveryStateChanged?.(false);
    }
    isDiscovering() {
        return this._isDiscovering;
    }
    getDiscoveredDevices() {
        return Array.from(this.discoveredDevices.values());
    }
    async createGroup() {
        this._role = WifiDirectRole.GROUP_OWNER;
        const ownerDevice = {
            deviceId: this.localPeerId,
            name: "This Device",
            status: WifiDirectDeviceStatus.CONNECTED,
            isGroupOwner: true,
            lastSeen: Date.now(),
        };
        this._groupInfo = {
            networkName: `DIRECT-SC-${Math.random().toString(36).slice(2, 6).toUpperCase()}`,
            passphrase: Math.random().toString(36).slice(2, 10),
            owner: ownerDevice,
            clients: [],
            isOwner: true,
            interfaceName: "p2p-wlan0-0",
            createdAt: Date.now(),
        };
        this.events?.onGroupFormed?.(this._groupInfo);
        this.events?.onRoleChanged?.(WifiDirectRole.GROUP_OWNER);
        return this._groupInfo;
    }
    async removeGroup() {
        if (this._groupInfo) {
            this._groupInfo = undefined;
            this._role = WifiDirectRole.UNDETERMINED;
            this.events?.onGroupRemoved?.();
            this.events?.onRoleChanged?.(WifiDirectRole.UNDETERMINED);
        }
    }
    getGroupInfo() {
        return this._groupInfo;
    }
    getRole() {
        return this._role;
    }
    async isWifiDirectAvailable() {
        // Mock always returns true
        return true;
    }
    async requestConnectionInfo() {
        if (!this._groupInfo) {
            return undefined;
        }
        return {
            groupOwnerAddress: "192.168.49.1", // Group owner is always at this address in P2P
            isGroupOwner: this._groupInfo.isOwner,
        };
    }
    async registerService(serviceRecord) {
        // Mock: just log the service registration
        console.log("Registered Wi-Fi Direct service:", serviceRecord);
    }
    async unregisterService() {
        // Mock: nothing to do
    }
    async discoverServices(serviceType) {
        // Mock: simulate service discovery
        console.log("Discovering Wi-Fi Direct services:", serviceType || this.config.serviceType);
    }
    getWifiDirectPeerInfo(peerId) {
        return this.peers.get(peerId);
    }
    /**
     * Simulate receiving a message from a peer.
     * Used for testing purposes.
     */
    simulateMessage(from, payload) {
        const peer = this.peers.get(from);
        if (peer) {
            peer.bytesReceived = (peer.bytesReceived || 0) + payload.length;
            peer.lastSeen = Date.now();
        }
        this.events?.onMessage({
            from,
            payload,
            timestamp: Date.now(),
        });
    }
    /**
     * Simulate an incoming connection request.
     * Used for testing purposes.
     */
    simulateConnectionRequest(device) {
        this.events?.onConnectionRequest?.(device);
    }
}
exports.MockWifiDirectTransport = MockWifiDirectTransport;
// Register the mock Wi-Fi Direct transport factory
Transport_js_1.transportRegistry.register("wifi-direct", (config) => {
    const peerId = `wfd-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`;
    return new MockWifiDirectTransport(peerId, config);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2NocmlzdHltYXh3ZWxsL0Rlc2t0b3AvTHVrZV9TdHVmZi9HaXRIdWIvU0MvY29yZS9zcmMvdHJhbnNwb3J0L1dpZmlEaXJlY3RUcmFuc3BvcnQudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7R0FTRzs7O0FBRUgsaURBUXdCO0FBRXhCOztHQUVHO0FBQ0gsSUFBWSxjQU9YO0FBUEQsV0FBWSxjQUFjO0lBQ3hCLDZEQUE2RDtJQUM3RCw2Q0FBMkIsQ0FBQTtJQUMzQiw0Q0FBNEM7SUFDNUMsbUNBQWlCLENBQUE7SUFDakIsOEJBQThCO0lBQzlCLCtDQUE2QixDQUFBO0FBQy9CLENBQUMsRUFQVyxjQUFjLDhCQUFkLGNBQWMsUUFPekI7QUFFRDs7R0FFRztBQUNILElBQVksc0JBTVg7QUFORCxXQUFZLHNCQUFzQjtJQUNoQyxpREFBdUIsQ0FBQTtJQUN2Qiw2Q0FBbUIsQ0FBQTtJQUNuQiwyQ0FBaUIsQ0FBQTtJQUNqQixpREFBdUIsQ0FBQTtJQUN2QixxREFBMkIsQ0FBQTtBQUM3QixDQUFDLEVBTlcsc0JBQXNCLHNDQUF0QixzQkFBc0IsUUFNakM7QUFvT0Q7O0dBRUc7QUFDVSxRQUFBLDBCQUEwQixHQUF3QztJQUM3RSxXQUFXLEVBQUUsVUFBVTtJQUN2QixXQUFXLEVBQUUsY0FBYztJQUMzQixJQUFJLEVBQUUsSUFBSTtJQUNWLGdCQUFnQixFQUFFLEtBQUs7SUFDdkIsZ0JBQWdCLEVBQUUsQ0FBQztJQUNuQixlQUFlLEVBQUUsSUFBSTtJQUNyQixnQkFBZ0IsRUFBRSxLQUFLO0lBQ3ZCLGlCQUFpQixFQUFFLEtBQUs7SUFDeEIsc0JBQXNCLEVBQUUsSUFBSTtJQUM1QixRQUFRLEVBQUUsRUFBRTtJQUNaLGlCQUFpQixFQUFFLEtBQUs7SUFDeEIsT0FBTyxFQUFFLEVBQUU7Q0FDWixDQUFDO0FBRUY7O0dBRUc7QUFDSCxNQUFhLHVCQUF1QjtJQWNsQyxZQUNFLFdBQTRCLEVBQzVCLFNBQW9DLEVBQUU7UUFkL0IsU0FBSSxHQUFHLGFBQWEsQ0FBQztRQUd0QixX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SUFBSSxDQUFDLE1BQU0sRUFBRSxTQUFTLENBQUM7WUFDckIsSUFBSTtZQUNKLE9BQU87WUFDUCxTQUFTLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRTtTQUN0QixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0gseUJBQXlCLENBQUMsTUFBNEI7UUFDcEQsSUFBSSxDQUFDLE1BQU0sRUFBRSxtQkFBbUIsRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQzdDLENBQUM7Q0FDRjtBQXZRRCwwREF1UUM7QUFFRCxtREFBbUQ7QUFDbkQsZ0NBQWlCLENBQUMsUUFBUSxDQUFDLGFBQWEsRUFBRSxDQUFDLE1BQXdCLEVBQUUsRUFBRTtJQUNyRSxNQUFNLE1BQU0sR0FBRyxPQUFPLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQztJQUM3RSxPQUFPLElBQUksdUJBQXVCLENBQ2hDLE1BQU0sRUFDTixNQUFtQyxDQUNwQyxDQUFDO0FBQ0osQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2NocmlzdHltYXh3ZWxsL0Rlc2t0b3AvTHVrZV9TdHVmZi9HaXRIdWIvU0MvY29yZS9zcmMvdHJhbnNwb3J0L1dpZmlEaXJlY3RUcmFuc3BvcnQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBXaS1GaSBEaXJlY3QgVHJhbnNwb3J0IEltcGxlbWVudGF0aW9uXG4gKlxuICogQSBUcmFuc3BvcnQgYWJzdHJhY3Rpb24gZm9yIFdpLUZpIERpcmVjdCAoV2ktRmkgUDJQKSBjb21tdW5pY2F0aW9uLlxuICogVGhpcyBwcm92aWRlcyBhIHBsYXRmb3JtLWFnbm9zdGljIGludGVyZmFjZSB0aGF0IGNhbiBiZSBpbXBsZW1lbnRlZFxuICogYnkgcGxhdGZvcm0tc3BlY2lmaWMgV2ktRmkgRGlyZWN0IGNvZGUgKEFuZHJvaWQsIGlPUykuXG4gKlxuICogV2ktRmkgRGlyZWN0IGVuYWJsZXMgaGlnaC1iYW5kd2lkdGgsIGxvdy1sYXRlbmN5IHBlZXItdG8tcGVlciBjb25uZWN0aW9uc1xuICogd2l0aG91dCByZXF1aXJpbmcgYSB0cmFkaXRpb25hbCBXaS1GaSBuZXR3b3JrIGluZnJhc3RydWN0dXJlLlxuICovXG5cbmltcG9ydCB7XG4gIFRyYW5zcG9ydCxcbiAgVHJhbnNwb3J0UGVlcklkLFxuICBUcmFuc3BvcnRFdmVudHMsXG4gIFRyYW5zcG9ydENvbmZpZyxcbiAgVHJhbnNwb3J0UGVlckluZm8sXG4gIFRyYW5zcG9ydENvbm5lY3Rpb25TdGF0ZSxcbiAgdHJhbnNwb3J0UmVnaXN0cnksXG59IGZyb20gXCIuL1RyYW5zcG9ydC5qc1wiO1xuXG4vKipcbiAqIFdpLUZpIERpcmVjdCBncm91cCByb2xlXG4gKi9cbmV4cG9ydCBlbnVtIFdpZmlEaXJlY3RSb2xlIHtcbiAgLyoqIERldmljZSB0aGF0IG93bnMgdGhlIGdyb3VwIGFuZCBhY3RzIGFzIGFuIGFjY2VzcyBwb2ludCAqL1xuICBHUk9VUF9PV05FUiA9IFwiZ3JvdXBfb3duZXJcIixcbiAgLyoqIERldmljZSB0aGF0IGNvbm5lY3RzIHRvIGEgZ3JvdXAgb3duZXIgKi9cbiAgQ0xJRU5UID0gXCJjbGllbnRcIixcbiAgLyoqIFJvbGUgbm90IHlldCBkZXRlcm1pbmVkICovXG4gIFVOREVURVJNSU5FRCA9IFwidW5kZXRlcm1pbmVkXCIsXG59XG5cbi8qKlxuICogV2ktRmkgRGlyZWN0IGRldmljZSBzdGF0dXNcbiAqL1xuZXhwb3J0IGVudW0gV2lmaURpcmVjdERldmljZVN0YXR1cyB7XG4gIENPTk5FQ1RFRCA9IFwiY29ubmVjdGVkXCIsXG4gIElOVklURUQgPSBcImludml0ZWRcIixcbiAgRkFJTEVEID0gXCJmYWlsZWRcIixcbiAgQVZBSUxBQkxFID0gXCJhdmFpbGFibGVcIixcbiAgVU5BVkFJTEFCTEUgPSBcInVuYXZhaWxhYmxlXCIsXG59XG5cbi8qKlxuICogV2ktRmkgRGlyZWN0IGRldmljZSBpbmZvIGZyb20gZGlzY292ZXJ5XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgV2lmaURpcmVjdERldmljZUluZm8ge1xuICAvKiogRGV2aWNlIGlkZW50aWZpZXIgKE1BQyBhZGRyZXNzKSAqL1xuICBkZXZpY2VJZDogc3RyaW5nO1xuICAvKiogRGV2aWNlIG5hbWUgKi9cbiAgbmFtZTogc3RyaW5nO1xuICAvKiogRGV2aWNlIHN0YXR1cyAqL1xuICBzdGF0dXM6IFdpZmlEaXJlY3REZXZpY2VTdGF0dXM7XG4gIC8qKiBXaGV0aGVyIHRoZSBkZXZpY2UgaXMgYSBncm91cCBvd25lciAqL1xuICBpc0dyb3VwT3duZXI6IGJvb2xlYW47XG4gIC8qKiBQcmltYXJ5IGRldmljZSB0eXBlIChlLmcuLCBcInNtYXJ0cGhvbmVcIikgKi9cbiAgcHJpbWFyeURldmljZVR5cGU/OiBzdHJpbmc7XG4gIC8qKiBTZWNvbmRhcnkgZGV2aWNlIHR5cGUgKi9cbiAgc2Vjb25kYXJ5RGV2aWNlVHlwZT86IHN0cmluZztcbiAgLyoqIFdpLUZpIFByb3RlY3RlZCBTZXR1cCAoV1BTKSBjb25maWd1cmF0aW9uIG1ldGhvZHMgKi9cbiAgd3BzQ29uZmlnTWV0aG9kcz86IG51bWJlcjtcbiAgLyoqIFNlcnZpY2UgZGlzY292ZXJ5IHJlY29yZHMgKi9cbiAgc2VydmljZVJlY29yZHM/OiBXaWZpRGlyZWN0U2VydmljZVJlY29yZFtdO1xuICAvKiogTGFzdCBzZWVuIHRpbWVzdGFtcCAqL1xuICBsYXN0U2VlbjogbnVtYmVyO1xufVxuXG4vKipcbiAqIFdpLUZpIERpcmVjdCBzZXJ2aWNlIHJlY29yZCBmb3Igc2VydmljZSBkaXNjb3ZlcnlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBXaWZpRGlyZWN0U2VydmljZVJlY29yZCB7XG4gIC8qKiBTZXJ2aWNlIHR5cGUgKGUuZy4sIFwiX3NjLl90Y3BcIikgKi9cbiAgc2VydmljZVR5cGU6IHN0cmluZztcbiAgLyoqIEluc3RhbmNlIG5hbWUgKi9cbiAgaW5zdGFuY2VOYW1lOiBzdHJpbmc7XG4gIC8qKiBUWFQgcmVjb3JkIGRhdGEgKi9cbiAgdHh0UmVjb3JkPzogTWFwPHN0cmluZywgc3RyaW5nPjtcbn1cblxuLyoqXG4gKiBXaS1GaSBEaXJlY3QgZ3JvdXAgaW5mb1xuICovXG5leHBvcnQgaW50ZXJmYWNlIFdpZmlEaXJlY3RHcm91cEluZm8ge1xuICAvKiogTmV0d29yayBuYW1lIChTU0lEKSAqL1xuICBuZXR3b3JrTmFtZTogc3RyaW5nO1xuICAvKiogUGFzc3BocmFzZSBmb3IgdGhlIGdyb3VwICovXG4gIHBhc3NwaHJhc2U/OiBzdHJpbmc7XG4gIC8qKiBHcm91cCBvd25lcidzIGRldmljZSBpbmZvICovXG4gIG93bmVyOiBXaWZpRGlyZWN0RGV2aWNlSW5mbztcbiAgLyoqIExpc3Qgb2YgY2xpZW50IGRldmljZXMgaW4gdGhlIGdyb3VwICovXG4gIGNsaWVudHM6IFdpZmlEaXJlY3REZXZpY2VJbmZvW107XG4gIC8qKiBXaGV0aGVyIHRoaXMgZGV2aWNlIGlzIHRoZSBncm91cCBvd25lciAqL1xuICBpc093bmVyOiBib29sZWFuO1xuICAvKiogSW50ZXJmYWNlIG5hbWUgZm9yIHRoZSBncm91cCAqL1xuICBpbnRlcmZhY2VOYW1lPzogc3RyaW5nO1xuICAvKiogR3JvdXAgZm9ybWF0aW9uIHRpbWVzdGFtcCAqL1xuICBjcmVhdGVkQXQ6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBXaS1GaSBEaXJlY3Qtc3BlY2lmaWMgdHJhbnNwb3J0IGNvbmZpZ3VyYXRpb25cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBXaWZpRGlyZWN0VHJhbnNwb3J0Q29uZmlnIGV4dGVuZHMgVHJhbnNwb3J0Q29uZmlnIHtcbiAgLyoqIFNlcnZpY2UgdHlwZSBmb3IgbUROUyBkaXNjb3ZlcnkgKi9cbiAgc2VydmljZVR5cGU/OiBzdHJpbmc7XG4gIC8qKiBTZXJ2aWNlIGluc3RhbmNlIG5hbWUgKi9cbiAgc2VydmljZU5hbWU/OiBzdHJpbmc7XG4gIC8qKiBQb3J0IGZvciBUQ1AvVURQIGNvbW11bmljYXRpb24gKi9cbiAgcG9ydD86IG51bWJlcjtcbiAgLyoqIFdoZXRoZXIgdG8gcHJlZmVyIGJlaW5nIGdyb3VwIG93bmVyICovXG4gIHByZWZlckdyb3VwT3duZXI/OiBib29sZWFuO1xuICAvKiogR3JvdXAgb3duZXIgaW50ZW50ICgwLTE1LCBoaWdoZXIgPSBtb3JlIGxpa2VseSB0byBiZSBHTykgKi9cbiAgZ3JvdXBPd25lckludGVudD86IG51bWJlcjtcbiAgLyoqIFdoZXRoZXIgdG8gdXNlIHBlcnNpc3RlbnQgZ3JvdXBzICovXG4gIHBlcnNpc3RlbnRHcm91cD86IGJvb2xlYW47XG4gIC8qKiBEaXNjb3ZlcnkgdGltZW91dCBpbiBtaWxsaXNlY29uZHMgKi9cbiAgZGlzY292ZXJ5VGltZW91dD86IG51bWJlcjtcbiAgLyoqIENvbm5lY3Rpb24gdGltZW91dCBpbiBtaWxsaXNlY29uZHMgKi9cbiAgY29ubmVjdGlvblRpbWVvdXQ/OiBudW1iZXI7XG4gIC8qKiBFbmFibGUgc2VydmljZSBkaXNjb3ZlcnkgKEJvbmpvdXIvbUROUykgKi9cbiAgZW5hYmxlU2VydmljZURpc2NvdmVyeT86IGJvb2xlYW47XG59XG5cbi8qKlxuICogV2ktRmkgRGlyZWN0LXNwZWNpZmljIHRyYW5zcG9ydCBldmVudHNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBXaWZpRGlyZWN0VHJhbnNwb3J0RXZlbnRzIGV4dGVuZHMgVHJhbnNwb3J0RXZlbnRzIHtcbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIGEgV2ktRmkgRGlyZWN0IGRldmljZSBpcyBkaXNjb3ZlcmVkLlxuICAgKiBAcGFyYW0gZGV2aWNlIFRoZSBkaXNjb3ZlcmVkIGRldmljZSBpbmZvXG4gICAqL1xuICBvbkRldmljZURpc2NvdmVyZWQ/KGRldmljZTogV2lmaURpcmVjdERldmljZUluZm8pOiB2b2lkO1xuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBhIFdpLUZpIERpcmVjdCBncm91cCBpcyBmb3JtZWQuXG4gICAqIEBwYXJhbSBncm91cCBUaGUgZ3JvdXAgaW5mb1xuICAgKi9cbiAgb25Hcm91cEZvcm1lZD8oZ3JvdXA6IFdpZmlEaXJlY3RHcm91cEluZm8pOiB2b2lkO1xuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiB0aGUgV2ktRmkgRGlyZWN0IGdyb3VwIGlzIHJlbW92ZWQvZGlzYmFuZGVkLlxuICAgKi9cbiAgb25Hcm91cFJlbW92ZWQ/KCk6IHZvaWQ7XG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIHRoaXMgZGV2aWNlJ3Mgcm9sZSBpbiB0aGUgZ3JvdXAgY2hhbmdlcy5cbiAgICogQHBhcmFtIHJvbGUgVGhlIG5ldyByb2xlXG4gICAqL1xuICBvblJvbGVDaGFuZ2VkPyhyb2xlOiBXaWZpRGlyZWN0Um9sZSk6IHZvaWQ7XG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIGEgY29ubmVjdGlvbiByZXF1ZXN0IGlzIHJlY2VpdmVkLlxuICAgKiBAcGFyYW0gZGV2aWNlIFRoZSBkZXZpY2UgcmVxdWVzdGluZyBjb25uZWN0aW9uXG4gICAqL1xuICBvbkNvbm5lY3Rpb25SZXF1ZXN0PyhkZXZpY2U6IFdpZmlEaXJlY3REZXZpY2VJbmZvKTogdm9pZDtcblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gZGlzY292ZXJ5IHN0YXRlIGNoYW5nZXMuXG4gICAqIEBwYXJhbSBpc0Rpc2NvdmVyaW5nIFdoZXRoZXIgZGlzY292ZXJ5IGlzIGFjdGl2ZVxuICAgKi9cbiAgb25EaXNjb3ZlcnlTdGF0ZUNoYW5nZWQ/KGlzRGlzY292ZXJpbmc6IGJvb2xlYW4pOiB2b2lkO1xuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBXaS1GaSBEaXJlY3Qgc3RhdGUgY2hhbmdlcyAoZW5hYmxlZC9kaXNhYmxlZCkuXG4gICAqIEBwYXJhbSBpc0VuYWJsZWQgV2hldGhlciBXaS1GaSBEaXJlY3QgaXMgZW5hYmxlZFxuICAgKi9cbiAgb25XaWZpRGlyZWN0U3RhdGVDaGFuZ2VkPyhpc0VuYWJsZWQ6IGJvb2xlYW4pOiB2b2lkO1xufVxuXG4vKipcbiAqIEV4dGVuZGVkIHBlZXIgaW5mbyBmb3IgV2ktRmkgRGlyZWN0IGNvbm5lY3Rpb25zXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgV2lmaURpcmVjdFBlZXJJbmZvIGV4dGVuZHMgVHJhbnNwb3J0UGVlckluZm8ge1xuICAvKiogRGV2aWNlIE1BQyBhZGRyZXNzICovXG4gIG1hY0FkZHJlc3M/OiBzdHJpbmc7XG4gIC8qKiBEZXZpY2UgbmFtZSAqL1xuICBkZXZpY2VOYW1lPzogc3RyaW5nO1xuICAvKiogSVAgYWRkcmVzcyAoYXZhaWxhYmxlIGFmdGVyIGNvbm5lY3Rpb24pICovXG4gIGlwQWRkcmVzcz86IHN0cmluZztcbiAgLyoqIFJvbGUgaW4gdGhlIGdyb3VwICovXG4gIHJvbGU6IFdpZmlEaXJlY3RSb2xlO1xuICAvKiogV2hldGhlciB0aGlzIHBlZXIgaXMgdGhlIGdyb3VwIG93bmVyICovXG4gIGlzR3JvdXBPd25lcjogYm9vbGVhbjtcbiAgLyoqIEJhbmR3aWR0aCBlc3RpbWF0ZSBpbiBNYnBzICovXG4gIGJhbmR3aWR0aE1icHM/OiBudW1iZXI7XG59XG5cbi8qKlxuICogV2ktRmkgRGlyZWN0IFRyYW5zcG9ydCBpbnRlcmZhY2UgZXh0ZW5kaW5nIHRoZSBiYXNlIFRyYW5zcG9ydCBpbnRlcmZhY2UuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgV2lmaURpcmVjdFRyYW5zcG9ydCBleHRlbmRzIFRyYW5zcG9ydCB7XG4gIC8qKlxuICAgKiBTdGFydCBkZXZpY2UgZGlzY292ZXJ5IHRvIGZpbmQgbmVhcmJ5IFdpLUZpIERpcmVjdCBkZXZpY2VzLlxuICAgKi9cbiAgc3RhcnREaXNjb3ZlcnkoKTogUHJvbWlzZTx2b2lkPjtcblxuICAvKipcbiAgICogU3RvcCBkZXZpY2UgZGlzY292ZXJ5LlxuICAgKi9cbiAgc3RvcERpc2NvdmVyeSgpOiBQcm9taXNlPHZvaWQ+O1xuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBkaXNjb3ZlcnkgaXMgY3VycmVudGx5IGFjdGl2ZS5cbiAgICovXG4gIGlzRGlzY292ZXJpbmcoKTogYm9vbGVhbjtcblxuICAvKipcbiAgICogR2V0IGxpc3Qgb2YgZGlzY292ZXJlZCBkZXZpY2VzLlxuICAgKi9cbiAgZ2V0RGlzY292ZXJlZERldmljZXMoKTogV2lmaURpcmVjdERldmljZUluZm9bXTtcblxuICAvKipcbiAgICogQ3JlYXRlIGEgV2ktRmkgRGlyZWN0IGdyb3VwIChiZWNvbWUgZ3JvdXAgb3duZXIpLlxuICAgKi9cbiAgY3JlYXRlR3JvdXAoKTogUHJvbWlzZTxXaWZpRGlyZWN0R3JvdXBJbmZvPjtcblxuICAvKipcbiAgICogUmVtb3ZlL2Rpc2JhbmQgdGhlIGN1cnJlbnQgZ3JvdXAuXG4gICAqL1xuICByZW1vdmVHcm91cCgpOiBQcm9taXNlPHZvaWQ+O1xuXG4gIC8qKlxuICAgKiBHZXQgY3VycmVudCBncm91cCBpbmZvIGlmIGluIGEgZ3JvdXAuXG4gICAqL1xuICBnZXRHcm91cEluZm8oKTogV2lmaURpcmVjdEdyb3VwSW5mbyB8IHVuZGVmaW5lZDtcblxuICAvKipcbiAgICogR2V0IHRoaXMgZGV2aWNlJ3Mgcm9sZSBpbiB0aGUgY3VycmVudCBncm91cC5cbiAgICovXG4gIGdldFJvbGUoKTogV2lmaURpcmVjdFJvbGU7XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIFdpLUZpIERpcmVjdCBpcyBhdmFpbGFibGUgb24gdGhpcyBkZXZpY2UuXG4gICAqL1xuICBpc1dpZmlEaXJlY3RBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPjtcblxuICAvKipcbiAgICogUmVxdWVzdCBXaS1GaSBEaXJlY3QgY29ubmVjdGlvbiBpbmZvIChJUCBhZGRyZXNzZXMsIGV0Yy4pLlxuICAgKi9cbiAgcmVxdWVzdENvbm5lY3Rpb25JbmZvKCk6IFByb21pc2U8XG4gICAgeyBncm91cE93bmVyQWRkcmVzczogc3RyaW5nOyBpc0dyb3VwT3duZXI6IGJvb2xlYW4gfSB8IHVuZGVmaW5lZFxuICA+O1xuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBhIGxvY2FsIHNlcnZpY2UgZm9yIHNlcnZpY2UgZGlzY292ZXJ5LlxuICAgKiBAcGFyYW0gc2VydmljZVJlY29yZCBUaGUgc2VydmljZSByZWNvcmQgdG8gcmVnaXN0ZXJcbiAgICovXG4gIHJlZ2lzdGVyU2VydmljZShzZXJ2aWNlUmVjb3JkOiBXaWZpRGlyZWN0U2VydmljZVJlY29yZCk6IFByb21pc2U8dm9pZD47XG5cbiAgLyoqXG4gICAqIFVucmVnaXN0ZXIgYSBwcmV2aW91c2x5IHJlZ2lzdGVyZWQgc2VydmljZS5cbiAgICovXG4gIHVucmVnaXN0ZXJTZXJ2aWNlKCk6IFByb21pc2U8dm9pZD47XG5cbiAgLyoqXG4gICAqIFN0YXJ0IHNlcnZpY2UgZGlzY292ZXJ5IHRvIGZpbmQgc3BlY2lmaWMgc2VydmljZXMuXG4gICAqIEBwYXJhbSBzZXJ2aWNlVHlwZSBUaGUgc2VydmljZSB0eXBlIHRvIGRpc2NvdmVyIChlLmcuLCBcIl9zYy5fdGNwXCIpXG4gICAqL1xuICBkaXNjb3ZlclNlcnZpY2VzKHNlcnZpY2VUeXBlPzogc3RyaW5nKTogUHJvbWlzZTx2b2lkPjtcblxuICAvKipcbiAgICogR2V0IFdpLUZpIERpcmVjdC1zcGVjaWZpYyBwZWVyIGluZm8uXG4gICAqIEBwYXJhbSBwZWVySWQgVGhlIHBlZXIgSUQgdG8gcXVlcnlcbiAgICovXG4gIGdldFdpZmlEaXJlY3RQZWVySW5mbyhcbiAgICBwZWVySWQ6IFRyYW5zcG9ydFBlZXJJZCxcbiAgKTogV2lmaURpcmVjdFBlZXJJbmZvIHwgdW5kZWZpbmVkO1xufVxuXG4vKipcbiAqIERlZmF1bHQgV2ktRmkgRGlyZWN0IHRyYW5zcG9ydCBjb25maWd1cmF0aW9uLlxuICovXG5leHBvcnQgY29uc3QgREVGQVVMVF9XSUZJX0RJUkVDVF9DT05GSUc6IFJlcXVpcmVkPFdpZmlEaXJlY3RUcmFuc3BvcnRDb25maWc+ID0ge1xuICBzZXJ2aWNlVHlwZTogXCJfc2MuX3RjcFwiLFxuICBzZXJ2aWNlTmFtZTogXCJTQyBNZXNoIE5vZGVcIixcbiAgcG9ydDogODk4OCxcbiAgcHJlZmVyR3JvdXBPd25lcjogZmFsc2UsXG4gIGdyb3VwT3duZXJJbnRlbnQ6IDcsXG4gIHBlcnNpc3RlbnRHcm91cDogdHJ1ZSxcbiAgZGlzY292ZXJ5VGltZW91dDogMzAwMDAsXG4gIGNvbm5lY3Rpb25UaW1lb3V0OiAzMDAwMCxcbiAgZW5hYmxlU2VydmljZURpc2NvdmVyeTogdHJ1ZSxcbiAgbWF4UGVlcnM6IDEwLFxuICBoZWFydGJlYXRJbnRlcnZhbDogMzAwMDAsXG4gIG9wdGlvbnM6IHt9LFxufTtcblxuLyoqXG4gKiBNb2NrIFdpLUZpIERpcmVjdCBUcmFuc3BvcnQgZm9yIHRlc3RpbmcgYW5kIHdlYiBlbnZpcm9ubWVudHMuXG4gKi9cbmV4cG9ydCBjbGFzcyBNb2NrV2lmaURpcmVjdFRyYW5zcG9ydCBpbXBsZW1lbnRzIFdpZmlEaXJlY3RUcmFuc3BvcnQge1xuICByZWFkb25seSBsb2NhbFBlZXJJZDogVHJhbnNwb3J0UGVlcklkO1xuICByZWFkb25seSBuYW1lID0gXCJ3aWZpLWRpcmVjdFwiO1xuXG4gIHByaXZhdGUgY29uZmlnOiBSZXF1aXJlZDxXaWZpRGlyZWN0VHJhbnNwb3J0Q29uZmlnPjtcbiAgcHJpdmF0ZSBldmVudHM6IFdpZmlEaXJlY3RUcmFuc3BvcnRFdmVudHMgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBwZWVyczogTWFwPFRyYW5zcG9ydFBlZXJJZCwgV2lmaURpcmVjdFBlZXJJbmZvPiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSBkaXNjb3ZlcmVkRGV2aWNlczogTWFwPHN0cmluZywgV2lmaURpcmVjdERldmljZUluZm8+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIGlzUnVubmluZyA9IGZhbHNlO1xuICBwcml2YXRlIF9pc0Rpc2NvdmVyaW5nID0gZmFsc2U7XG4gIHByaXZhdGUgX3JvbGU6IFdpZmlEaXJlY3RSb2xlID0gV2lmaURpcmVjdFJvbGUuVU5ERVRFUk1JTkVEO1xuICBwcml2YXRlIF9ncm91cEluZm86IFdpZmlEaXJlY3RHcm91cEluZm8gfCB1bmRlZmluZWQ7XG4gIHByaXZhdGUgZGlzY292ZXJ5SW50ZXJ2YWw6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbCA9IG51bGw7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgbG9jYWxQZWVySWQ6IFRyYW5zcG9ydFBlZXJJZCxcbiAgICBjb25maWc6IFdpZmlEaXJlY3RUcmFuc3BvcnRDb25maWcgPSB7fSxcbiAgKSB7XG4gICAgdGhpcy5sb2NhbFBlZXJJZCA9IGxvY2FsUGVlcklkO1xuICAgIHRoaXMuY29uZmlnID0geyAuLi5ERUZBVUxUX1dJRklfRElSRUNUX0NPTkZJRywgLi4uY29uZmlnIH07XG4gIH1cblxuICBhc3luYyBzdGFydChldmVudHM6IFdpZmlEaXJlY3RUcmFuc3BvcnRFdmVudHMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLmV2ZW50cyA9IGV2ZW50cztcbiAgICB0aGlzLmlzUnVubmluZyA9IHRydWU7XG4gIH1cblxuICBhc3luYyBzdG9wKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMuc3RvcERpc2NvdmVyeSgpO1xuICAgIGF3YWl0IHRoaXMucmVtb3ZlR3JvdXAoKTtcbiAgICB0aGlzLnBlZXJzLmNsZWFyKCk7XG4gICAgdGhpcy5kaXNjb3ZlcmVkRGV2aWNlcy5jbGVhcigpO1xuICAgIHRoaXMuZXZlbnRzID0gbnVsbDtcbiAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlO1xuICB9XG5cbiAgYXN5bmMgY29ubmVjdChwZWVySWQ6IFRyYW5zcG9ydFBlZXJJZCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlRyYW5zcG9ydCBub3Qgc3RhcnRlZFwiKTtcbiAgICB9XG5cbiAgICBjb25zdCBwZWVySW5mbzogV2lmaURpcmVjdFBlZXJJbmZvID0ge1xuICAgICAgcGVlcklkLFxuICAgICAgc3RhdGU6IFwiY29ubmVjdGluZ1wiLFxuICAgICAgdHJhbnNwb3J0VHlwZTogXCJ3aWZpLWRpcmVjdFwiLFxuICAgICAgY29ubmVjdGlvblF1YWxpdHk6IDk1LFxuICAgICAgYnl0ZXNTZW50OiAwLFxuICAgICAgYnl0ZXNSZWNlaXZlZDogMCxcbiAgICAgIGxhc3RTZWVuOiBEYXRlLm5vdygpLFxuICAgICAgcm9sZTogV2lmaURpcmVjdFJvbGUuQ0xJRU5ULFxuICAgICAgaXNHcm91cE93bmVyOiBmYWxzZSxcbiAgICAgIGJhbmR3aWR0aE1icHM6IDI1MCxcbiAgICB9O1xuXG4gICAgdGhpcy5wZWVycy5zZXQocGVlcklkLCBwZWVySW5mbyk7XG4gICAgdGhpcy5ldmVudHM/Lm9uU3RhdGVDaGFuZ2U/LihwZWVySWQsIFwiY29ubmVjdGluZ1wiKTtcblxuICAgIC8vIFNpbXVsYXRlIGNvbm5lY3Rpb24gZGVsYXlcbiAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMDApKTtcblxuICAgIHBlZXJJbmZvLnN0YXRlID0gXCJjb25uZWN0ZWRcIjtcbiAgICBwZWVySW5mby5pcEFkZHJlc3MgPSBgMTkyLjE2OC40OS4ke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1NCkgKyAxfWA7XG4gICAgdGhpcy5ldmVudHM/Lm9uU3RhdGVDaGFuZ2U/LihwZWVySWQsIFwiY29ubmVjdGVkXCIpO1xuICAgIHRoaXMuZXZlbnRzPy5vblBlZXJDb25uZWN0ZWQ/LihwZWVySWQsIHBlZXJJbmZvKTtcbiAgfVxuXG4gIGFzeW5jIGRpc2Nvbm5lY3QocGVlcklkOiBUcmFuc3BvcnRQZWVySWQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBwZWVyID0gdGhpcy5wZWVycy5nZXQocGVlcklkKTtcbiAgICBpZiAocGVlcikge1xuICAgICAgcGVlci5zdGF0ZSA9IFwiZGlzY29ubmVjdGVkXCI7XG4gICAgICB0aGlzLmV2ZW50cz8ub25TdGF0ZUNoYW5nZT8uKHBlZXJJZCwgXCJkaXNjb25uZWN0ZWRcIik7XG4gICAgICB0aGlzLmV2ZW50cz8ub25QZWVyRGlzY29ubmVjdGVkPy4ocGVlcklkLCBcImRpc2Nvbm5lY3RlZFwiKTtcbiAgICAgIHRoaXMucGVlcnMuZGVsZXRlKHBlZXJJZCk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc2VuZChwZWVySWQ6IFRyYW5zcG9ydFBlZXJJZCwgcGF5bG9hZDogVWludDhBcnJheSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHBlZXIgPSB0aGlzLnBlZXJzLmdldChwZWVySWQpO1xuICAgIGlmICghcGVlciB8fCBwZWVyLnN0YXRlICE9PSBcImNvbm5lY3RlZFwiKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFBlZXIgJHtwZWVySWR9IG5vdCBjb25uZWN0ZWRgKTtcbiAgICB9XG5cbiAgICBwZWVyLmJ5dGVzU2VudCA9IChwZWVyLmJ5dGVzU2VudCB8fCAwKSArIHBheWxvYWQubGVuZ3RoO1xuICAgIHBlZXIubGFzdFNlZW4gPSBEYXRlLm5vdygpO1xuICB9XG5cbiAgYXN5bmMgYnJvYWRjYXN0KFxuICAgIHBheWxvYWQ6IFVpbnQ4QXJyYXksXG4gICAgZXhjbHVkZVBlZXJJZD86IFRyYW5zcG9ydFBlZXJJZCxcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3Qgc2VuZFByb21pc2VzOiBQcm9taXNlPHZvaWQ+W10gPSBbXTtcbiAgICBmb3IgKGNvbnN0IFtwZWVySWQsIHBlZXJdIG9mIHRoaXMucGVlcnMpIHtcbiAgICAgIGlmIChwZWVySWQgIT09IGV4Y2x1ZGVQZWVySWQgJiYgcGVlci5zdGF0ZSA9PT0gXCJjb25uZWN0ZWRcIikge1xuICAgICAgICBzZW5kUHJvbWlzZXMucHVzaCh0aGlzLnNlbmQocGVlcklkLCBwYXlsb2FkKSk7XG4gICAgICB9XG4gICAgfVxuICAgIGF3YWl0IFByb21pc2UuYWxsKHNlbmRQcm9taXNlcyk7XG4gIH1cblxuICBnZXRDb25uZWN0ZWRQZWVycygpOiBUcmFuc3BvcnRQZWVySWRbXSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5wZWVycy5lbnRyaWVzKCkpXG4gICAgICAuZmlsdGVyKChbLCBwZWVyXSkgPT4gcGVlci5zdGF0ZSA9PT0gXCJjb25uZWN0ZWRcIilcbiAgICAgIC5tYXAoKFtpZF0pID0+IGlkKTtcbiAgfVxuXG4gIGdldFBlZXJJbmZvKHBlZXJJZDogVHJhbnNwb3J0UGVlcklkKTogVHJhbnNwb3J0UGVlckluZm8gfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLnBlZXJzLmdldChwZWVySWQpO1xuICB9XG5cbiAgZ2V0Q29ubmVjdGlvblN0YXRlKFxuICAgIHBlZXJJZDogVHJhbnNwb3J0UGVlcklkLFxuICApOiBUcmFuc3BvcnRDb25uZWN0aW9uU3RhdGUgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLnBlZXJzLmdldChwZWVySWQpPy5zdGF0ZTtcbiAgfVxuXG4gIC8vIFdpLUZpIERpcmVjdC1zcGVjaWZpYyBtZXRob2RzXG5cbiAgYXN5bmMgc3RhcnREaXNjb3ZlcnkoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy5faXNEaXNjb3ZlcmluZyA9IHRydWU7XG4gICAgdGhpcy5ldmVudHM/Lm9uRGlzY292ZXJ5U3RhdGVDaGFuZ2VkPy4odHJ1ZSk7XG5cbiAgICAvLyBTaW11bGF0ZSBwZXJpb2RpYyBkZXZpY2UgZGlzY292ZXJ5XG4gICAgdGhpcy5kaXNjb3ZlcnlJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tEZXZpY2U6IFdpZmlEaXJlY3REZXZpY2VJbmZvID0ge1xuICAgICAgICBkZXZpY2VJZDogYG1vY2std2ZkLSR7RGF0ZS5ub3coKX1gLFxuICAgICAgICBuYW1lOiBgU0MgUGVlciAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCl9YCxcbiAgICAgICAgc3RhdHVzOiBXaWZpRGlyZWN0RGV2aWNlU3RhdHVzLkFWQUlMQUJMRSxcbiAgICAgICAgaXNHcm91cE93bmVyOiBNYXRoLnJhbmRvbSgpID4gMC43LFxuICAgICAgICBwcmltYXJ5RGV2aWNlVHlwZTogXCJzbWFydHBob25lXCIsXG4gICAgICAgIGxhc3RTZWVuOiBEYXRlLm5vdygpLFxuICAgICAgfTtcbiAgICAgIHRoaXMuZGlzY292ZXJlZERldmljZXMuc2V0KG1vY2tEZXZpY2UuZGV2aWNlSWQsIG1vY2tEZXZpY2UpO1xuICAgICAgdGhpcy5ldmVudHM/Lm9uRGV2aWNlRGlzY292ZXJlZD8uKG1vY2tEZXZpY2UpO1xuICAgIH0sIDMwMDApO1xuICB9XG5cbiAgYXN5bmMgc3RvcERpc2NvdmVyeSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLl9pc0Rpc2NvdmVyaW5nID0gZmFsc2U7XG4gICAgaWYgKHRoaXMuZGlzY292ZXJ5SW50ZXJ2YWwpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5kaXNjb3ZlcnlJbnRlcnZhbCk7XG4gICAgICB0aGlzLmRpc2NvdmVyeUludGVydmFsID0gbnVsbDtcbiAgICB9XG4gICAgdGhpcy5ldmVudHM/Lm9uRGlzY292ZXJ5U3RhdGVDaGFuZ2VkPy4oZmFsc2UpO1xuICB9XG5cbiAgaXNEaXNjb3ZlcmluZygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5faXNEaXNjb3ZlcmluZztcbiAgfVxuXG4gIGdldERpc2NvdmVyZWREZXZpY2VzKCk6IFdpZmlEaXJlY3REZXZpY2VJbmZvW10ge1xuICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuZGlzY292ZXJlZERldmljZXMudmFsdWVzKCkpO1xuICB9XG5cbiAgYXN5bmMgY3JlYXRlR3JvdXAoKTogUHJvbWlzZTxXaWZpRGlyZWN0R3JvdXBJbmZvPiB7XG4gICAgdGhpcy5fcm9sZSA9IFdpZmlEaXJlY3RSb2xlLkdST1VQX09XTkVSO1xuXG4gICAgY29uc3Qgb3duZXJEZXZpY2U6IFdpZmlEaXJlY3REZXZpY2VJbmZvID0ge1xuICAgICAgZGV2aWNlSWQ6IHRoaXMubG9jYWxQZWVySWQsXG4gICAgICBuYW1lOiBcIlRoaXMgRGV2aWNlXCIsXG4gICAgICBzdGF0dXM6IFdpZmlEaXJlY3REZXZpY2VTdGF0dXMuQ09OTkVDVEVELFxuICAgICAgaXNHcm91cE93bmVyOiB0cnVlLFxuICAgICAgbGFzdFNlZW46IERhdGUubm93KCksXG4gICAgfTtcblxuICAgIHRoaXMuX2dyb3VwSW5mbyA9IHtcbiAgICAgIG5ldHdvcmtOYW1lOiBgRElSRUNULVNDLSR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoMiwgNikudG9VcHBlckNhc2UoKX1gLFxuICAgICAgcGFzc3BocmFzZTogTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoMiwgMTApLFxuICAgICAgb3duZXI6IG93bmVyRGV2aWNlLFxuICAgICAgY2xpZW50czogW10sXG4gICAgICBpc093bmVyOiB0cnVlLFxuICAgICAgaW50ZXJmYWNlTmFtZTogXCJwMnAtd2xhbjAtMFwiLFxuICAgICAgY3JlYXRlZEF0OiBEYXRlLm5vdygpLFxuICAgIH07XG5cbiAgICB0aGlzLmV2ZW50cz8ub25Hcm91cEZvcm1lZD8uKHRoaXMuX2dyb3VwSW5mbyk7XG4gICAgdGhpcy5ldmVudHM/Lm9uUm9sZUNoYW5nZWQ/LihXaWZpRGlyZWN0Um9sZS5HUk9VUF9PV05FUik7XG5cbiAgICByZXR1cm4gdGhpcy5fZ3JvdXBJbmZvO1xuICB9XG5cbiAgYXN5bmMgcmVtb3ZlR3JvdXAoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKHRoaXMuX2dyb3VwSW5mbykge1xuICAgICAgdGhpcy5fZ3JvdXBJbmZvID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy5fcm9sZSA9IFdpZmlEaXJlY3RSb2xlLlVOREVURVJNSU5FRDtcbiAgICAgIHRoaXMuZXZlbnRzPy5vbkdyb3VwUmVtb3ZlZD8uKCk7XG4gICAgICB0aGlzLmV2ZW50cz8ub25Sb2xlQ2hhbmdlZD8uKFdpZmlEaXJlY3RSb2xlLlVOREVURVJNSU5FRCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0R3JvdXBJbmZvKCk6IFdpZmlEaXJlY3RHcm91cEluZm8gfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLl9ncm91cEluZm87XG4gIH1cblxuICBnZXRSb2xlKCk6IFdpZmlEaXJlY3RSb2xlIHtcbiAgICByZXR1cm4gdGhpcy5fcm9sZTtcbiAgfVxuXG4gIGFzeW5jIGlzV2lmaURpcmVjdEF2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAvLyBNb2NrIGFsd2F5cyByZXR1cm5zIHRydWVcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGFzeW5jIHJlcXVlc3RDb25uZWN0aW9uSW5mbygpOiBQcm9taXNlPFxuICAgIHsgZ3JvdXBPd25lckFkZHJlc3M6IHN0cmluZzsgaXNHcm91cE93bmVyOiBib29sZWFuIH0gfCB1bmRlZmluZWRcbiAgPiB7XG4gICAgaWYgKCF0aGlzLl9ncm91cEluZm8pIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGdyb3VwT3duZXJBZGRyZXNzOiBcIjE5Mi4xNjguNDkuMVwiLCAvLyBHcm91cCBvd25lciBpcyBhbHdheXMgYXQgdGhpcyBhZGRyZXNzIGluIFAyUFxuICAgICAgaXNHcm91cE93bmVyOiB0aGlzLl9ncm91cEluZm8uaXNPd25lcixcbiAgICB9O1xuICB9XG5cbiAgYXN5bmMgcmVnaXN0ZXJTZXJ2aWNlKHNlcnZpY2VSZWNvcmQ6IFdpZmlEaXJlY3RTZXJ2aWNlUmVjb3JkKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8gTW9jazoganVzdCBsb2cgdGhlIHNlcnZpY2UgcmVnaXN0cmF0aW9uXG4gICAgY29uc29sZS5sb2coXCJSZWdpc3RlcmVkIFdpLUZpIERpcmVjdCBzZXJ2aWNlOlwiLCBzZXJ2aWNlUmVjb3JkKTtcbiAgfVxuXG4gIGFzeW5jIHVucmVnaXN0ZXJTZXJ2aWNlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIE1vY2s6IG5vdGhpbmcgdG8gZG9cbiAgfVxuXG4gIGFzeW5jIGRpc2NvdmVyU2VydmljZXMoc2VydmljZVR5cGU/OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyBNb2NrOiBzaW11bGF0ZSBzZXJ2aWNlIGRpc2NvdmVyeVxuICAgIGNvbnNvbGUubG9nKFxuICAgICAgXCJEaXNjb3ZlcmluZyBXaS1GaSBEaXJlY3Qgc2VydmljZXM6XCIsXG4gICAgICBzZXJ2aWNlVHlwZSB8fCB0aGlzLmNvbmZpZy5zZXJ2aWNlVHlwZSxcbiAgICApO1xuICB9XG5cbiAgZ2V0V2lmaURpcmVjdFBlZXJJbmZvKFxuICAgIHBlZXJJZDogVHJhbnNwb3J0UGVlcklkLFxuICApOiBXaWZpRGlyZWN0UGVlckluZm8gfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLnBlZXJzLmdldChwZWVySWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNpbXVsYXRlIHJlY2VpdmluZyBhIG1lc3NhZ2UgZnJvbSBhIHBlZXIuXG4gICAqIFVzZWQgZm9yIHRlc3RpbmcgcHVycG9zZXMuXG4gICAqL1xuICBzaW11bGF0ZU1lc3NhZ2UoZnJvbTogVHJhbnNwb3J0UGVlcklkLCBwYXlsb2FkOiBVaW50OEFycmF5KTogdm9pZCB7XG4gICAgY29uc3QgcGVlciA9IHRoaXMucGVlcnMuZ2V0KGZyb20pO1xuICAgIGlmIChwZWVyKSB7XG4gICAgICBwZWVyLmJ5dGVzUmVjZWl2ZWQgPSAocGVlci5ieXRlc1JlY2VpdmVkIHx8IDApICsgcGF5bG9hZC5sZW5ndGg7XG4gICAgICBwZWVyLmxhc3RTZWVuID0gRGF0ZS5ub3coKTtcbiAgICB9XG5cbiAgICB0aGlzLmV2ZW50cz8ub25NZXNzYWdlKHtcbiAgICAgIGZyb20sXG4gICAgICBwYXlsb2FkLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFNpbXVsYXRlIGFuIGluY29taW5nIGNvbm5lY3Rpb24gcmVxdWVzdC5cbiAgICogVXNlZCBmb3IgdGVzdGluZyBwdXJwb3Nlcy5cbiAgICovXG4gIHNpbXVsYXRlQ29ubmVjdGlvblJlcXVlc3QoZGV2aWNlOiBXaWZpRGlyZWN0RGV2aWNlSW5mbyk6IHZvaWQge1xuICAgIHRoaXMuZXZlbnRzPy5vbkNvbm5lY3Rpb25SZXF1ZXN0Py4oZGV2aWNlKTtcbiAgfVxufVxuXG4vLyBSZWdpc3RlciB0aGUgbW9jayBXaS1GaSBEaXJlY3QgdHJhbnNwb3J0IGZhY3RvcnlcbnRyYW5zcG9ydFJlZ2lzdHJ5LnJlZ2lzdGVyKFwid2lmaS1kaXJlY3RcIiwgKGNvbmZpZz86IFRyYW5zcG9ydENvbmZpZykgPT4ge1xuICBjb25zdCBwZWVySWQgPSBgd2ZkLSR7RGF0ZS5ub3coKX0tJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zbGljZSgyLCA4KX1gO1xuICByZXR1cm4gbmV3IE1vY2tXaWZpRGlyZWN0VHJhbnNwb3J0KFxuICAgIHBlZXJJZCxcbiAgICBjb25maWcgYXMgV2lmaURpcmVjdFRyYW5zcG9ydENvbmZpZyxcbiAgKTtcbn0pO1xuXG4vKipcbiAqIFdpLUZpIERpcmVjdCB0cmFuc3BvcnQgZmFjdG9yeSB0eXBlXG4gKi9cbmV4cG9ydCB0eXBlIFdpZmlEaXJlY3RUcmFuc3BvcnRGYWN0b3J5ID0gKFxuICBsb2NhbFBlZXJJZDogVHJhbnNwb3J0UGVlcklkLFxuICBjb25maWc/OiBXaWZpRGlyZWN0VHJhbnNwb3J0Q29uZmlnLFxuKSA9PiBXaWZpRGlyZWN0VHJhbnNwb3J0O1xuIl0sInZlcnNpb24iOjN9