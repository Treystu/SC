{"file":"/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/transport/WifiDirectTransport.ts","mappings":"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","names":[],"sources":["/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/transport/WifiDirectTransport.ts"],"sourcesContent":["/**\n * Wi-Fi Direct Transport Implementation\n *\n * A Transport abstraction for Wi-Fi Direct (Wi-Fi P2P) communication.\n * This provides a platform-agnostic interface that can be implemented\n * by platform-specific Wi-Fi Direct code (Android, iOS).\n *\n * Wi-Fi Direct enables high-bandwidth, low-latency peer-to-peer connections\n * without requiring a traditional Wi-Fi network infrastructure.\n */\n\nimport {\n  Transport,\n  TransportPeerId,\n  TransportEvents,\n  TransportConfig,\n  TransportPeerInfo,\n  TransportConnectionState,\n  transportRegistry,\n} from \"./Transport.js\";\n\n/**\n * Wi-Fi Direct group role\n */\nexport enum WifiDirectRole {\n  /** Device that owns the group and acts as an access point */\n  GROUP_OWNER = \"group_owner\",\n  /** Device that connects to a group owner */\n  CLIENT = \"client\",\n  /** Role not yet determined */\n  UNDETERMINED = \"undetermined\",\n}\n\n/**\n * Wi-Fi Direct device status\n */\nexport enum WifiDirectDeviceStatus {\n  CONNECTED = \"connected\",\n  INVITED = \"invited\",\n  FAILED = \"failed\",\n  AVAILABLE = \"available\",\n  UNAVAILABLE = \"unavailable\",\n}\n\n/**\n * Wi-Fi Direct device info from discovery\n */\nexport interface WifiDirectDeviceInfo {\n  /** Device identifier (MAC address) */\n  deviceId: string;\n  /** Device name */\n  name: string;\n  /** Device status */\n  status: WifiDirectDeviceStatus;\n  /** Whether the device is a group owner */\n  isGroupOwner: boolean;\n  /** Primary device type (e.g., \"smartphone\") */\n  primaryDeviceType?: string;\n  /** Secondary device type */\n  secondaryDeviceType?: string;\n  /** Wi-Fi Protected Setup (WPS) configuration methods */\n  wpsConfigMethods?: number;\n  /** Service discovery records */\n  serviceRecords?: WifiDirectServiceRecord[];\n  /** Last seen timestamp */\n  lastSeen: number;\n}\n\n/**\n * Wi-Fi Direct service record for service discovery\n */\nexport interface WifiDirectServiceRecord {\n  /** Service type (e.g., \"_sc._tcp\") */\n  serviceType: string;\n  /** Instance name */\n  instanceName: string;\n  /** TXT record data */\n  txtRecord?: Map<string, string>;\n}\n\n/**\n * Wi-Fi Direct group info\n */\nexport interface WifiDirectGroupInfo {\n  /** Network name (SSID) */\n  networkName: string;\n  /** Passphrase for the group */\n  passphrase?: string;\n  /** Group owner's device info */\n  owner: WifiDirectDeviceInfo;\n  /** List of client devices in the group */\n  clients: WifiDirectDeviceInfo[];\n  /** Whether this device is the group owner */\n  isOwner: boolean;\n  /** Interface name for the group */\n  interfaceName?: string;\n  /** Group formation timestamp */\n  createdAt: number;\n}\n\n/**\n * Wi-Fi Direct-specific transport configuration\n */\nexport interface WifiDirectTransportConfig extends TransportConfig {\n  /** Service type for mDNS discovery */\n  serviceType?: string;\n  /** Service instance name */\n  serviceName?: string;\n  /** Port for TCP/UDP communication */\n  port?: number;\n  /** Whether to prefer being group owner */\n  preferGroupOwner?: boolean;\n  /** Group owner intent (0-15, higher = more likely to be GO) */\n  groupOwnerIntent?: number;\n  /** Whether to use persistent groups */\n  persistentGroup?: boolean;\n  /** Discovery timeout in milliseconds */\n  discoveryTimeout?: number;\n  /** Connection timeout in milliseconds */\n  connectionTimeout?: number;\n  /** Enable service discovery (Bonjour/mDNS) */\n  enableServiceDiscovery?: boolean;\n}\n\n/**\n * Wi-Fi Direct-specific transport events\n */\nexport interface WifiDirectTransportEvents extends TransportEvents {\n  /**\n   * Called when a Wi-Fi Direct device is discovered.\n   * @param device The discovered device info\n   */\n  onDeviceDiscovered?(device: WifiDirectDeviceInfo): void;\n\n  /**\n   * Called when a Wi-Fi Direct group is formed.\n   * @param group The group info\n   */\n  onGroupFormed?(group: WifiDirectGroupInfo): void;\n\n  /**\n   * Called when the Wi-Fi Direct group is removed/disbanded.\n   */\n  onGroupRemoved?(): void;\n\n  /**\n   * Called when this device's role in the group changes.\n   * @param role The new role\n   */\n  onRoleChanged?(role: WifiDirectRole): void;\n\n  /**\n   * Called when a connection request is received.\n   * @param device The device requesting connection\n   */\n  onConnectionRequest?(device: WifiDirectDeviceInfo): void;\n\n  /**\n   * Called when discovery state changes.\n   * @param isDiscovering Whether discovery is active\n   */\n  onDiscoveryStateChanged?(isDiscovering: boolean): void;\n\n  /**\n   * Called when Wi-Fi Direct state changes (enabled/disabled).\n   * @param isEnabled Whether Wi-Fi Direct is enabled\n   */\n  onWifiDirectStateChanged?(isEnabled: boolean): void;\n}\n\n/**\n * Extended peer info for Wi-Fi Direct connections\n */\nexport interface WifiDirectPeerInfo extends TransportPeerInfo {\n  /** Device MAC address */\n  macAddress?: string;\n  /** Device name */\n  deviceName?: string;\n  /** IP address (available after connection) */\n  ipAddress?: string;\n  /** Role in the group */\n  role: WifiDirectRole;\n  /** Whether this peer is the group owner */\n  isGroupOwner: boolean;\n  /** Bandwidth estimate in Mbps */\n  bandwidthMbps?: number;\n}\n\n/**\n * Wi-Fi Direct Transport interface extending the base Transport interface.\n */\nexport interface WifiDirectTransport extends Transport {\n  /**\n   * Start device discovery to find nearby Wi-Fi Direct devices.\n   */\n  startDiscovery(): Promise<void>;\n\n  /**\n   * Stop device discovery.\n   */\n  stopDiscovery(): Promise<void>;\n\n  /**\n   * Check if discovery is currently active.\n   */\n  isDiscovering(): boolean;\n\n  /**\n   * Get list of discovered devices.\n   */\n  getDiscoveredDevices(): WifiDirectDeviceInfo[];\n\n  /**\n   * Create a Wi-Fi Direct group (become group owner).\n   */\n  createGroup(): Promise<WifiDirectGroupInfo>;\n\n  /**\n   * Remove/disband the current group.\n   */\n  removeGroup(): Promise<void>;\n\n  /**\n   * Get current group info if in a group.\n   */\n  getGroupInfo(): WifiDirectGroupInfo | undefined;\n\n  /**\n   * Get this device's role in the current group.\n   */\n  getRole(): WifiDirectRole;\n\n  /**\n   * Check if Wi-Fi Direct is available on this device.\n   */\n  isWifiDirectAvailable(): Promise<boolean>;\n\n  /**\n   * Request Wi-Fi Direct connection info (IP addresses, etc.).\n   */\n  requestConnectionInfo(): Promise<\n    { groupOwnerAddress: string; isGroupOwner: boolean } | undefined\n  >;\n\n  /**\n   * Register a local service for service discovery.\n   * @param serviceRecord The service record to register\n   */\n  registerService(serviceRecord: WifiDirectServiceRecord): Promise<void>;\n\n  /**\n   * Unregister a previously registered service.\n   */\n  unregisterService(): Promise<void>;\n\n  /**\n   * Start service discovery to find specific services.\n   * @param serviceType The service type to discover (e.g., \"_sc._tcp\")\n   */\n  discoverServices(serviceType?: string): Promise<void>;\n\n  /**\n   * Get Wi-Fi Direct-specific peer info.\n   * @param peerId The peer ID to query\n   */\n  getWifiDirectPeerInfo(\n    peerId: TransportPeerId,\n  ): WifiDirectPeerInfo | undefined;\n}\n\n/**\n * Default Wi-Fi Direct transport configuration.\n */\nexport const DEFAULT_WIFI_DIRECT_CONFIG: Required<WifiDirectTransportConfig> = {\n  serviceType: \"_sc._tcp\",\n  serviceName: \"SC Mesh Node\",\n  port: 8988,\n  preferGroupOwner: false,\n  groupOwnerIntent: 7,\n  persistentGroup: true,\n  discoveryTimeout: 30000,\n  connectionTimeout: 30000,\n  enableServiceDiscovery: true,\n  maxPeers: 10,\n  heartbeatInterval: 30000,\n  options: {},\n};\n\n/**\n * Mock Wi-Fi Direct Transport for testing and web environments.\n */\nexport class MockWifiDirectTransport implements WifiDirectTransport {\n  readonly localPeerId: TransportPeerId;\n  readonly name = \"wifi-direct\";\n\n  private config: Required<WifiDirectTransportConfig>;\n  private events: WifiDirectTransportEvents | null = null;\n  private peers: Map<TransportPeerId, WifiDirectPeerInfo> = new Map();\n  private discoveredDevices: Map<string, WifiDirectDeviceInfo> = new Map();\n  private isRunning = false;\n  private _isDiscovering = false;\n  private _role: WifiDirectRole = WifiDirectRole.UNDETERMINED;\n  private _groupInfo: WifiDirectGroupInfo | undefined;\n  private discoveryInterval: NodeJS.Timeout | null = null;\n\n  constructor(\n    localPeerId: TransportPeerId,\n    config: WifiDirectTransportConfig = {},\n  ) {\n    this.localPeerId = localPeerId;\n    this.config = { ...DEFAULT_WIFI_DIRECT_CONFIG, ...config };\n  }\n\n  async start(events: WifiDirectTransportEvents): Promise<void> {\n    this.events = events;\n    this.isRunning = true;\n  }\n\n  async stop(): Promise<void> {\n    await this.stopDiscovery();\n    await this.removeGroup();\n    this.peers.clear();\n    this.discoveredDevices.clear();\n    this.events = null;\n    this.isRunning = false;\n  }\n\n  async connect(peerId: TransportPeerId): Promise<void> {\n    if (!this.isRunning) {\n      throw new Error(\"Transport not started\");\n    }\n\n    const peerInfo: WifiDirectPeerInfo = {\n      peerId,\n      state: \"connecting\",\n      transportType: \"wifi-direct\",\n      connectionQuality: 95,\n      bytesSent: 0,\n      bytesReceived: 0,\n      lastSeen: Date.now(),\n      role: WifiDirectRole.CLIENT,\n      isGroupOwner: false,\n      bandwidthMbps: 250,\n    };\n\n    this.peers.set(peerId, peerInfo);\n    this.events?.onStateChange?.(peerId, \"connecting\");\n\n    // Simulate connection delay\n    await new Promise((resolve) => setTimeout(resolve, 200));\n\n    peerInfo.state = \"connected\";\n    peerInfo.ipAddress = `192.168.49.${Math.floor(Math.random() * 254) + 1}`;\n    this.events?.onStateChange?.(peerId, \"connected\");\n    this.events?.onPeerConnected?.(peerId, peerInfo);\n  }\n\n  async disconnect(peerId: TransportPeerId): Promise<void> {\n    const peer = this.peers.get(peerId);\n    if (peer) {\n      peer.state = \"disconnected\";\n      this.events?.onStateChange?.(peerId, \"disconnected\");\n      this.events?.onPeerDisconnected?.(peerId, \"disconnected\");\n      this.peers.delete(peerId);\n    }\n  }\n\n  async send(peerId: TransportPeerId, payload: Uint8Array): Promise<void> {\n    const peer = this.peers.get(peerId);\n    if (!peer || peer.state !== \"connected\") {\n      throw new Error(`Peer ${peerId} not connected`);\n    }\n\n    peer.bytesSent = (peer.bytesSent || 0) + payload.length;\n    peer.lastSeen = Date.now();\n  }\n\n  async broadcast(\n    payload: Uint8Array,\n    excludePeerId?: TransportPeerId,\n  ): Promise<void> {\n    const sendPromises: Promise<void>[] = [];\n    for (const [peerId, peer] of this.peers) {\n      if (peerId !== excludePeerId && peer.state === \"connected\") {\n        sendPromises.push(this.send(peerId, payload));\n      }\n    }\n    await Promise.all(sendPromises);\n  }\n\n  getConnectedPeers(): TransportPeerId[] {\n    return Array.from(this.peers.entries())\n      .filter(([, peer]) => peer.state === \"connected\")\n      .map(([id]) => id);\n  }\n\n  getPeerInfo(peerId: TransportPeerId): TransportPeerInfo | undefined {\n    return this.peers.get(peerId);\n  }\n\n  getConnectionState(\n    peerId: TransportPeerId,\n  ): TransportConnectionState | undefined {\n    return this.peers.get(peerId)?.state;\n  }\n\n  // Wi-Fi Direct-specific methods\n\n  async startDiscovery(): Promise<void> {\n    this._isDiscovering = true;\n    this.events?.onDiscoveryStateChanged?.(true);\n\n    // Simulate periodic device discovery\n    this.discoveryInterval = setInterval(() => {\n      const mockDevice: WifiDirectDeviceInfo = {\n        deviceId: `mock-wfd-${Date.now()}`,\n        name: `SC Peer ${Math.floor(Math.random() * 100)}`,\n        status: WifiDirectDeviceStatus.AVAILABLE,\n        isGroupOwner: Math.random() > 0.7,\n        primaryDeviceType: \"smartphone\",\n        lastSeen: Date.now(),\n      };\n      this.discoveredDevices.set(mockDevice.deviceId, mockDevice);\n      this.events?.onDeviceDiscovered?.(mockDevice);\n    }, 3000);\n  }\n\n  async stopDiscovery(): Promise<void> {\n    this._isDiscovering = false;\n    if (this.discoveryInterval) {\n      clearInterval(this.discoveryInterval);\n      this.discoveryInterval = null;\n    }\n    this.events?.onDiscoveryStateChanged?.(false);\n  }\n\n  isDiscovering(): boolean {\n    return this._isDiscovering;\n  }\n\n  getDiscoveredDevices(): WifiDirectDeviceInfo[] {\n    return Array.from(this.discoveredDevices.values());\n  }\n\n  async createGroup(): Promise<WifiDirectGroupInfo> {\n    this._role = WifiDirectRole.GROUP_OWNER;\n\n    const ownerDevice: WifiDirectDeviceInfo = {\n      deviceId: this.localPeerId,\n      name: \"This Device\",\n      status: WifiDirectDeviceStatus.CONNECTED,\n      isGroupOwner: true,\n      lastSeen: Date.now(),\n    };\n\n    this._groupInfo = {\n      networkName: `DIRECT-SC-${Math.random().toString(36).slice(2, 6).toUpperCase()}`,\n      passphrase: Math.random().toString(36).slice(2, 10),\n      owner: ownerDevice,\n      clients: [],\n      isOwner: true,\n      interfaceName: \"p2p-wlan0-0\",\n      createdAt: Date.now(),\n    };\n\n    this.events?.onGroupFormed?.(this._groupInfo);\n    this.events?.onRoleChanged?.(WifiDirectRole.GROUP_OWNER);\n\n    return this._groupInfo;\n  }\n\n  async removeGroup(): Promise<void> {\n    if (this._groupInfo) {\n      this._groupInfo = undefined;\n      this._role = WifiDirectRole.UNDETERMINED;\n      this.events?.onGroupRemoved?.();\n      this.events?.onRoleChanged?.(WifiDirectRole.UNDETERMINED);\n    }\n  }\n\n  getGroupInfo(): WifiDirectGroupInfo | undefined {\n    return this._groupInfo;\n  }\n\n  getRole(): WifiDirectRole {\n    return this._role;\n  }\n\n  async isWifiDirectAvailable(): Promise<boolean> {\n    // Mock always returns true\n    return true;\n  }\n\n  async requestConnectionInfo(): Promise<\n    { groupOwnerAddress: string; isGroupOwner: boolean } | undefined\n  > {\n    if (!this._groupInfo) {\n      return undefined;\n    }\n\n    return {\n      groupOwnerAddress: \"192.168.49.1\", // Group owner is always at this address in P2P\n      isGroupOwner: this._groupInfo.isOwner,\n    };\n  }\n\n  async registerService(serviceRecord: WifiDirectServiceRecord): Promise<void> {\n    // Mock: just log the service registration\n    console.log(\"Registered Wi-Fi Direct service:\", serviceRecord);\n  }\n\n  async unregisterService(): Promise<void> {\n    // Mock: nothing to do\n  }\n\n  async discoverServices(serviceType?: string): Promise<void> {\n    // Mock: simulate service discovery\n    console.log(\n      \"Discovering Wi-Fi Direct services:\",\n      serviceType || this.config.serviceType,\n    );\n  }\n\n  getWifiDirectPeerInfo(\n    peerId: TransportPeerId,\n  ): WifiDirectPeerInfo | undefined {\n    return this.peers.get(peerId);\n  }\n\n  /**\n   * Simulate receiving a message from a peer.\n   * Used for testing purposes.\n   */\n  simulateMessage(from: TransportPeerId, payload: Uint8Array): void {\n    const peer = this.peers.get(from);\n    if (peer) {\n      peer.bytesReceived = (peer.bytesReceived || 0) + payload.length;\n      peer.lastSeen = Date.now();\n    }\n\n    this.events?.onMessage({\n      from,\n      payload,\n      timestamp: Date.now(),\n    });\n  }\n\n  /**\n   * Simulate an incoming connection request.\n   * Used for testing purposes.\n   */\n  simulateConnectionRequest(device: WifiDirectDeviceInfo): void {\n    this.events?.onConnectionRequest?.(device);\n  }\n}\n\n// Register the mock Wi-Fi Direct transport factory\ntransportRegistry.register(\"wifi-direct\", (config?: TransportConfig) => {\n  const peerId = `wfd-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`;\n  return new MockWifiDirectTransport(\n    peerId,\n    config as WifiDirectTransportConfig,\n  );\n});\n\n/**\n * Wi-Fi Direct transport factory type\n */\nexport type WifiDirectTransportFactory = (\n  localPeerId: TransportPeerId,\n  config?: WifiDirectTransportConfig,\n) => WifiDirectTransport;\n"],"version":3}