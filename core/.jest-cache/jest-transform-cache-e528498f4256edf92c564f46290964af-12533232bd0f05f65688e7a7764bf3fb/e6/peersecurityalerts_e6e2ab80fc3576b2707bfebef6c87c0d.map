{"file":"/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/mesh/peer-security-alerts.ts","mappings":"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","names":[],"sources":["/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/mesh/peer-security-alerts.ts"],"sourcesContent":["/**\n * Decentralized Peer Security Alert System\n * \n * Enables peers to broadcast security warnings about compromised identities,\n * malicious actors, or suspicious behavior in the mesh network.\n * \n * Key principles:\n * - No central authority (decentralized trust)\n * - Alerts are informational, not authoritative\n * - Users maintain own reputation scoring\n * - Out-of-band verification recommended for critical alerts\n */\n\nimport { signMessage, verifySignature } from '../crypto/primitives.js';\n\nexport enum SecurityAlertType {\n  /** Identity keys compromised (device stolen, malware, etc.) */\n  IDENTITY_COMPROMISE = 'IDENTITY_COMPROMISE',\n  \n  /** Peer sending spam or flooding network */\n  SPAM_BEHAVIOR = 'SPAM_BEHAVIOR',\n  \n  /** Peer violating protocol rules */\n  PROTOCOL_VIOLATION = 'PROTOCOL_VIOLATION',\n  \n  /** Suspicious signature mismatches detected */\n  SIGNATURE_ANOMALY = 'SIGNATURE_ANOMALY',\n  \n  /** Peer attempting Sybil attack (multiple identities) */\n  SYBIL_ATTACK = 'SYBIL_ATTACK',\n  \n  /** Eclipse attack attempt (isolating peers) */\n  ECLIPSE_ATTACK = 'ECLIPSE_ATTACK',\n  \n  /** General malicious activity */\n  MALICIOUS_ACTIVITY = 'MALICIOUS_ACTIVITY',\n  \n  /** Alert revocation (false alarm) */\n  ALERT_REVOKED = 'ALERT_REVOKED',\n}\n\nexport enum AlertSeverity {\n  /** Informational - awareness only */\n  INFO = 'INFO',\n  \n  /** Low severity - minor concern */\n  LOW = 'LOW',\n  \n  /** Medium severity - investigate */\n  MEDIUM = 'MEDIUM',\n  \n  /** High severity - likely threat */\n  HIGH = 'HIGH',\n  \n  /** Critical - immediate action recommended */\n  CRITICAL = 'CRITICAL',\n}\n\nexport interface SecurityAlert {\n  /** Unique alert ID (hash of alert content) */\n  alertId: string;\n  \n  /** Type of security incident */\n  type: SecurityAlertType;\n  \n  /** Severity level */\n  severity: AlertSeverity;\n  \n  /** Peer ID being reported */\n  suspiciousPeerId: string;\n  \n  /** Peer ID issuing the alert */\n  reporterId: string;\n  \n  /** Human-readable description */\n  description: string;\n  \n  /** Optional evidence (hashes, timestamps, etc.) */\n  evidence?: {\n    messageHash?: string;\n    timestamp?: number;\n    signatureMismatch?: boolean;\n    violationType?: string;\n    [key: string]: any;\n  };\n  \n  /** Alert timestamp */\n  timestamp: number;\n  \n  /** TTL for alert propagation (hops) */\n  ttl: number;\n  \n  /** Ed25519 signature from reporter */\n  signature: Uint8Array;\n}\n\nexport interface AlertVerification {\n  /** Is signature valid? */\n  signatureValid: boolean;\n  \n  /** Alert metadata */\n  alert: SecurityAlert;\n  \n  /** Verification timestamp */\n  verifiedAt: number;\n}\n\nexport interface PeerReputation {\n  /** Peer ID */\n  peerId: string;\n  \n  /** Reputation score (-100 to 100) */\n  score: number;\n  \n  /** Number of positive reports */\n  positiveReports: number;\n  \n  /** Number of negative reports */\n  negativeReports: number;\n  \n  /** Active alerts against this peer */\n  activeAlerts: SecurityAlert[];\n  \n  /** Last updated */\n  lastUpdated: number;\n}\n\nexport class PeerSecurityAlertSystem {\n  private receivedAlerts: Map<string, SecurityAlert> = new Map();\n  private peerReputations: Map<string, PeerReputation> = new Map();\n  private alertCallbacks: Set<(alert: SecurityAlert) => void> = new Set();\n  \n  // Configuration\n  private readonly MAX_ALERT_AGE = 7 * 24 * 60 * 60 * 1000; // 7 days\n  private readonly INITIAL_REPUTATION = 50;\n  private readonly MIN_REPUTATION = -100;\n  private readonly MAX_REPUTATION = 100;\n  \n  /**\n   * Create a new security alert\n   */\n  async createAlert(\n    type: SecurityAlertType,\n    suspiciousPeerId: string,\n    reporterId: string,\n    reporterPrivateKey: Uint8Array,\n    description: string,\n    severity: AlertSeverity = AlertSeverity.MEDIUM,\n    evidence?: any\n  ): Promise<SecurityAlert> {\n    const timestamp = Date.now();\n    \n    // Create alert without signature\n    const alertData = {\n      type,\n      severity,\n      suspiciousPeerId,\n      reporterId,\n      description,\n      evidence,\n      timestamp,\n      ttl: 5, // 5 hops maximum\n    };\n    \n    // Generate alert ID from content\n    const alertContent = JSON.stringify(alertData);\n    const encoder = new TextEncoder();\n    const contentBytes = encoder.encode(alertContent);\n    const hashBuffer = await crypto.subtle.digest('SHA-256', contentBytes);\n    const alertId = Array.from(new Uint8Array(hashBuffer))\n      .map(b => b.toString(16).padStart(2, '0'))\n      .join('')\n      .substring(0, 16);\n    \n    // Sign the alert\n    const signature = await signMessage(contentBytes, reporterPrivateKey);\n    \n    const alert: SecurityAlert = {\n      alertId,\n      ...alertData,\n      signature,\n    };\n    \n    // Store locally\n    this.receivedAlerts.set(alertId, alert);\n    \n    // Update reputation\n    this.updateReputationFromAlert(alert, -10); // Negative report\n    \n    return alert;\n  }\n  \n  /**\n   * Verify and process incoming alert\n   */\n  async processAlert(alert: SecurityAlert, reporterPublicKey: Uint8Array): Promise<AlertVerification> {\n    // Create alert content for signature verification\n    const alertData = {\n      type: alert.type,\n      severity: alert.severity,\n      suspiciousPeerId: alert.suspiciousPeerId,\n      reporterId: alert.reporterId,\n      description: alert.description,\n      evidence: alert.evidence,\n      timestamp: alert.timestamp,\n      ttl: alert.ttl,\n    };\n    \n    const alertContent = JSON.stringify(alertData);\n    const encoder = new TextEncoder();\n    const contentBytes = encoder.encode(alertContent);\n    \n    // Verify signature\n    const signatureValid = verifySignature(\n      contentBytes,\n      alert.signature,\n      reporterPublicKey\n    );\n    \n    const verification: AlertVerification = {\n      signatureValid,\n      alert,\n      verifiedAt: Date.now(),\n    };\n    \n    if (!signatureValid) {\n      console.warn('Invalid alert signature from', alert.reporterId);\n      return verification;\n    }\n    \n    // Check if alert is too old\n    const age = Date.now() - alert.timestamp;\n    if (age > this.MAX_ALERT_AGE) {\n      console.warn('Alert expired (too old):', alert.alertId);\n      return verification;\n    }\n    \n    // Check for duplicate\n    if (this.receivedAlerts.has(alert.alertId)) {\n      return verification; // Already processed\n    }\n    \n    // Store alert\n    this.receivedAlerts.set(alert.alertId, alert);\n    \n    // Update reputation\n    const impact = this.getReputationImpact(alert.severity);\n    this.updateReputationFromAlert(alert, impact);\n    \n    // Notify listeners\n    this.notifyAlertReceived(alert);\n    \n    return verification;\n  }\n  \n  /**\n   * Get reputation impact based on severity\n   */\n  private getReputationImpact(severity: AlertSeverity): number {\n    switch (severity) {\n      case AlertSeverity.CRITICAL: return -20;\n      case AlertSeverity.HIGH: return -15;\n      case AlertSeverity.MEDIUM: return -10;\n      case AlertSeverity.LOW: return -5;\n      case AlertSeverity.INFO: return -2;\n      default: return -5;\n    }\n  }\n  \n  /**\n   * Update peer reputation based on alert\n   */\n  private updateReputationFromAlert(alert: SecurityAlert, impact: number): void {\n    const peerId = alert.suspiciousPeerId;\n    \n    let reputation = this.peerReputations.get(peerId);\n    if (!reputation) {\n      reputation = {\n        peerId,\n        score: this.INITIAL_REPUTATION,\n        positiveReports: 0,\n        negativeReports: 0,\n        activeAlerts: [],\n        lastUpdated: Date.now(),\n      };\n      this.peerReputations.set(peerId, reputation);\n    }\n    \n    // Update score\n    reputation.score = Math.max(\n      this.MIN_REPUTATION,\n      Math.min(this.MAX_REPUTATION, reputation.score + impact)\n    );\n    \n    // Update counters\n    if (impact < 0) {\n      reputation.negativeReports++;\n    } else {\n      reputation.positiveReports++;\n    }\n    \n    // Add to active alerts (unless revocation)\n    if (alert.type !== SecurityAlertType.ALERT_REVOKED) {\n      reputation.activeAlerts.push(alert);\n    } else {\n      // Remove revoked alerts\n      reputation.activeAlerts = reputation.activeAlerts.filter(\n        a => a.alertId !== alert.evidence?.revokedAlertId\n      );\n    }\n    \n    reputation.lastUpdated = Date.now();\n  }\n  \n  /**\n   * Get peer reputation\n   */\n  getPeerReputation(peerId: string): PeerReputation {\n    const reputation = this.peerReputations.get(peerId);\n    if (!reputation) {\n      return {\n        peerId,\n        score: this.INITIAL_REPUTATION,\n        positiveReports: 0,\n        negativeReports: 0,\n        activeAlerts: [],\n        lastUpdated: Date.now(),\n      };\n    }\n    return reputation;\n  }\n  \n  /**\n   * Check if peer should be blocked based on reputation\n   */\n  shouldBlockPeer(peerId: string, threshold: number = 20): boolean {\n    const reputation = this.getPeerReputation(peerId);\n    return reputation.score < threshold;\n  }\n  \n  /**\n   * Get all alerts for a specific peer\n   */\n  getAlertsForPeer(peerId: string): SecurityAlert[] {\n    return Array.from(this.receivedAlerts.values()).filter(\n      alert => alert.suspiciousPeerId === peerId\n    );\n  }\n  \n  /**\n   * Get alerts by type\n   */\n  getAlertsByType(type: SecurityAlertType): SecurityAlert[] {\n    return Array.from(this.receivedAlerts.values()).filter(\n      alert => alert.type === type\n    );\n  }\n  \n  /**\n   * Subscribe to alert notifications\n   */\n  onAlertReceived(callback: (alert: SecurityAlert) => void): () => void {\n    this.alertCallbacks.add(callback);\n    return () => this.alertCallbacks.delete(callback);\n  }\n  \n  /**\n   * Notify listeners of new alert\n   */\n  private notifyAlertReceived(alert: SecurityAlert): void {\n    for (const callback of this.alertCallbacks) {\n      try {\n        callback(alert);\n      } catch (error) {\n        console.error('Alert callback error:', error);\n      }\n    }\n  }\n  \n  /**\n   * Revoke a previously issued alert (false alarm)\n   */\n  async revokeAlert(\n    originalAlertId: string,\n    reporterId: string,\n    reporterPrivateKey: Uint8Array,\n    reason: string\n  ): Promise<SecurityAlert | null> {\n    const originalAlert = this.receivedAlerts.get(originalAlertId);\n    if (!originalAlert) {\n      console.warn('Cannot revoke unknown alert:', originalAlertId);\n      return null;\n    }\n    \n    // Only original reporter can revoke\n    if (originalAlert.reporterId !== reporterId) {\n      console.warn('Only original reporter can revoke alert');\n      return null;\n    }\n    \n    // Create revocation alert\n    return this.createAlert(\n      SecurityAlertType.ALERT_REVOKED,\n      originalAlert.suspiciousPeerId,\n      reporterId,\n      reporterPrivateKey,\n      `Revoked: ${reason}`,\n      AlertSeverity.INFO,\n      { revokedAlertId: originalAlertId }\n    );\n  }\n  \n  /**\n   * Prepare alert for relay (decrease TTL)\n   */\n  prepareForRelay(alert: SecurityAlert): SecurityAlert | null {\n    if (alert.ttl <= 1) {\n      return null; // Don't relay, TTL exhausted\n    }\n    \n    return {\n      ...alert,\n      ttl: alert.ttl - 1,\n    };\n  }\n  \n  /**\n   * Cleanup old alerts\n   */\n  cleanup(): number {\n    const now = Date.now();\n    let removed = 0;\n    \n    for (const [alertId, alert] of this.receivedAlerts.entries()) {\n      const age = now - alert.timestamp;\n      if (age > this.MAX_ALERT_AGE) {\n        this.receivedAlerts.delete(alertId);\n        removed++;\n      }\n    }\n    \n    return removed;\n  }\n  \n  /**\n   * Get statistics\n   */\n  getStatistics() {\n    const alerts = Array.from(this.receivedAlerts.values());\n    \n    return {\n      totalAlerts: alerts.length,\n      alertsByType: {\n        identityCompromise: alerts.filter(a => a.type === SecurityAlertType.IDENTITY_COMPROMISE).length,\n        spam: alerts.filter(a => a.type === SecurityAlertType.SPAM_BEHAVIOR).length,\n        protocolViolation: alerts.filter(a => a.type === SecurityAlertType.PROTOCOL_VIOLATION).length,\n        signatureAnomaly: alerts.filter(a => a.type === SecurityAlertType.SIGNATURE_ANOMALY).length,\n        sybilAttack: alerts.filter(a => a.type === SecurityAlertType.SYBIL_ATTACK).length,\n        eclipseAttack: alerts.filter(a => a.type === SecurityAlertType.ECLIPSE_ATTACK).length,\n        malicious: alerts.filter(a => a.type === SecurityAlertType.MALICIOUS_ACTIVITY).length,\n        revoked: alerts.filter(a => a.type === SecurityAlertType.ALERT_REVOKED).length,\n      },\n      alertsBySeverity: {\n        critical: alerts.filter(a => a.severity === AlertSeverity.CRITICAL).length,\n        high: alerts.filter(a => a.severity === AlertSeverity.HIGH).length,\n        medium: alerts.filter(a => a.severity === AlertSeverity.MEDIUM).length,\n        low: alerts.filter(a => a.severity === AlertSeverity.LOW).length,\n        info: alerts.filter(a => a.severity === AlertSeverity.INFO).length,\n      },\n      trackedPeers: this.peerReputations.size,\n      peersWithNegativeReputation: Array.from(this.peerReputations.values()).filter(\n        r => r.score < this.INITIAL_REPUTATION\n      ).length,\n    };\n  }\n}\n\n/**\n * Helper: Create device theft alert\n */\nexport async function createDeviceTheftAlert(\n  stolenDevicePeerId: string,\n  reporterId: string,\n  reporterPrivateKey: Uint8Array,\n  deviceDetails?: string\n): Promise<SecurityAlert> {\n  const alertSystem = new PeerSecurityAlertSystem();\n  \n  return alertSystem.createAlert(\n    SecurityAlertType.IDENTITY_COMPROMISE,\n    stolenDevicePeerId,\n    reporterId,\n    reporterPrivateKey,\n    `Device reported stolen. Do not trust messages from this identity. ${deviceDetails || ''}`,\n    AlertSeverity.CRITICAL,\n    {\n      reason: 'device_theft',\n      reportedAt: Date.now(),\n    }\n  );\n}\n\n/**\n * Helper: Create spam alert\n */\nexport async function createSpamAlert(\n  spammerPeerId: string,\n  reporterId: string,\n  reporterPrivateKey: Uint8Array,\n  messageCount: number\n): Promise<SecurityAlert> {\n  const alertSystem = new PeerSecurityAlertSystem();\n  \n  return alertSystem.createAlert(\n    SecurityAlertType.SPAM_BEHAVIOR,\n    spammerPeerId,\n    reporterId,\n    reporterPrivateKey,\n    `Peer sending excessive messages (${messageCount} in short period)`,\n    AlertSeverity.MEDIUM,\n    {\n      messageCount,\n      detectedAt: Date.now(),\n    }\n  );\n}\n"],"version":3}