{"file":"/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/compression.ts","mappings":";AAAA;;;;;GAKG;;AAgBH,0CAqCC;AAKD,8CAcC;AAKD,kDAGC;AA9ED,mCAA8C;AAE9C,MAAM,sBAAsB,GAAG,IAAI,CAAC,CAAC,oCAAoC;AASzE;;GAEG;AACH,SAAgB,eAAe,CAAC,IAAgB;IAC9C,MAAM,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC;IAEjC,gCAAgC;IAChC,IAAI,YAAY,GAAG,sBAAsB,EAAE,CAAC;QAC1C,OAAO;YACL,IAAI;YACJ,UAAU,EAAE,KAAK;YACjB,YAAY;YACZ,cAAc,EAAE,YAAY;SAC7B,CAAC;IACJ,CAAC;IAED,IAAI,CAAC;QACH,MAAM,UAAU,GAAG,IAAA,iBAAQ,EAAC,IAAI,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QAChD,MAAM,cAAc,GAAG,UAAU,CAAC,MAAM,CAAC;QAEzC,mDAAmD;QACnD,IAAI,cAAc,GAAG,YAAY,GAAG,GAAG,EAAE,CAAC;YACxC,OAAO;gBACL,IAAI,EAAE,UAAU;gBAChB,UAAU,EAAE,IAAI;gBAChB,YAAY;gBACZ,cAAc;aACf,CAAC;QACJ,CAAC;IACH,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,OAAO,CAAC,KAAK,CAAC,qBAAqB,EAAE,KAAK,CAAC,CAAC;IAC9C,CAAC;IAED,iDAAiD;IACjD,OAAO;QACL,IAAI;QACJ,UAAU,EAAE,KAAK;QACjB,YAAY;QACZ,cAAc,EAAE,YAAY;KAC7B,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,SAAgB,iBAAiB,CAC/B,IAAgB,EAChB,aAAsB;IAEtB,IAAI,CAAC,aAAa,EAAE,CAAC;QACnB,OAAO,IAAI,CAAC;IACd,CAAC;IAED,IAAI,CAAC;QACH,OAAO,IAAA,mBAAU,EAAC,IAAI,CAAC,CAAC;IAC1B,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,OAAO,CAAC,KAAK,CAAC,uBAAuB,EAAE,KAAK,CAAC,CAAC;QAC9C,MAAM,IAAI,KAAK,CAAC,8BAA8B,CAAC,CAAC;IAClD,CAAC;AACH,CAAC;AAED;;GAEG;AACH,SAAgB,mBAAmB,CAAC,MAAyB;IAC3D,IAAI,CAAC,MAAM,CAAC,UAAU;QAAE,OAAO,GAAG,CAAC;IACnC,OAAO,MAAM,CAAC,cAAc,GAAG,MAAM,CAAC,YAAY,CAAC;AACrD,CAAC","names":[],"sources":["/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/compression.ts"],"sourcesContent":["/**\n * Message compression using gzip\n * Compresses large messages to reduce bandwidth usage\n * \n * Note: fflate library not installed. Install with: npm install fflate\n */\n\nimport { gunzipSync, gzipSync } from 'fflate';\n\nconst _COMPRESSION_THRESHOLD = 1024; // Compress messages larger than 1KB\n\nexport interface CompressionResult {\n  data: Uint8Array;\n  compressed: boolean;\n  originalSize: number;\n  compressedSize: number;\n}\n\n/**\n * Compress data if it exceeds the threshold\n */\nexport function compressMessage(data: Uint8Array): CompressionResult {\n  const originalSize = data.length;\n\n  // Don't compress small messages\n  if (originalSize < _COMPRESSION_THRESHOLD) {\n    return {\n      data,\n      compressed: false,\n      originalSize,\n      compressedSize: originalSize,\n    };\n  }\n\n  try {\n    const compressed = gzipSync(data, { level: 6 });\n    const compressedSize = compressed.length;\n\n    // Only use compression if it actually reduces size\n    if (compressedSize < originalSize * 0.9) {\n      return {\n        data: compressed,\n        compressed: true,\n        originalSize,\n        compressedSize,\n      };\n    }\n  } catch (error) {\n    console.error('Compression failed:', error);\n  }\n\n  // Return uncompressed if compression didn't help\n  return {\n    data,\n    compressed: false,\n    originalSize,\n    compressedSize: originalSize,\n  };\n}\n\n/**\n * Decompress data if it was compressed\n */\nexport function decompressMessage(\n  data: Uint8Array,\n  wasCompressed: boolean\n): Uint8Array {\n  if (!wasCompressed) {\n    return data;\n  }\n\n  try {\n    return gunzipSync(data);\n  } catch (error) {\n    console.error('Decompression failed:', error);\n    throw new Error('Failed to decompress message');\n  }\n}\n\n/**\n * Get compression stats\n */\nexport function getCompressionRatio(result: CompressionResult): number {\n  if (!result.compressed) return 1.0;\n  return result.compressedSize / result.originalSize;\n}\n"],"version":3}