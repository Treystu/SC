64d75a17fc68beccac4faa84f7bac4cf
"use strict";
/**
 * Sharing and Invite Utilities
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateInviteLink = generateInviteLink;
exports.parseInviteLink = parseInviteLink;
exports.hexToBytes = hexToBytes;
exports.parseConnectionOffer = parseConnectionOffer;
const BASE_INVITE_URL = 'https://sc.app/join';
/**
 * Generate a user-friendly invite link from a pending invite
 */
function generateInviteLink(invite) {
    const url = new URL(BASE_INVITE_URL);
    url.searchParams.set('code', invite.code);
    url.searchParams.set('inviter', invite.inviterPeerId);
    if (invite.inviterName) {
        url.searchParams.set('name', invite.inviterName);
    }
    return url.toString();
}
/**
 * Parse an invite link and extract the invite code and other details
 */
function parseInviteLink(link) {
    try {
        const url = new URL(link);
        const code = url.searchParams.get('code');
        const inviterPeerId = url.searchParams.get('inviter');
        if (!code || !inviterPeerId) {
            return null;
        }
        const inviterName = url.searchParams.get('name') || undefined;
        return { code, inviterPeerId, inviterName };
    }
    catch (error) {
        return null; // Invalid URL
    }
}
/**
 * Convert hex string to Uint8Array
 */
function hexToBytes(hex) {
    if (!hex)
        return new Uint8Array(0);
    const bytes = new Uint8Array(hex.length / 2);
    for (let i = 0; i < hex.length; i += 2) {
        bytes[i / 2] = parseInt(hex.substring(i, i + 2), 16);
    }
    return bytes;
}
/**
 * Parse a connection offer string
 * Format: sc://offer?data=<base64_data>
 */
function parseConnectionOffer(offer) {
    try {
        const url = new URL(offer);
        if (url.protocol !== 'sc:')
            return null;
        const data = url.searchParams.get('data');
        if (!data)
            return null;
        return { data };
    }
    catch {
        return null;
    }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2NocmlzdHltYXh3ZWxsL0Rlc2t0b3AvTHVrZV9TdHVmZi9HaXRIdWIvU0MvY29yZS9zcmMvc2hhcmluZy91dGlsLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFTSCxnREFVQztBQUtELDBDQWdCQztBQUtELGdDQU9DO0FBTUQsb0RBWUM7QUFsRUQsTUFBTSxlQUFlLEdBQUcscUJBQXFCLENBQUM7QUFFOUM7O0dBRUc7QUFDSCxTQUFnQixrQkFBa0IsQ0FBQyxNQUFxQjtJQUN0RCxNQUFNLEdBQUcsR0FBRyxJQUFJLEdBQUcsQ0FBQyxlQUFlLENBQUMsQ0FBQztJQUNyQyxHQUFHLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUM7SUFFdEQsSUFBSSxNQUFNLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDdkIsR0FBRyxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUNuRCxDQUFDO0lBRUQsT0FBTyxHQUFHLENBQUMsUUFBUSxFQUFFLENBQUM7QUFDeEIsQ0FBQztBQUVEOztHQUVHO0FBQ0gsU0FBZ0IsZUFBZSxDQUFDLElBQVk7SUFDMUMsSUFBSSxDQUFDO1FBQ0gsTUFBTSxHQUFHLEdBQUcsSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDMUIsTUFBTSxJQUFJLEdBQUcsR0FBRyxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDMUMsTUFBTSxhQUFhLEdBQUcsR0FBRyxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUM7UUFFdEQsSUFBSSxDQUFDLElBQUksSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1lBQzVCLE9BQU8sSUFBSSxDQUFDO1FBQ2QsQ0FBQztRQUVELE1BQU0sV0FBVyxHQUFHLEdBQUcsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLFNBQVMsQ0FBQztRQUU5RCxPQUFPLEVBQUUsSUFBSSxFQUFFLGFBQWEsRUFBRSxXQUFXLEVBQUUsQ0FBQztJQUM5QyxDQUFDO0lBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztRQUNmLE9BQU8sSUFBSSxDQUFDLENBQUMsY0FBYztJQUM3QixDQUFDO0FBQ0gsQ0FBQztBQUVEOztHQUVHO0FBQ0gsU0FBZ0IsVUFBVSxDQUFDLEdBQVc7SUFDcEMsSUFBSSxDQUFDLEdBQUc7UUFBRSxPQUFPLElBQUksVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ25DLE1BQU0sS0FBSyxHQUFHLElBQUksVUFBVSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDN0MsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO1FBQ3ZDLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUN2RCxDQUFDO0lBQ0QsT0FBTyxLQUFLLENBQUM7QUFDZixDQUFDO0FBRUQ7OztHQUdHO0FBQ0gsU0FBZ0Isb0JBQW9CLENBQUMsS0FBYTtJQUNoRCxJQUFJLENBQUM7UUFDSCxNQUFNLEdBQUcsR0FBRyxJQUFJLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUMzQixJQUFJLEdBQUcsQ0FBQyxRQUFRLEtBQUssS0FBSztZQUFFLE9BQU8sSUFBSSxDQUFDO1FBRXhDLE1BQU0sSUFBSSxHQUFHLEdBQUcsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzFDLElBQUksQ0FBQyxJQUFJO1lBQUUsT0FBTyxJQUFJLENBQUM7UUFFdkIsT0FBTyxFQUFFLElBQUksRUFBRSxDQUFDO0lBQ2xCLENBQUM7SUFBQyxNQUFNLENBQUM7UUFDUCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7QUFDSCxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9jaHJpc3R5bWF4d2VsbC9EZXNrdG9wL0x1a2VfU3R1ZmYvR2l0SHViL1NDL2NvcmUvc3JjL3NoYXJpbmcvdXRpbC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFNoYXJpbmcgYW5kIEludml0ZSBVdGlsaXRpZXNcbiAqL1xuXG5pbXBvcnQgeyBQZW5kaW5nSW52aXRlIH0gZnJvbSAnLi90eXBlcy5qcyc7XG5cbmNvbnN0IEJBU0VfSU5WSVRFX1VSTCA9ICdodHRwczovL3NjLmFwcC9qb2luJztcblxuLyoqXG4gKiBHZW5lcmF0ZSBhIHVzZXItZnJpZW5kbHkgaW52aXRlIGxpbmsgZnJvbSBhIHBlbmRpbmcgaW52aXRlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUludml0ZUxpbmsoaW52aXRlOiBQZW5kaW5nSW52aXRlKTogc3RyaW5nIHtcbiAgY29uc3QgdXJsID0gbmV3IFVSTChCQVNFX0lOVklURV9VUkwpO1xuICB1cmwuc2VhcmNoUGFyYW1zLnNldCgnY29kZScsIGludml0ZS5jb2RlKTtcbiAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoJ2ludml0ZXInLCBpbnZpdGUuaW52aXRlclBlZXJJZCk7XG5cbiAgaWYgKGludml0ZS5pbnZpdGVyTmFtZSkge1xuICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KCduYW1lJywgaW52aXRlLmludml0ZXJOYW1lKTtcbiAgfVxuXG4gIHJldHVybiB1cmwudG9TdHJpbmcoKTtcbn1cblxuLyoqXG4gKiBQYXJzZSBhbiBpbnZpdGUgbGluayBhbmQgZXh0cmFjdCB0aGUgaW52aXRlIGNvZGUgYW5kIG90aGVyIGRldGFpbHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlSW52aXRlTGluayhsaW5rOiBzdHJpbmcpOiB7IGNvZGU6IHN0cmluZzsgaW52aXRlclBlZXJJZDogc3RyaW5nOyBpbnZpdGVyTmFtZT86IHN0cmluZyB9IHwgbnVsbCB7XG4gIHRyeSB7XG4gICAgY29uc3QgdXJsID0gbmV3IFVSTChsaW5rKTtcbiAgICBjb25zdCBjb2RlID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2NvZGUnKTtcbiAgICBjb25zdCBpbnZpdGVyUGVlcklkID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2ludml0ZXInKTtcblxuICAgIGlmICghY29kZSB8fCAhaW52aXRlclBlZXJJZCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgaW52aXRlck5hbWUgPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnbmFtZScpIHx8IHVuZGVmaW5lZDtcblxuICAgIHJldHVybiB7IGNvZGUsIGludml0ZXJQZWVySWQsIGludml0ZXJOYW1lIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIG51bGw7IC8vIEludmFsaWQgVVJMXG4gIH1cbn1cblxuLyoqXG4gKiBDb252ZXJ0IGhleCBzdHJpbmcgdG8gVWludDhBcnJheVxuICovXG5leHBvcnQgZnVuY3Rpb24gaGV4VG9CeXRlcyhoZXg6IHN0cmluZyk6IFVpbnQ4QXJyYXkge1xuICBpZiAoIWhleCkgcmV0dXJuIG5ldyBVaW50OEFycmF5KDApO1xuICBjb25zdCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGhleC5sZW5ndGggLyAyKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBoZXgubGVuZ3RoOyBpICs9IDIpIHtcbiAgICBieXRlc1tpIC8gMl0gPSBwYXJzZUludChoZXguc3Vic3RyaW5nKGksIGkgKyAyKSwgMTYpO1xuICB9XG4gIHJldHVybiBieXRlcztcbn1cblxuLyoqXG4gKiBQYXJzZSBhIGNvbm5lY3Rpb24gb2ZmZXIgc3RyaW5nXG4gKiBGb3JtYXQ6IHNjOi8vb2ZmZXI/ZGF0YT08YmFzZTY0X2RhdGE+XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUNvbm5lY3Rpb25PZmZlcihvZmZlcjogc3RyaW5nKTogeyBkYXRhOiBzdHJpbmcgfSB8IG51bGwge1xuICB0cnkge1xuICAgIGNvbnN0IHVybCA9IG5ldyBVUkwob2ZmZXIpO1xuICAgIGlmICh1cmwucHJvdG9jb2wgIT09ICdzYzonKSByZXR1cm4gbnVsbDtcblxuICAgIGNvbnN0IGRhdGEgPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnZGF0YScpO1xuICAgIGlmICghZGF0YSkgcmV0dXJuIG51bGw7XG5cbiAgICByZXR1cm4geyBkYXRhIH07XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59Il0sInZlcnNpb24iOjN9