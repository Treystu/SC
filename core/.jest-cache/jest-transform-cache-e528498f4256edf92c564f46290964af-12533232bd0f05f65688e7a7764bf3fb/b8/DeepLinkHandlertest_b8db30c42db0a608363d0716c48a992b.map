{"file":"/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/sharing/DeepLinkHandler.test.ts","mappings":"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","names":[],"sources":["/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/sharing/DeepLinkHandler.test.ts"],"sourcesContent":["/**\n * Tests for DeepLinkHandler\n */\n\nimport { describe, it, expect, beforeEach } from '@jest/globals';\nimport {\n  DeepLinkManager,\n  DeepLinkStorage,\n} from './DeepLinkHandler.js';\n\n// Mock storage implementation\nclass MockStorage implements DeepLinkStorage {\n  private store = new Map<string, string>();\n\n  async get(key: string): Promise<string | null> {\n    return this.store.get(key) || null;\n  }\n\n  async set(key: string, value: string): Promise<void> {\n    this.store.set(key, value);\n  }\n\n  async remove(key: string): Promise<void> {\n    this.store.delete(key);\n  }\n\n  clear(): void {\n    this.store.clear();\n  }\n}\n\ndescribe('DeepLinkManager', () => {\n  let manager: DeepLinkManager;\n  let storage: MockStorage;\n\n  beforeEach(() => {\n    storage = new MockStorage();\n    manager = new DeepLinkManager(storage);\n  });\n\n  describe('parseURL', () => {\n    it('should parse custom scheme join URL', () => {\n      const result = manager.parseURL('sc://join/ABC123');\n      expect(result).toEqual({\n        action: 'join',\n        params: { code: 'ABC123' },\n      });\n    });\n\n    it('should parse custom scheme connect URL', () => {\n      const result = manager.parseURL('sc://connect/peer123');\n      expect(result).toEqual({\n        action: 'connect',\n        params: { peer: 'peer123' },\n      });\n    });\n\n    it('should parse HTTPS URL with hash', () => {\n      const result = manager.parseURL('https://sc.app/join#ABC123');\n      expect(result).toEqual({\n        action: 'join',\n        params: { code: 'ABC123' },\n      });\n    });\n\n    it('should parse HTTPS URL with query params', () => {\n      const result = manager.parseURL(\n        'https://sc.app/join?code=ABC123&inviterName=Alice'\n      );\n      expect(result).toEqual({\n        action: 'join',\n        params: { code: 'ABC123', inviterName: 'Alice' },\n      });\n    });\n\n    it('should parse hash-only format', () => {\n      const result = manager.parseURL('#join=ABC123');\n      expect(result).toEqual({\n        action: 'join',\n        params: { code: 'ABC123' },\n      });\n    });\n\n    it('should parse path with hash', () => {\n      const result = manager.parseURL('/join#ABC123');\n      expect(result).toEqual({\n        action: 'join',\n        params: { code: 'ABC123' },\n      });\n    });\n\n    it('should return empty result for invalid URL', () => {\n      const result = manager.parseURL('invalid');\n      expect(result).toEqual({\n        action: '',\n        params: {},\n      });\n    });\n\n    it('should reject hash-based URLs from non-sc.app hosts', () => {\n      const result = manager.parseURL('https://evil.com/join#ABC123');\n      expect(result).toEqual({\n        action: 'join',\n        params: {},\n      });\n    });\n\n    it('should accept hash-based URLs from sc.app host', () => {\n      const result = manager.parseURL('https://sc.app/join#ABC123');\n      expect(result).toEqual({\n        action: 'join',\n        params: { code: 'ABC123' },\n      });\n    });\n  });\n\n  describe('handleURL', () => {\n    it('should handle join URL and store invite code', async () => {\n      // First set onboarding as complete\n      await storage.set('onboarding_complete', 'true');\n\n      const handled = await manager.handleURL('sc://join/ABC123');\n\n      expect(handled).toBe(true);\n      expect(await storage.get('pendingInvite')).toBe('ABC123');\n    });\n\n    it('should return false for unhandled action', async () => {\n      const handled = await manager.handleURL('sc://unknown/value');\n      expect(handled).toBe(false);\n    });\n\n    it('should return false for empty action', async () => {\n      const handled = await manager.handleURL('invalid-url');\n      expect(handled).toBe(false);\n    });\n  });\n\n  describe('registerHandler', () => {\n    it('should allow registering custom handlers', async () => {\n      let handledParams: Record<string, string | undefined> | null = null;\n\n      manager.registerHandler('custom', async (params) => {\n        handledParams = params;\n      });\n\n      await manager.handleURL('sc://custom/test');\n\n      expect(handledParams).toEqual({ value: 'test' });\n    });\n  });\n\n  describe('registerDefaultHandlers - join handler', () => {\n    it('should store invite code and inviter name when user is onboarded', async () => {\n      // Set user as onboarded\n      await storage.set('onboarding_complete', 'true');\n\n      const handled = await manager.handleURL('https://sc.app/join?code=ABC123&inviterName=Alice');\n\n      expect(handled).toBe(true);\n      expect(await storage.get('pendingInvite')).toBe('ABC123');\n      expect(await storage.get('pendingInviterName')).toBe('Alice');\n    });\n\n    it('should store invite code when user is not onboarded (deferred processing)', async () => {\n      // User is not onboarded\n      const handled = await manager.handleURL('sc://join/ABC123');\n\n      expect(handled).toBe(true);\n      expect(await storage.get('pendingInvite')).toBe('ABC123');\n    });\n\n    it('should handle join URL without inviter name', async () => {\n      await storage.set('onboarding_complete', 'true');\n\n      const handled = await manager.handleURL('sc://join/ABC123');\n\n      expect(handled).toBe(true);\n      expect(await storage.get('pendingInvite')).toBe('ABC123');\n      expect(await storage.get('pendingInviterName')).toBeNull();\n    });\n\n    it('should return false if no code provided in join action', async () => {\n      const handled = await manager.handleURL('sc://join/');\n      // Handler returns false because URL parsing fails with empty code\n      expect(handled).toBe(false);\n    });\n  });\n\n  describe('registerDefaultHandlers - connect handler', () => {\n    it('should store peer connection when connect action is triggered', async () => {\n      const handled = await manager.handleURL('sc://connect/peer123');\n\n      expect(handled).toBe(true);\n      expect(await storage.get('pendingPeerConnection')).toBe('peer123');\n    });\n\n    it('should handle connect with peer in params', async () => {\n      const handled = await manager.handleURL('https://sc.app/connect?peer=peer456');\n\n      expect(handled).toBe(true);\n      expect(await storage.get('pendingPeerConnection')).toBe('peer456');\n    });\n\n    it('should return false if no peer provided in connect action', async () => {\n      const handled = await manager.handleURL('sc://connect/');\n      // Connect handler checks for peer value\n      expect(await storage.get('pendingPeerConnection')).toBeNull();\n    });\n  });\n\n  describe('pending invite management', () => {\n    it('should get and clear pending invite', async () => {\n      await storage.set('pendingInvite', 'ABC123');\n      await storage.set('pendingInviterName', 'Alice');\n\n      const invite = await manager.getPendingInvite();\n      expect(invite).toEqual({ code: 'ABC123', inviterName: 'Alice' });\n\n      await manager.clearPendingInvite();\n      const clearedInvite = await manager.getPendingInvite();\n      expect(clearedInvite).toBeNull();\n    });\n\n    it('should return null when no pending invite', async () => {\n      const invite = await manager.getPendingInvite();\n      expect(invite).toBeNull();\n    });\n\n    it('should handle empty inviter name correctly with nullish coalescing', async () => {\n      await storage.set('pendingInvite', 'ABC123');\n      await storage.set('pendingInviterName', '');\n\n      const invite = await manager.getPendingInvite();\n      // Empty string should become undefined due to ?? operator\n      expect(invite).toEqual({ code: 'ABC123', inviterName: undefined });\n    });\n  });\n\n  describe('pending peer connection management', () => {\n    it('should get and clear pending peer connection', async () => {\n      await storage.set('pendingPeerConnection', 'peer123');\n\n      const peerId = await manager.getPendingPeerConnection();\n      expect(peerId).toBe('peer123');\n\n      await manager.clearPendingPeerConnection();\n      const clearedPeerId = await manager.getPendingPeerConnection();\n      expect(clearedPeerId).toBeNull();\n    });\n  });\n\n  describe('static URL generators', () => {\n    it('should generate invite URL', () => {\n      const url = DeepLinkManager.generateInviteURL(\n        'https://sc.app',\n        'ABC123',\n        'Alice'\n      );\n      expect(url).toBe('https://sc.app/join?code=ABC123&inviterName=Alice');\n    });\n\n    it('should generate invite URL without inviter name', () => {\n      const url = DeepLinkManager.generateInviteURL('https://sc.app', 'ABC123');\n      expect(url).toBe('https://sc.app/join?code=ABC123');\n    });\n\n    it('should generate custom scheme URL', () => {\n      const url = DeepLinkManager.generateCustomSchemeURL('ABC123');\n      expect(url).toBe('sc://join/ABC123');\n    });\n  });\n\n  describe('onboarding check', () => {\n    it('should return true when onboarding is complete', async () => {\n      await storage.set('onboarding_complete', 'true');\n      const isOnboarded = await manager.isUserOnboarded();\n      expect(isOnboarded).toBe(true);\n    });\n\n    it('should return false when onboarding is not complete', async () => {\n      const isOnboarded = await manager.isUserOnboarded();\n      expect(isOnboarded).toBe(false);\n    });\n\n    it('should return false when onboarding flag is false', async () => {\n      await storage.set('onboarding_complete', 'false');\n      const isOnboarded = await manager.isUserOnboarded();\n      expect(isOnboarded).toBe(false);\n    });\n  });\n});\n"],"version":3}