{"file":"/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/crypto/index.test.ts","mappings":"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","names":[],"sources":["/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/crypto/index.test.ts"],"sourcesContent":["import { jest } from \"@jest/globals\";\nimport {\n  CryptoManager,\n  KeyManager,\n  generateKey,\n  generateNonce,\n  generateEphemeralKeyPair,\n  generateIdentity,\n} from \"./index\";\nimport { ed25519, x25519 } from \"@noble/curves/ed25519.js\";\nimport { timingSafeEqual } from \"./primitives\";\n\ndescribe(\"CryptoManager\", () => {\n  let cryptoManager: CryptoManager;\n\n  beforeEach(() => {\n    cryptoManager = new CryptoManager();\n  });\n\n  describe(\"generateKey\", () => {\n    it(\"should generate a 32-byte key\", () => {\n      const key = cryptoManager.generateKey();\n      expect(key).toHaveLength(32);\n      expect(key).toBeInstanceOf(Uint8Array);\n    });\n\n    it(\"should generate unique keys each time\", () => {\n      const key1 = cryptoManager.generateKey();\n      const key2 = cryptoManager.generateKey();\n      expect(timingSafeEqual(key1, key2)).toBe(false);\n    });\n  });\n\n  describe(\"encrypt/decrypt\", () => {\n    it(\"should encrypt and decrypt a string message\", () => {\n      const key = cryptoManager.generateKey();\n      const message = \"Hello, World!\";\n\n      const encrypted = cryptoManager.encrypt(message, key);\n      const decrypted = cryptoManager.decrypt(encrypted, key);\n\n      expect(decrypted).toBe(message);\n    });\n\n    it(\"should encrypt and decrypt a Uint8Array message\", () => {\n      const key = cryptoManager.generateKey();\n      const message = new TextEncoder().encode(\"Binary data test\");\n\n      const encrypted = cryptoManager.encrypt(message, key);\n      const decrypted = cryptoManager.decrypt(encrypted, key);\n\n      expect(decrypted).toBe(\"Binary data test\");\n    });\n\n    it(\"should produce different ciphertext each time (due to random nonce)\", () => {\n      const key = cryptoManager.generateKey();\n      const message = \"Same message\";\n\n      const encrypted1 = cryptoManager.encrypt(message, key);\n      const encrypted2 = cryptoManager.encrypt(message, key);\n\n      // Ciphertexts should be different due to different nonces\n      expect(timingSafeEqual(encrypted1, encrypted2)).toBe(false);\n    });\n\n    it(\"should throw error when decrypting data that is too short\", () => {\n      const key = cryptoManager.generateKey();\n      const tooShort = new Uint8Array(20);\n\n      expect(() => cryptoManager.decrypt(tooShort, key)).toThrow(\n        \"Encrypted data too short\",\n      );\n    });\n  });\n\n  describe(\"decryptBytes\", () => {\n    it(\"should decrypt to Uint8Array\", () => {\n      const key = cryptoManager.generateKey();\n      const originalData = new Uint8Array([1, 2, 3, 4, 5]);\n\n      const encrypted = cryptoManager.encrypt(originalData, key);\n      const decrypted = cryptoManager.decryptBytes(encrypted, key);\n\n      expect(decrypted).toEqual(originalData);\n      expect(decrypted).toBeInstanceOf(Uint8Array);\n    });\n\n    it(\"should throw error when decrypting data that is too short\", () => {\n      const key = cryptoManager.generateKey();\n      const tooShort = new Uint8Array(20);\n\n      expect(() => cryptoManager.decryptBytes(tooShort, key)).toThrow(\n        \"Encrypted data too short\",\n      );\n    });\n  });\n\n  describe(\"sign/verify\", () => {\n    it(\"should sign and verify a string message\", () => {\n      const keyManager = new KeyManager();\n      keyManager.generateIdentityKeyPair();\n\n      const message = \"Message to sign\";\n      const signature = cryptoManager.sign(message, keyManager.getPrivateKey());\n      const isValid = cryptoManager.verify(\n        message,\n        signature,\n        keyManager.getPublicKey(),\n      );\n\n      expect(signature).toHaveLength(64);\n      expect(isValid).toBe(true);\n    });\n\n    it(\"should sign and verify a Uint8Array message\", () => {\n      const keyManager = new KeyManager();\n      keyManager.generateIdentityKeyPair();\n\n      const message = new Uint8Array([1, 2, 3, 4, 5]);\n      const signature = cryptoManager.sign(message, keyManager.getPrivateKey());\n      const isValid = cryptoManager.verify(\n        message,\n        signature,\n        keyManager.getPublicKey(),\n      );\n\n      expect(isValid).toBe(true);\n    });\n\n    it(\"should reject invalid signature\", () => {\n      const keyManager = new KeyManager();\n      keyManager.generateIdentityKeyPair();\n\n      const message = \"Original message\";\n      const signature = cryptoManager.sign(message, keyManager.getPrivateKey());\n      const isValid = cryptoManager.verify(\n        \"Tampered message\",\n        signature,\n        keyManager.getPublicKey(),\n      );\n\n      expect(isValid).toBe(false);\n    });\n  });\n\n  describe(\"deriveSecret\", () => {\n    it(\"should derive shared secret between two parties\", () => {\n      // Use identity keys for high-level secret derivation\n      const keypair1 = generateIdentity();\n      const keypair2 = generateIdentity();\n\n      const secret1 = cryptoManager.deriveSecret(\n        keypair1.privateKey,\n        keypair2.publicKey,\n      );\n      const secret2 = cryptoManager.deriveSecret(\n        keypair2.privateKey,\n        keypair1.publicKey,\n      );\n\n      expect(secret1).toHaveLength(32);\n      if (!timingSafeEqual(secret1, secret2)) {\n        // eslint-disable-next-line no-console\n        console.error(\"[TEST-DEBUG] CryptoManager deriveSecret mismatch:\");\n        // eslint-disable-next-line no-console\n        console.error(\"secret1=\", Buffer.from(secret1).toString(\"hex\"));\n        // eslint-disable-next-line no-console\n        console.error(\"secret2=\", Buffer.from(secret2).toString(\"hex\"));\n      }\n\n      expect(timingSafeEqual(secret1, secret2)).toBe(true);\n    });\n\n    it(\"should maintain key path consistency\", () => {\n      const priv = ed25519.utils.randomSecretKey();\n      const pub = ed25519.getPublicKey(priv);\n\n      const mont = ed25519.utils.toMontgomery(pub);\n      const xPriv = ed25519.utils.toMontgomerySecret(priv);\n      const xPubFromPriv = x25519.getPublicKey(xPriv);\n\n      if (\n        Buffer.from(mont).toString(\"hex\") !==\n        Buffer.from(xPubFromPriv).toString(\"hex\")\n      ) {\n        console.error(\"[CONSISTENCY-TEST] Mismatch!\");\n        console.error(\"mont        :\", Buffer.from(mont).toString(\"hex\"));\n        console.error(\n          \"xPubFromPriv:\",\n          Buffer.from(xPubFromPriv).toString(\"hex\"),\n        );\n        throw new Error(\"Key path inconsistency in Jest environment\");\n      }\n    });\n\n    it(\"should perform correct ECDH\", () => {\n      const privA = ed25519.utils.randomSecretKey();\n      const pubA = ed25519.getPublicKey(privA);\n      const privB = ed25519.utils.randomSecretKey();\n      const pubB = ed25519.getPublicKey(privB);\n\n      const uA = ed25519.utils.toMontgomery(pubA);\n      const uB = ed25519.utils.toMontgomery(pubB);\n\n      const xPrivA = ed25519.utils.toMontgomerySecret(privA);\n      const xPrivB = ed25519.utils.toMontgomerySecret(privB);\n\n      const s1 = x25519.getSharedSecret(xPrivA, uB);\n      const s2 = x25519.getSharedSecret(xPrivB, uA);\n\n      if (Buffer.from(s1).toString(\"hex\") !== Buffer.from(s2).toString(\"hex\")) {\n        console.error(\"[ECDH-TEST] Mismatch!\");\n        console.error(\"s1:\", Buffer.from(s1).toString(\"hex\"));\n        console.error(\"s2:\", Buffer.from(s2).toString(\"hex\"));\n        throw new Error(\"ECDH mismatch in Jest environment\");\n      }\n    });\n  });\n});\n\ndescribe(\"KeyManager\", () => {\n  let keyManager: KeyManager;\n\n  beforeEach(() => {\n    keyManager = new KeyManager();\n  });\n\n  describe(\"generateIdentityKeyPair\", () => {\n    it(\"should generate a keypair\", () => {\n      expect(keyManager.hasKeypair()).toBe(false);\n\n      keyManager.generateIdentityKeyPair();\n\n      expect(keyManager.hasKeypair()).toBe(true);\n    });\n  });\n\n  describe(\"getPublicKey\", () => {\n    it(\"should throw if keypair not generated\", () => {\n      expect(() => keyManager.getPublicKey()).toThrow(\"Keypair not generated\");\n    });\n\n    it(\"should return 32-byte public key\", () => {\n      keyManager.generateIdentityKeyPair();\n      const publicKey = keyManager.getPublicKey();\n\n      expect(publicKey).toHaveLength(32);\n      expect(publicKey).toBeInstanceOf(Uint8Array);\n    });\n\n    it(\"should return a copy of the public key\", () => {\n      keyManager.generateIdentityKeyPair();\n      const publicKey1 = keyManager.getPublicKey();\n      const publicKey2 = keyManager.getPublicKey();\n\n      // Should be equal in value\n      expect(timingSafeEqual(publicKey1, publicKey2)).toBe(true);\n\n      // But should be different objects (copies)\n      expect(publicKey1).not.toBe(publicKey2);\n\n      // Modifying one should not affect the other\n      publicKey1[0] = publicKey1[0] ^ 0xff;\n      expect(timingSafeEqual(publicKey1, publicKey2)).toBe(false);\n    });\n  });\n\n  describe(\"getPrivateKey\", () => {\n    it(\"should throw if keypair not generated\", () => {\n      expect(() => keyManager.getPrivateKey()).toThrow(\"Keypair not generated\");\n    });\n\n    it(\"should return 32-byte private key\", () => {\n      keyManager.generateIdentityKeyPair();\n      const privateKey = keyManager.getPrivateKey();\n\n      expect(privateKey).toHaveLength(32);\n      expect(privateKey).toBeInstanceOf(Uint8Array);\n    });\n\n    it(\"should return a copy of the private key\", () => {\n      keyManager.generateIdentityKeyPair();\n      const privateKey1 = keyManager.getPrivateKey();\n      const privateKey2 = keyManager.getPrivateKey();\n\n      // Should be equal in value\n      expect(timingSafeEqual(privateKey1, privateKey2)).toBe(true);\n\n      // But should be different objects (copies)\n      expect(privateKey1).not.toBe(privateKey2);\n\n      // Modifying one should not affect the other\n      privateKey1[0] = privateKey1[0] ^ 0xff;\n      expect(timingSafeEqual(privateKey1, privateKey2)).toBe(false);\n    });\n  });\n\n  describe(\"hasKeypair\", () => {\n    it(\"should return false before generation\", () => {\n      expect(keyManager.hasKeypair()).toBe(false);\n    });\n\n    it(\"should return true after generation\", () => {\n      keyManager.generateIdentityKeyPair();\n      expect(keyManager.hasKeypair()).toBe(true);\n    });\n\n    it(\"should return false after clear\", () => {\n      keyManager.generateIdentityKeyPair();\n      keyManager.clear();\n      expect(keyManager.hasKeypair()).toBe(false);\n    });\n  });\n\n  describe(\"clear\", () => {\n    it(\"should clear the keypair\", () => {\n      keyManager.generateIdentityKeyPair();\n      expect(keyManager.hasKeypair()).toBe(true);\n\n      keyManager.clear();\n\n      expect(keyManager.hasKeypair()).toBe(false);\n      expect(() => keyManager.getPublicKey()).toThrow();\n      expect(() => keyManager.getPrivateKey()).toThrow();\n    });\n\n    it(\"should be safe to call multiple times\", () => {\n      keyManager.generateIdentityKeyPair();\n      keyManager.clear();\n      keyManager.clear(); // Should not throw\n\n      expect(keyManager.hasKeypair()).toBe(false);\n    });\n\n    it(\"should be safe to call without generating keypair\", () => {\n      keyManager.clear(); // Should not throw\n      expect(keyManager.hasKeypair()).toBe(false);\n    });\n  });\n});\n"],"version":3}