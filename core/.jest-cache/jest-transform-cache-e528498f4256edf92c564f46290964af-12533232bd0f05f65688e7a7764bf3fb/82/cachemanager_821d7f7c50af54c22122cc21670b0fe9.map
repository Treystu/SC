{"file":"/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/cache-manager.ts","mappings":"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","names":[],"sources":["/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/cache-manager.ts"],"sourcesContent":["// Cache management for improved performance\nexport interface CacheEntry<T> {\n  key: string;\n  value: T;\n  timestamp: number;\n  ttl: number; // Time to live in milliseconds\n  size: number; // Size in bytes\n}\n\nexport interface CacheStats {\n  hits: number;\n  misses: number;\n  evictions: number;\n  size: number;\n  count: number;\n}\n\nexport class CacheManager<T = any> {\n  private cache: Map<string, CacheEntry<T>> = new Map();\n  private stats: CacheStats = {\n    hits: 0,\n    misses: 0,\n    evictions: 0,\n    size: 0,\n    count: 0\n  };\n\n  constructor(\n    private maxSize: number = 50 * 1024 * 1024, // 50MB default\n    private defaultTtl: number = 3600000 // 1 hour default\n  ) {\n    // Periodic cleanup\n    setInterval(() => this.cleanup(), 60000); // Every minute\n  }\n\n  // Get item from cache\n  get(key: string): T | null {\n    const entry = this.cache.get(key);\n\n    if (!entry) {\n      this.stats.misses++;\n      return null;\n    }\n\n    // Check if expired\n    if (Date.now() - entry.timestamp > entry.ttl) {\n      this.delete(key);\n      this.stats.misses++;\n      return null;\n    }\n\n    this.stats.hits++;\n    return entry.value;\n  }\n\n  // Set item in cache\n  set(key: string, value: T, ttl: number = this.defaultTtl): void {\n    const size = this.estimateSize(value);\n\n    // Check if we need to evict\n    while (this.stats.size + size > this.maxSize && this.cache.size > 0) {\n      this.evictOldest();\n    }\n\n    const entry: CacheEntry<T> = {\n      key,\n      value,\n      timestamp: Date.now(),\n      ttl,\n      size\n    };\n\n    // Remove old entry if exists\n    const existing = this.cache.get(key);\n    if (existing) {\n      this.stats.size -= existing.size;\n      this.stats.count--;\n    }\n\n    this.cache.set(key, entry);\n    this.stats.size += size;\n    this.stats.count++;\n  }\n\n  // Check if key exists\n  has(key: string): boolean {\n    return this.get(key) !== null;\n  }\n\n  // Delete item\n  delete(key: string): boolean {\n    const entry = this.cache.get(key);\n    if (!entry) return false;\n\n    this.cache.delete(key);\n    this.stats.size -= entry.size;\n    this.stats.count--;\n    return true;\n  }\n\n  // Clear all cache\n  clear(): void {\n    this.cache.clear();\n    this.stats.size = 0;\n    this.stats.count = 0;\n  }\n\n  // Get or fetch (with callback)\n  async getOrFetch(key: string, fetcher: () => Promise<T>, ttl?: number): Promise<T> {\n    const cached = this.get(key);\n    if (cached !== null) {\n      return cached;\n    }\n\n    const value = await fetcher();\n    this.set(key, value, ttl);\n    return value;\n  }\n\n  // Evict oldest entry\n  private evictOldest(): void {\n    let oldest: CacheEntry<T> | null = null;\n    let oldestKey: string | null = null;\n\n    for (const [key, entry] of this.cache.entries()) {\n      if (!oldest || entry.timestamp < oldest.timestamp) {\n        oldest = entry;\n        oldestKey = key;\n      }\n    }\n\n    if (oldestKey) {\n      this.delete(oldestKey);\n      this.stats.evictions++;\n    }\n  }\n\n  // Clean up expired entries\n  private cleanup(): void {\n    const now = Date.now();\n    const toDelete: string[] = [];\n\n    for (const [key, entry] of this.cache.entries()) {\n      if (now - entry.timestamp > entry.ttl) {\n        toDelete.push(key);\n      }\n    }\n\n    for (const key of toDelete) {\n      this.delete(key);\n    }\n  }\n\n  // Estimate size of value in bytes\n  private estimateSize(value: T): number {\n    try {\n      return new Blob([JSON.stringify(value)]).size;\n    } catch {\n      return 1000; // Default estimate\n    }\n  }\n\n  // Get cache statistics\n  getStats(): CacheStats {\n    return { ...this.stats };\n  }\n\n  // Get cache hit rate\n  getHitRate(): number {\n    const total = this.stats.hits + this.stats.misses;\n    return total === 0 ? 0 : this.stats.hits / total;\n  }\n\n  // Prewarm cache with data\n  async prewarm(entries: Array<{ key: string; fetcher: () => Promise<T>; ttl?: number }>): Promise<void> {\n    await Promise.all(\n      entries.map(({ key, fetcher, ttl }) => \n        this.getOrFetch(key, fetcher, ttl)\n      )\n    );\n  }\n}\n\n// Specialized cache for images/media\nexport class MediaCache extends CacheManager<Blob> {\n  constructor(maxSize: number = 100 * 1024 * 1024) { // 100MB for media\n    super(maxSize, 86400000); // 24 hour TTL\n  }\n\n  // Create object URL from cached blob\n  getObjectURL(key: string): string | null {\n    const blob = this.get(key);\n    return blob ? URL.createObjectURL(blob) : null;\n  }\n\n  // Cache image from URL\n  async cacheFromURL(key: string, url: string): Promise<Blob> {\n    return this.getOrFetch(key, async () => {\n      const response = await fetch(url);\n      if (!response.ok) throw new Error('Failed to fetch image');\n      return await response.blob();\n    });\n  }\n}\n"],"version":3}