{"file":"/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/discovery/qr-enhanced.test.ts","mappings":"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","names":[],"sources":["/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/discovery/qr-enhanced.test.ts"],"sourcesContent":["/**\n * Tests for Enhanced QR Code Discovery\n */\n\nimport { describe, it, expect } from '@jest/globals';\nimport {\n  QRCodeDiscoveryV2,\n  QRCodeDiscovery,\n  QR_FORMAT_VERSION,\n  type QRPeerInfo,\n} from './qr-enhanced';\n\n// Utility function for hex conversion\nconst hexToBytes = (hex: string): Uint8Array => {\n  const bytes = new Uint8Array(hex.length / 2);\n  for (let i = 0; i < hex.length; i += 2) {\n    bytes[i / 2] = parseInt(hex.slice(i, i + 2), 16);\n  }\n  return bytes;\n};\n\ndescribe('Enhanced QR Code Discovery', () => {\n  const testPeerInfo: QRPeerInfo = {\n    publicKey: hexToBytes('a'.repeat(64)), // 32 bytes\n    peerId: 'test-peer-123',\n    displayName: 'Test Peer',\n    endpoints: [\n      { type: 'webrtc', signaling: 'relay-1' },\n      { type: 'local', address: '192.168.1.100:8080' },\n    ],\n    timestamp: Date.now(),\n  };\n\n  describe('QRCodeDiscoveryV2', () => {\n    describe('generateQRData', () => {\n      it('should generate valid QR code data', () => {\n        const qrData = QRCodeDiscoveryV2.generateQRData(testPeerInfo);\n        \n        expect(qrData).toBeTruthy();\n        expect(typeof qrData).toBe('string');\n        expect(qrData.length).toBeGreaterThan(0);\n      });\n\n      it('should include version in QR data', () => {\n        const qrData = QRCodeDiscoveryV2.generateQRData(testPeerInfo);\n        const result = QRCodeDiscoveryV2.parseQRData(qrData);\n        \n        expect(result.valid).toBe(true);\n        expect(result.info).toBeDefined();\n      });\n\n      it('should include checksum for validation', () => {\n        const qrData = QRCodeDiscoveryV2.generateQRData(testPeerInfo);\n        const result = QRCodeDiscoveryV2.parseQRData(qrData);\n        \n        expect(result.valid).toBe(true);\n        // If checksum was invalid, parsing would fail\n      });\n\n      it('should include capabilities if provided', () => {\n        const capabilities = {\n          webrtc: true,\n          ble: false,\n          fileTransfer: true,\n        };\n\n        const qrData = QRCodeDiscoveryV2.generateQRData(testPeerInfo, capabilities);\n        expect(qrData).toBeTruthy();\n      });\n\n      it('should generate compact QR data', () => {\n        const peerWithManyEndpoints: QRPeerInfo = {\n          ...testPeerInfo,\n          endpoints: [\n            { type: 'webrtc', signaling: 'relay-1' },\n            { type: 'local', address: '192.168.1.100:8080' },\n            { type: 'local', address: '192.168.1.101:8080' },\n            { type: 'manual', address: '10.0.0.1:9000' },\n          ],\n        };\n\n        const compactData = QRCodeDiscoveryV2.generateCompactQRData(peerWithManyEndpoints);\n        const normalData = QRCodeDiscoveryV2.generateQRData(peerWithManyEndpoints);\n        \n        expect(compactData.length).toBeLessThan(normalData.length);\n      });\n    });\n\n    describe('parseQRData', () => {\n      it('should parse valid QR code data', () => {\n        const qrData = QRCodeDiscoveryV2.generateQRData(testPeerInfo);\n        const result = QRCodeDiscoveryV2.parseQRData(qrData);\n        \n        expect(result.valid).toBe(true);\n        expect(result.info).toBeDefined();\n        expect(result.info?.peerId).toBe(testPeerInfo.peerId);\n      });\n\n      it('should validate version negotiation', () => {\n        const qrData = QRCodeDiscoveryV2.generateQRData(testPeerInfo);\n        const result = QRCodeDiscoveryV2.parseQRData(qrData);\n        \n        expect(result.valid).toBe(true);\n      });\n\n      it('should reject unsupported versions', () => {\n        // Manually craft a QR code with unsupported version\n        const invalidData = {\n          version: 999,\n          publicKey: 'a'.repeat(64),\n          peerId: 'test',\n          endpoints: [],\n          timestamp: Date.now(),\n          checksum: '0'.repeat(64),\n        };\n\n        const encoded = typeof btoa !== 'undefined' \n          ? btoa('SC2:' + JSON.stringify(invalidData))\n          : Buffer.from('SC2:' + JSON.stringify(invalidData)).toString('base64');\n\n        const result = QRCodeDiscoveryV2.parseQRData(encoded);\n        \n        expect(result.valid).toBe(false);\n        expect(result.error).toContain('Unsupported version');\n      });\n\n      it('should detect corrupted data via checksum', () => {\n        const qrData = QRCodeDiscoveryV2.generateQRData(testPeerInfo);\n        \n        // Corrupt the data\n        const corrupted = qrData.substring(0, qrData.length - 10) + 'CORRUPTED';\n        \n        const result = QRCodeDiscoveryV2.parseQRData(corrupted);\n        \n        // Should fail either at decode or checksum stage\n        expect(result.valid).toBe(false);\n      });\n\n      it('should validate public key format', () => {\n        // Create data with valid checksum but invalid public key format\n        const invalidData = {\n          version: QR_FORMAT_VERSION,\n          publicKey: 'not-valid-hex',\n          peerId: 'test',\n          endpoints: [],\n          timestamp: Date.now(),\n        };\n\n        // Calculate checksum for this invalid data\n        const dataString = JSON.stringify(invalidData);\n        const checksum = typeof require !== 'undefined' \n          ? require('@noble/hashes/sha2.js').sha256(new TextEncoder().encode(dataString))\n          : new Uint8Array(32);\n        \n        const checksumHex = Array.from(checksum).map((b: any) => b.toString(16).padStart(2, '0')).join('');\n        const fullData = { ...invalidData, checksum: checksumHex };\n\n        const encoded = typeof btoa !== 'undefined'\n          ? btoa('SC2:' + JSON.stringify(fullData))\n          : Buffer.from('SC2:' + JSON.stringify(fullData)).toString('base64');\n\n        const result = QRCodeDiscoveryV2.parseQRData(encoded);\n        \n        expect(result.valid).toBe(false);\n        // Could be checksum or validation error, just verify it fails\n        expect(result.error).toBeTruthy();\n      });\n\n      it('should validate public key length', () => {\n        // Create data with valid checksum but invalid public key length\n        const invalidData = {\n          version: QR_FORMAT_VERSION,\n          publicKey: 'a'.repeat(32), // Too short (16 bytes instead of 32)\n          peerId: 'test',\n          endpoints: [],\n          timestamp: Date.now(),\n        };\n\n        // Calculate checksum for this invalid data\n        const dataString = JSON.stringify(invalidData);\n        const checksum = typeof require !== 'undefined'\n          ? require('@noble/hashes/sha2.js').sha256(new TextEncoder().encode(dataString))\n          : new Uint8Array(32);\n        \n        const checksumHex = Array.from(checksum).map((b: any) => b.toString(16).padStart(2, '0')).join('');\n        const fullData = { ...invalidData, checksum: checksumHex };\n\n        const encoded = typeof btoa !== 'undefined'\n          ? btoa('SC2:' + JSON.stringify(fullData))\n          : Buffer.from('SC2:' + JSON.stringify(fullData)).toString('base64');\n\n        const result = QRCodeDiscoveryV2.parseQRData(encoded);\n        \n        expect(result.valid).toBe(false);\n        // Could be checksum or validation error, just verify it fails\n        expect(result.error).toBeTruthy();\n      });\n\n      it('should validate timestamp', () => {\n        const peerInfoFuture: QRPeerInfo = {\n          ...testPeerInfo,\n          timestamp: Date.now() + 7200000, // 2 hours in future\n        };\n\n        const qrData = QRCodeDiscoveryV2.generateQRData(peerInfoFuture);\n        const result = QRCodeDiscoveryV2.parseQRData(qrData);\n        \n        expect(result.valid).toBe(false);\n        expect(result.error).toContain('future');\n      });\n\n      it('should validate endpoint types', () => {\n        // Create data with valid checksum but invalid endpoint type\n        const invalidData = {\n          version: QR_FORMAT_VERSION,\n          publicKey: 'a'.repeat(64),\n          peerId: 'test',\n          endpoints: [\n            { type: 'invalid-type', address: '192.168.1.1:8080' },\n          ],\n          timestamp: Date.now(),\n        };\n\n        // Calculate checksum for this invalid data\n        const dataString = JSON.stringify(invalidData);\n        const checksum = typeof require !== 'undefined'\n          ? require('@noble/hashes/sha2.js').sha256(new TextEncoder().encode(dataString))\n          : new Uint8Array(32);\n        \n        const checksumHex = Array.from(checksum).map((b: any) => b.toString(16).padStart(2, '0')).join('');\n        const fullData = { ...invalidData, checksum: checksumHex };\n\n        const encoded = typeof btoa !== 'undefined'\n          ? btoa('SC2:' + JSON.stringify(fullData))\n          : Buffer.from('SC2:' + JSON.stringify(fullData)).toString('base64');\n\n        const result = QRCodeDiscoveryV2.parseQRData(encoded);\n        \n        expect(result.valid).toBe(false);\n        // Could be checksum or validation error, just verify it fails\n        expect(result.error).toBeTruthy();\n      });\n\n      it('should parse all peer info correctly', () => {\n        const qrData = QRCodeDiscoveryV2.generateQRData(testPeerInfo);\n        const result = QRCodeDiscoveryV2.parseQRData(qrData);\n        \n        expect(result.valid).toBe(true);\n        expect(result.info?.peerId).toBe(testPeerInfo.peerId);\n        expect(result.info?.displayName).toBe(testPeerInfo.displayName);\n        expect(result.info?.endpoints).toHaveLength(testPeerInfo.endpoints.length);\n        expect(result.info?.publicKey).toEqual(testPeerInfo.publicKey);\n      });\n    });\n\n    describe('validateQRSize', () => {\n      it('should validate QR code size', () => {\n        const qrData = QRCodeDiscoveryV2.generateQRData(testPeerInfo);\n        const validation = QRCodeDiscoveryV2.validateQRSize(qrData);\n        \n        expect(validation.valid).toBe(true);\n        expect(validation.size).toBeGreaterThan(0);\n      });\n\n      it('should warn about large QR codes', () => {\n        const largeInfo: QRPeerInfo = {\n          ...testPeerInfo,\n          displayName: 'A'.repeat(500),\n          endpoints: Array(20).fill(null).map((_, i) => ({\n            type: 'local' as const,\n            address: `192.168.1.${i}:8080`,\n          })),\n        };\n\n        const qrData = QRCodeDiscoveryV2.generateQRData(largeInfo);\n        const validation = QRCodeDiscoveryV2.validateQRSize(qrData);\n        \n        expect(validation.size).toBeGreaterThan(1000);\n        if (validation.size > 1000) {\n          expect(validation.recommendation).toBeDefined();\n        }\n      });\n\n      it('should reject extremely large QR codes', () => {\n        const hugeInfo: QRPeerInfo = {\n          ...testPeerInfo,\n          displayName: 'A'.repeat(2000),\n          endpoints: Array(100).fill(null).map((_, i) => ({\n            type: 'local' as const,\n            address: `192.168.1.${i}:8080`,\n          })),\n        };\n\n        const qrData = QRCodeDiscoveryV2.generateQRData(hugeInfo);\n        const validation = QRCodeDiscoveryV2.validateQRSize(qrData);\n        \n        expect(validation.valid).toBe(false);\n      });\n    });\n\n    describe('quickValidate', () => {\n      it('should quickly validate correct QR data', () => {\n        const qrData = QRCodeDiscoveryV2.generateQRData(testPeerInfo);\n        const isValid = QRCodeDiscoveryV2.quickValidate(qrData);\n        \n        expect(isValid).toBe(true);\n      });\n\n      it('should quickly reject invalid QR data', () => {\n        const invalidData = 'not-a-valid-qr-code';\n        const isValid = QRCodeDiscoveryV2.quickValidate(invalidData);\n        \n        expect(isValid).toBe(false);\n      });\n\n      it('should be faster than full parsing', () => {\n        const qrData = QRCodeDiscoveryV2.generateQRData(testPeerInfo);\n        \n        const quickStart = Date.now();\n        QRCodeDiscoveryV2.quickValidate(qrData);\n        const quickTime = Date.now() - quickStart;\n        \n        const fullStart = Date.now();\n        QRCodeDiscoveryV2.parseQRData(qrData);\n        const fullTime = Date.now() - fullStart;\n        \n        // Quick validate should be at least as fast\n        expect(quickTime).toBeLessThanOrEqual(fullTime + 5); // 5ms tolerance\n      });\n    });\n  });\n\n  describe('QRCodeDiscovery (v1 compatibility)', () => {\n    it('should generate QR data using v2 internally', () => {\n      const qrData = QRCodeDiscovery.generateQRData(testPeerInfo);\n      \n      expect(qrData).toBeTruthy();\n      expect(typeof qrData).toBe('string');\n    });\n\n    it('should parse QR data and return PeerInfo', () => {\n      const qrData = QRCodeDiscovery.generateQRData(testPeerInfo);\n      const parsed = QRCodeDiscovery.parseQRData(qrData);\n      \n      expect(parsed).not.toBeNull();\n      expect(parsed?.peerId).toBe(testPeerInfo.peerId);\n    });\n\n    it('should return null for invalid QR data', () => {\n      const parsed = QRCodeDiscovery.parseQRData('invalid-qr-code');\n      \n      expect(parsed).toBeNull();\n    });\n  });\n\n  describe('Performance', () => {\n    it('should generate QR code within 2 seconds', () => {\n      const startTime = Date.now();\n      const qrData = QRCodeDiscoveryV2.generateQRData(testPeerInfo);\n      const generationTime = Date.now() - startTime;\n      \n      expect(generationTime).toBeLessThan(2000);\n      expect(qrData).toBeTruthy();\n    });\n\n    it('should parse QR code within 2 seconds', () => {\n      const qrData = QRCodeDiscoveryV2.generateQRData(testPeerInfo);\n      \n      const startTime = Date.now();\n      const result = QRCodeDiscoveryV2.parseQRData(qrData);\n      const parseTime = Date.now() - startTime;\n      \n      expect(parseTime).toBeLessThan(2000);\n      expect(result.valid).toBe(true);\n    });\n  });\n\n  describe('Error Correction', () => {\n    it('should include redundancy in encoded data', () => {\n      const qrData = QRCodeDiscoveryV2.generateQRData(testPeerInfo);\n      \n      // Encoded data should contain SC2: marker for v2 format\n      const decoded = typeof atob !== 'undefined'\n        ? atob(qrData)\n        : Buffer.from(qrData, 'base64').toString('utf-8');\n      \n      expect(decoded).toContain('SC2:');\n    });\n\n    it('should verify data integrity with checksum', () => {\n      const qrData = QRCodeDiscoveryV2.generateQRData(testPeerInfo);\n      const result = QRCodeDiscoveryV2.parseQRData(qrData);\n      \n      // Successful parse means checksum verified\n      expect(result.valid).toBe(true);\n    });\n  });\n});\n"],"version":3}