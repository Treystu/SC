{"file":"/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/connection-manager.test.ts","mappings":"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","names":[],"sources":["/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/connection-manager.test.ts"],"sourcesContent":["import { ConnectionManager } from './connection-manager';\n\ndescribe('ConnectionManager', () => {\n  let manager: ConnectionManager;\n\n  beforeEach(() => {\n    manager = new ConnectionManager();\n  });\n\n  afterEach(() => {\n    manager.cleanup();\n  });\n\n  describe('Basic Connection Management', () => {\n    it('should add a connection', () => {\n      manager.addConnection('peer1', 'webrtc');\n      \n      const connection = manager.getConnection('peer1');\n      expect(connection).toBeDefined();\n      expect(connection?.type).toBe('webrtc');\n      expect(connection?.status).toBe('connecting');\n    });\n\n    it('should get all connections', () => {\n      manager.addConnection('peer1', 'webrtc');\n      manager.addConnection('peer2', 'ble');\n      \n      const connections = manager.getAllConnections();\n      expect(connections.length).toBe(2);\n    });\n\n    it('should remove a connection', () => {\n      manager.addConnection('peer1', 'webrtc');\n      manager.removeConnection('peer1');\n      \n      const connection = manager.getConnection('peer1');\n      expect(connection).toBeUndefined();\n    });\n  });\n\n  describe('Connection Status', () => {\n    it('should update connection status', () => {\n      manager.addConnection('peer1', 'webrtc');\n      manager.updateConnectionStatus('peer1', 'connected');\n      \n      const connection = manager.getConnection('peer1');\n      expect(connection?.status).toBe('connected');\n    });\n\n    it('should get connected peers', () => {\n      manager.addConnection('peer1', 'webrtc');\n      manager.addConnection('peer2', 'ble');\n      manager.updateConnectionStatus('peer1', 'connected');\n      \n      const connected = manager.getConnectedPeers();\n      expect(connected.length).toBe(1);\n      expect(connected[0].id).toBe('peer1');\n    });\n  });\n\n  describe('Connection Metrics', () => {\n    it('should update connection metrics', () => {\n      manager.addConnection('peer1', 'webrtc');\n      manager.updateConnectionMetrics('peer1', {\n        quality: 0.9,\n        latency: 50,\n        bandwidth: { upload: 1000, download: 2000 }\n      });\n      \n      const connection = manager.getConnection('peer1');\n      expect(connection?.quality).toBe(0.9);\n      expect(connection?.latency).toBe(50);\n      expect(connection?.bandwidth).toEqual({ upload: 1000, download: 2000 });\n    });\n\n    it('should partially update metrics', () => {\n      manager.addConnection('peer1', 'webrtc');\n      manager.updateConnectionMetrics('peer1', { quality: 0.8 });\n      \n      const connection = manager.getConnection('peer1');\n      expect(connection?.quality).toBe(0.8);\n    });\n  });\n\n  describe('Best Connection Selection', () => {\n    it('should return null when no connections are available', () => {\n      const best = manager.getBestConnection();\n      expect(best).toBeNull();\n    });\n\n    it('should return null when no connections are connected', () => {\n      manager.addConnection('peer1', 'webrtc');\n      const best = manager.getBestConnection();\n      expect(best).toBeNull();\n    });\n\n    it('should return the best connected peer', () => {\n      manager.addConnection('peer1', 'webrtc');\n      manager.addConnection('peer2', 'ble');\n      \n      manager.updateConnectionStatus('peer1', 'connected');\n      manager.updateConnectionStatus('peer2', 'connected');\n      \n      manager.updateConnectionMetrics('peer1', { quality: 0.7 });\n      manager.updateConnectionMetrics('peer2', { quality: 0.9 });\n      \n      const best = manager.getBestConnection();\n      expect(best?.id).toBe('peer2');\n    });\n  });\n\n  describe('Statistics', () => {\n    it('should return statistics with no connections', () => {\n      const stats = manager.getStatistics();\n      \n      expect(stats.total).toBe(0);\n      expect(stats.connected).toBe(0);\n    });\n\n    it('should return accurate connection statistics', () => {\n      manager.addConnection('peer1', 'webrtc');\n      manager.addConnection('peer2', 'ble');\n      manager.updateConnectionStatus('peer1', 'connected');\n      \n      const stats = manager.getStatistics();\n      expect(stats.total).toBe(2);\n      expect(stats.connected).toBe(1);\n      expect(stats.connecting).toBe(1);\n    });\n\n    it('should calculate average quality and latency', () => {\n      manager.addConnection('peer1', 'webrtc');\n      manager.addConnection('peer2', 'ble');\n      \n      manager.updateConnectionStatus('peer1', 'connected');\n      manager.updateConnectionStatus('peer2', 'connected');\n      \n      manager.updateConnectionMetrics('peer1', { quality: 0.8, latency: 50 });\n      manager.updateConnectionMetrics('peer2', { quality: 1.0, latency: 30 });\n      \n      const stats = manager.getStatistics();\n      expect(stats.avgQuality).toBe(0.9);\n      expect(stats.avgLatency).toBe(40);\n    });\n  });\n\n  describe('Configuration', () => {\n    it('should use default configuration', () => {\n      const defaultManager = new ConnectionManager();\n      expect(defaultManager).toBeDefined();\n      defaultManager.cleanup();\n    });\n\n    it('should use custom configuration', () => {\n      const customManager = new ConnectionManager({\n        maxPeers: 100,\n        reconnectInterval: 10000,\n        connectionTimeout: 60000,\n        keepAliveInterval: 20000\n      });\n      expect(customManager).toBeDefined();\n      customManager.cleanup();\n    });\n  });\n\n  describe('Cleanup', () => {\n    it('should cleanup all connections', () => {\n      manager.addConnection('peer1', 'webrtc');\n      manager.addConnection('peer2', 'ble');\n      \n      manager.cleanup();\n      \n      const connections = manager.getAllConnections();\n      expect(connections.length).toBe(0);\n    });\n\n    it('should be safe to call cleanup multiple times', () => {\n      manager.addConnection('peer1', 'webrtc');\n      \n      expect(() => {\n        manager.cleanup();\n        manager.cleanup();\n      }).not.toThrow();\n    });\n  });\n});\n"],"version":3}