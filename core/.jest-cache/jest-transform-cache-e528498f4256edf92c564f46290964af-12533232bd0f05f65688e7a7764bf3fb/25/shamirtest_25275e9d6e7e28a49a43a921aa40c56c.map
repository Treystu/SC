{"file":"/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/crypto/shamir.test.ts","mappings":"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","names":[],"sources":["/Users/christymaxwell/Desktop/Luke_Stuff/GitHub/SC/core/src/crypto/shamir.test.ts"],"sourcesContent":["import { split, combine } from \"./shamir\";\n\ndescribe(\"Shamir Secret Sharing\", () => {\n  it(\"should split and combine a secret correctly\", () => {\n    const secret = new Uint8Array([10, 20, 30, 40, 50]);\n    const n = 5;\n    const k = 3;\n\n    const shares = split(secret, n, k);\n    expect(shares.length).toBe(n);\n\n    // Recover with all shares\n    const recovered = combine(shares);\n    expect(recovered).toEqual(secret);\n  });\n\n  it(\"should recover with exactly k shares\", () => {\n    const secret = new TextEncoder().encode(\"Hello World\");\n    const n = 5;\n    const k = 3;\n    const shares = split(secret, n, k);\n\n    // Select 3 random shares\n    const selectedShares = [shares[0], shares[2], shares[4]];\n    const recovered = combine(selectedShares);\n    expect(recovered).toEqual(secret);\n  });\n\n  it(\"should fail to recover with k-1 shares (produce garbage)\", () => {\n    const secret = new Uint8Array([1, 2, 3, 4, 5]);\n    const n = 5;\n    const k = 3;\n    const shares = split(secret, n, k);\n\n    // Select 2 shares (k-1)\n    const selectedShares = [shares[0], shares[1]];\n    const recovered = combine(selectedShares);\n\n    // Should NOT match secret\n    expect(recovered).not.toEqual(secret);\n  });\n\n  it(\"should handle k=1 (simple sharing)\", () => {\n    const secret = new Uint8Array([100]);\n    const shares = split(secret, 3, 1);\n\n    // Any single share should have the secret (y = c0 + 0) -> actually y = c0 is degree 0\n    // Wait, degree for k=1 is k-1 = 0. So P(x) = c0.\n    // So every share's y should be c0 (the secret).\n    expect(shares[0].y).toEqual(secret);\n    expect(shares[1].y).toEqual(secret);\n\n    const recovered = combine([shares[0]]);\n    expect(recovered).toEqual(secret);\n  });\n\n  it(\"should handle k=n\", () => {\n    const secret = new Uint8Array([255, 0, 128]);\n    const n = 4;\n    const shares = split(secret, n, n);\n\n    const recovered = combine(shares);\n    expect(recovered).toEqual(secret);\n  });\n});\n"],"version":3}