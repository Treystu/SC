bc5accabf0a617137f654b7b85ac6bb4
"use strict";
/**
 * Tests for Transport Abstraction Layer
 */
Object.defineProperty(exports, "__esModule", { value: true });
const Transport_js_1 = require("./Transport.js");
const MockTransport_js_1 = require("./__mocks__/MockTransport.js");
describe("Transport Abstraction", () => {
    afterEach(() => {
        (0, MockTransport_js_1.clearMockNetwork)();
    });
    describe("MockTransport", () => {
        it("should start and stop correctly", async () => {
            const transport = new MockTransport_js_1.MockTransport("peer-1");
            const events = {
                onMessage: jest.fn(),
            };
            expect(transport.isTransportRunning()).toBe(false);
            await transport.start(events);
            expect(transport.isTransportRunning()).toBe(true);
            expect((0, MockTransport_js_1.getMockNetworkPeers)()).toContain("peer-1");
            await transport.stop();
            expect(transport.isTransportRunning()).toBe(false);
            expect((0, MockTransport_js_1.getMockNetworkPeers)()).not.toContain("peer-1");
        });
        it("should connect two peers", async () => {
            const transport1 = new MockTransport_js_1.MockTransport("peer-1");
            const transport2 = new MockTransport_js_1.MockTransport("peer-2");
            const events1 = {
                onMessage: jest.fn(),
                onPeerConnected: jest.fn(),
            };
            const events2 = {
                onMessage: jest.fn(),
                onPeerConnected: jest.fn(),
            };
            await transport1.start(events1);
            await transport2.start(events2);
            await transport1.connect("peer-2");
            expect(transport1.getConnectedPeers()).toContain("peer-2");
            expect(transport2.getConnectedPeers()).toContain("peer-1");
            expect(events1.onPeerConnected).toHaveBeenCalledWith("peer-2", expect.any(Object));
            expect(events2.onPeerConnected).toHaveBeenCalledWith("peer-1", expect.any(Object));
        });
        it("should send messages between peers", async () => {
            const transport1 = new MockTransport_js_1.MockTransport("peer-1");
            const transport2 = new MockTransport_js_1.MockTransport("peer-2");
            const receivedMessages = [];
            const events1 = {
                onMessage: jest.fn(),
            };
            const events2 = {
                onMessage: (msg) => receivedMessages.push(msg),
            };
            await transport1.start(events1);
            await transport2.start(events2);
            await transport1.connect("peer-2");
            const testPayload = new TextEncoder().encode("Hello, peer-2!");
            await transport1.send("peer-2", testPayload);
            expect(receivedMessages.length).toBe(1);
            expect(receivedMessages[0].from).toBe("peer-1");
            expect(new TextDecoder().decode(receivedMessages[0].payload)).toBe("Hello, peer-2!");
        });
        it("should track sent and received messages", async () => {
            const transport1 = new MockTransport_js_1.MockTransport("peer-1");
            const transport2 = new MockTransport_js_1.MockTransport("peer-2");
            await transport1.start({ onMessage: jest.fn() });
            await transport2.start({ onMessage: jest.fn() });
            await transport1.connect("peer-2");
            await transport1.send("peer-2", new Uint8Array([1, 2, 3]));
            await transport1.send("peer-2", new Uint8Array([4, 5, 6]));
            expect(transport1.sentMessages.length).toBe(2);
            expect(transport2.receivedMessages.length).toBe(2);
        });
        it("should broadcast to all connected peers", async () => {
            const transport1 = new MockTransport_js_1.MockTransport("peer-1");
            const transport2 = new MockTransport_js_1.MockTransport("peer-2");
            const transport3 = new MockTransport_js_1.MockTransport("peer-3");
            const received2 = [];
            const received3 = [];
            await transport1.start({ onMessage: jest.fn() });
            await transport2.start({ onMessage: (m) => received2.push(m) });
            await transport3.start({ onMessage: (m) => received3.push(m) });
            await transport1.connect("peer-2");
            await transport1.connect("peer-3");
            await transport1.broadcast(new TextEncoder().encode("Broadcast!"));
            expect(received2.length).toBe(1);
            expect(received3.length).toBe(1);
        });
        it("should exclude specified peer from broadcast", async () => {
            const transport1 = new MockTransport_js_1.MockTransport("peer-1");
            const transport2 = new MockTransport_js_1.MockTransport("peer-2");
            const transport3 = new MockTransport_js_1.MockTransport("peer-3");
            const received2 = [];
            const received3 = [];
            await transport1.start({ onMessage: jest.fn() });
            await transport2.start({ onMessage: (m) => received2.push(m) });
            await transport3.start({ onMessage: (m) => received3.push(m) });
            await transport1.connect("peer-2");
            await transport1.connect("peer-3");
            await transport1.broadcast(new TextEncoder().encode("Broadcast!"), "peer-2");
            expect(received2.length).toBe(0);
            expect(received3.length).toBe(1);
        });
        it("should disconnect peers correctly", async () => {
            const transport1 = new MockTransport_js_1.MockTransport("peer-1");
            const transport2 = new MockTransport_js_1.MockTransport("peer-2");
            const disconnected = [];
            const events1 = {
                onMessage: jest.fn(),
                onPeerDisconnected: (id) => disconnected.push(id),
            };
            await transport1.start(events1);
            await transport2.start({ onMessage: jest.fn() });
            await transport1.connect("peer-2");
            expect(transport1.getConnectedPeers()).toContain("peer-2");
            await transport1.disconnect("peer-2");
            expect(transport1.getConnectedPeers()).not.toContain("peer-2");
            expect(disconnected).toContain("peer-2");
        });
        it("should handle connection failures", async () => {
            const transport = new MockTransport_js_1.MockTransport("peer-1", { failConnections: true });
            const errors = [];
            await transport.start({
                onMessage: jest.fn(),
                onError: (err) => errors.push(err),
            });
            await expect(transport.connect("peer-2")).rejects.toThrow("Connection to peer-2 failed");
            expect(errors.length).toBe(1);
        });
        it("should handle send failures", async () => {
            const transport1 = new MockTransport_js_1.MockTransport("peer-1");
            const transport2 = new MockTransport_js_1.MockTransport("peer-2");
            const errors = [];
            await transport1.start({
                onMessage: jest.fn(),
                onError: (err) => errors.push(err),
            });
            await transport2.start({ onMessage: jest.fn() });
            await transport1.connect("peer-2");
            transport1.updateConfig({ failSends: true });
            await expect(transport1.send("peer-2", new Uint8Array([1]))).rejects.toThrow();
            expect(errors.length).toBe(1);
        });
        it("should simulate latency", async () => {
            const transport1 = new MockTransport_js_1.MockTransport("peer-1", { latencyMs: 50 });
            const transport2 = new MockTransport_js_1.MockTransport("peer-2");
            let receivedAt = 0;
            await transport1.start({ onMessage: jest.fn() });
            await transport2.start({
                onMessage: () => {
                    receivedAt = Date.now();
                },
            });
            await transport1.connect("peer-2");
            const sentAt = Date.now();
            await transport1.send("peer-2", new Uint8Array([1]));
            // Should have some latency
            expect(receivedAt - sentAt).toBeGreaterThanOrEqual(40); // Allow some variance
        });
        it("should simulate packet loss", async () => {
            const transport1 = new MockTransport_js_1.MockTransport("peer-1", { packetLossRate: 1 }); // 100% loss
            const transport2 = new MockTransport_js_1.MockTransport("peer-2");
            const received = [];
            await transport1.start({ onMessage: jest.fn() });
            await transport2.start({ onMessage: (m) => received.push(m) });
            await transport1.connect("peer-2");
            await transport1.send("peer-2", new Uint8Array([1]));
            await transport1.send("peer-2", new Uint8Array([2]));
            await transport1.send("peer-2", new Uint8Array([3]));
            expect(received.length).toBe(0); // All messages lost
        });
        it("should get peer info correctly", async () => {
            const transport1 = new MockTransport_js_1.MockTransport("peer-1");
            const transport2 = new MockTransport_js_1.MockTransport("peer-2");
            await transport1.start({ onMessage: jest.fn() });
            await transport2.start({ onMessage: jest.fn() });
            await transport1.connect("peer-2");
            const peerInfo = transport1.getPeerInfo("peer-2");
            expect(peerInfo).toBeDefined();
            expect(peerInfo?.peerId).toBe("peer-2");
            expect(peerInfo?.state).toBe("connected");
            expect(peerInfo?.transportType).toBe("mock");
        });
        it("should track connection attempts", async () => {
            const transport = new MockTransport_js_1.MockTransport("peer-1");
            await transport.start({ onMessage: jest.fn() });
            await transport.connect("peer-2");
            await transport.connect("peer-3");
            expect(transport.connectionAttempts).toEqual(["peer-2", "peer-3"]);
        });
        it("should reset tracking data", async () => {
            const transport = new MockTransport_js_1.MockTransport("peer-1");
            await transport.start({ onMessage: jest.fn() });
            await transport.connect("peer-2");
            transport.sentMessages.push({});
            transport.receivedMessages.push({});
            transport.resetTracking();
            expect(transport.sentMessages.length).toBe(0);
            expect(transport.receivedMessages.length).toBe(0);
            expect(transport.connectionAttempts.length).toBe(0);
        });
    });
    describe("TransportRegistry", () => {
        it("should register and retrieve transport factories", () => {
            const registry = new Transport_js_1.DefaultTransportRegistry();
            const factory = jest.fn(() => new MockTransport_js_1.MockTransport("test"));
            registry.register("test-transport", factory);
            const retrieved = registry.get("test-transport");
            expect(retrieved).toBe(factory);
        });
        it("should return undefined for unregistered types", () => {
            const registry = new Transport_js_1.DefaultTransportRegistry();
            expect(registry.get("nonexistent")).toBeUndefined();
        });
        it("should list all registered types", () => {
            const registry = new Transport_js_1.DefaultTransportRegistry();
            registry.register("type1", jest.fn());
            registry.register("type2", jest.fn());
            registry.register("type3", jest.fn());
            const types = registry.getTypes();
            expect(types).toContain("type1");
            expect(types).toContain("type2");
            expect(types).toContain("type3");
        });
    });
    describe("clearMockNetwork", () => {
        it("should clear all registered mock transports", async () => {
            const transport1 = new MockTransport_js_1.MockTransport("peer-1");
            const transport2 = new MockTransport_js_1.MockTransport("peer-2");
            await transport1.start({ onMessage: jest.fn() });
            await transport2.start({ onMessage: jest.fn() });
            expect((0, MockTransport_js_1.getMockNetworkPeers)().length).toBe(2);
            (0, MockTransport_js_1.clearMockNetwork)();
            expect((0, MockTransport_js_1.getMockNetworkPeers)().length).toBe(0);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2NocmlzdHltYXh3ZWxsL0Rlc2t0b3AvTHVrZV9TdHVmZi9HaXRIdWIvU0MvY29yZS9zcmMvdHJhbnNwb3J0L1RyYW5zcG9ydC50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFFSCxpREFLd0I7QUFDeEIsbUVBQW9HO0FBRXBHLFFBQVEsQ0FBQyx1QkFBdUIsRUFBRSxHQUFHLEVBQUU7SUFDckMsU0FBUyxDQUFDLEdBQUcsRUFBRTtRQUNiLElBQUEsbUNBQWdCLEdBQUUsQ0FBQztJQUNyQixDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxlQUFlLEVBQUUsR0FBRyxFQUFFO1FBQzdCLEVBQUUsQ0FBQyxpQ0FBaUMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUMvQyxNQUFNLFNBQVMsR0FBRyxJQUFJLGdDQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDOUMsTUFBTSxNQUFNLEdBQW9CO2dCQUM5QixTQUFTLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTthQUNyQixDQUFDO1lBRUYsTUFBTSxDQUFDLFNBQVMsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRW5ELE1BQU0sU0FBUyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUM5QixNQUFNLENBQUMsU0FBUyxDQUFDLGtCQUFrQixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbEQsTUFBTSxDQUFDLElBQUEsc0NBQW1CLEdBQUUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUVsRCxNQUFNLFNBQVMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUN2QixNQUFNLENBQUMsU0FBUyxDQUFDLGtCQUFrQixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDbkQsTUFBTSxDQUFDLElBQUEsc0NBQW1CLEdBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFD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LENBQUM7WUFDL0MsTUFBTSxVQUFVLEdBQUcsSUFBSSxnQ0FBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRS9DLE1BQU0sVUFBVSxDQUFDLEtBQUssQ0FBQyxFQUFFLFNBQVMsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ2pELE1BQU0sVUFBVSxDQUFDLEtBQUssQ0FBQyxFQUFFLFNBQVMsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBRWpELE1BQU0sQ0FBQyxJQUFBLHNDQUFtQixHQUFFLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBRTdDLElBQUEsbUNBQWdCLEdBQUUsQ0FBQztZQUVuQixNQUFNLENBQUMsSUFBQSxzQ0FBbUIsR0FBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMvQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2NocmlzdHltYXh3ZWxsL0Rlc2t0b3AvTHVrZV9TdHVmZi9HaXRIdWIvU0MvY29yZS9zcmMvdHJhbnNwb3J0L1RyYW5zcG9ydC50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGVzdHMgZm9yIFRyYW5zcG9ydCBBYnN0cmFjdGlvbiBMYXllclxuICovXG5cbmltcG9ydCB7XG4gIFRyYW5zcG9ydE1lc3NhZ2UsXG4gIFRyYW5zcG9ydEV2ZW50cyxcbiAgVHJhbnNwb3J0UGVlcklkLFxuICBEZWZhdWx0VHJhbnNwb3J0UmVnaXN0cnksXG59IGZyb20gXCIuL1RyYW5zcG9ydC5qc1wiO1xuaW1wb3J0IHsgTW9ja1RyYW5zcG9ydCwgY2xlYXJNb2NrTmV0d29yaywgZ2V0TW9ja05ldHdvcmtQZWVycyB9IGZyb20gXCIuL19fbW9ja3NfXy9Nb2NrVHJhbnNwb3J0LmpzXCI7XG5cbmRlc2NyaWJlKFwiVHJhbnNwb3J0IEFic3RyYWN0aW9uXCIsICgpID0+IHtcbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBjbGVhck1vY2tOZXR3b3JrKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKFwiTW9ja1RyYW5zcG9ydFwiLCAoKSA9PiB7XG4gICAgaXQoXCJzaG91bGQgc3RhcnQgYW5kIHN0b3AgY29ycmVjdGx5XCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zcG9ydCA9IG5ldyBNb2NrVHJhbnNwb3J0KFwicGVlci0xXCIpO1xuICAgICAgY29uc3QgZXZlbnRzOiBUcmFuc3BvcnRFdmVudHMgPSB7XG4gICAgICAgIG9uTWVzc2FnZTogamVzdC5mbigpLFxuICAgICAgfTtcblxuICAgICAgZXhwZWN0KHRyYW5zcG9ydC5pc1RyYW5zcG9ydFJ1bm5pbmcoKSkudG9CZShmYWxzZSk7XG5cbiAgICAgIGF3YWl0IHRyYW5zcG9ydC5zdGFydChldmVudHMpO1xuICAgICAgZXhwZWN0KHRyYW5zcG9ydC5pc1RyYW5zcG9ydFJ1bm5pbmcoKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChnZXRNb2NrTmV0d29ya1BlZXJzKCkpLnRvQ29udGFpbihcInBlZXItMVwiKTtcblxuICAgICAgYXdhaXQgdHJhbnNwb3J0LnN0b3AoKTtcbiAgICAgIGV4cGVjdCh0cmFuc3BvcnQuaXNUcmFuc3BvcnRSdW5uaW5nKCkpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGdldE1vY2tOZXR3b3JrUGVlcnMoKSkubm90LnRvQ29udGFpbihcInBlZXItMVwiKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGNvbm5lY3QgdHdvIHBlZXJzXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zcG9ydDEgPSBuZXcgTW9ja1RyYW5zcG9ydChcInBlZXItMVwiKTtcbiAgICAgIGNvbnN0IHRyYW5zcG9ydDIgPSBuZXcgTW9ja1RyYW5zcG9ydChcInBlZXItMlwiKTtcblxuICAgICAgY29uc3QgZXZlbnRzMTogVHJhbnNwb3J0RXZlbnRzID0ge1xuICAgICAgICBvbk1lc3NhZ2U6IGplc3QuZm4oKSxcbiAgICAgICAgb25QZWVyQ29ubmVjdGVkOiBqZXN0LmZuKCksXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBldmVudHMyOiBUcmFuc3BvcnRFdmVudHMgPSB7XG4gICAgICAgIG9uTWVzc2FnZTogamVzdC5mbigpLFxuICAgICAgICBvblBlZXJDb25uZWN0ZWQ6IGplc3QuZm4oKSxcbiAgICAgIH07XG5cbiAgICAgIGF3YWl0IHRyYW5zcG9ydDEuc3RhcnQoZXZlbnRzMSk7XG4gICAgICBhd2FpdCB0cmFuc3BvcnQyLnN0YXJ0KGV2ZW50czIpO1xuXG4gICAgICBhd2FpdCB0cmFuc3BvcnQxLmNvbm5lY3QoXCJwZWVyLTJcIik7XG5cbiAgICAgIGV4cGVjdCh0cmFuc3BvcnQxLmdldENvbm5lY3RlZFBlZXJzKCkpLnRvQ29udGFpbihcInBlZXItMlwiKTtcbiAgICAgIGV4cGVjdCh0cmFuc3BvcnQyLmdldENvbm5lY3RlZFBlZXJzKCkpLnRvQ29udGFpbihcInBlZXItMVwiKTtcbiAgICAgIGV4cGVjdChldmVudHMxLm9uUGVlckNvbm5lY3RlZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXCJwZWVyLTJcIiwgZXhwZWN0LmFueShPYmplY3QpKTtcbiAgICAgIGV4cGVjdChldmVudHMyLm9uUGVlckNvbm5lY3RlZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXCJwZWVyLTFcIiwgZXhwZWN0LmFueShPYmplY3QpKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIHNlbmQgbWVzc2FnZXMgYmV0d2VlbiBwZWVyc1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0cmFuc3BvcnQxID0gbmV3IE1vY2tUcmFuc3BvcnQoXCJwZWVyLTFcIik7XG4gICAgICBjb25zdCB0cmFuc3BvcnQyID0gbmV3IE1vY2tUcmFuc3BvcnQoXCJwZWVyLTJcIik7XG5cbiAgICAgIGNvbnN0IHJlY2VpdmVkTWVzc2FnZXM6IFRyYW5zcG9ydE1lc3NhZ2VbXSA9IFtdO1xuXG4gICAgICBjb25zdCBldmVudHMxOiBUcmFuc3BvcnRFdmVudHMgPSB7XG4gICAgICAgIG9uTWVzc2FnZTogamVzdC5mbigpLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgZXZlbnRzMjogVHJhbnNwb3J0RXZlbnRzID0ge1xuICAgICAgICBvbk1lc3NhZ2U6IChtc2c6IFRyYW5zcG9ydE1lc3NhZ2UpID0+IHJlY2VpdmVkTWVzc2FnZXMucHVzaChtc2cpLFxuICAgICAgfTtcblxuICAgICAgYXdhaXQgdHJhbnNwb3J0MS5zdGFydChldmVudHMxKTtcbiAgICAgIGF3YWl0IHRyYW5zcG9ydDIuc3RhcnQoZXZlbnRzMik7XG4gICAgICBhd2FpdCB0cmFuc3BvcnQxLmNvbm5lY3QoXCJwZWVyLTJcIik7XG5cbiAgICAgIGNvbnN0IHRlc3RQYXlsb2FkID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKFwiSGVsbG8sIHBlZXItMiFcIik7XG4gICAgICBhd2FpdCB0cmFuc3BvcnQxLnNlbmQoXCJwZWVyLTJcIiwgdGVzdFBheWxvYWQpO1xuXG4gICAgICBleHBlY3QocmVjZWl2ZWRNZXNzYWdlcy5sZW5ndGgpLnRvQmUoMSk7XG4gICAgICBleHBlY3QocmVjZWl2ZWRNZXNzYWdlc1swXS5mcm9tKS50b0JlKFwicGVlci0xXCIpO1xuICAgICAgZXhwZWN0KG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShyZWNlaXZlZE1lc3NhZ2VzWzBdLnBheWxvYWQpKS50b0JlKFwiSGVsbG8sIHBlZXItMiFcIik7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCB0cmFjayBzZW50IGFuZCByZWNlaXZlZCBtZXNzYWdlc1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0cmFuc3BvcnQxID0gbmV3IE1vY2tUcmFuc3BvcnQoXCJwZWVyLTFcIik7XG4gICAgICBjb25zdCB0cmFuc3BvcnQyID0gbmV3IE1vY2tUcmFuc3BvcnQoXCJwZWVyLTJcIik7XG5cbiAgICAgIGF3YWl0IHRyYW5zcG9ydDEuc3RhcnQoeyBvbk1lc3NhZ2U6IGplc3QuZm4oKSB9KTtcbiAgICAgIGF3YWl0IHRyYW5zcG9ydDIuc3RhcnQoeyBvbk1lc3NhZ2U6IGplc3QuZm4oKSB9KTtcbiAgICAgIGF3YWl0IHRyYW5zcG9ydDEuY29ubmVjdChcInBlZXItMlwiKTtcblxuICAgICAgYXdhaXQgdHJhbnNwb3J0MS5zZW5kKFwicGVlci0yXCIsIG5ldyBVaW50OEFycmF5KFsxLCAyLCAzXSkpO1xuICAgICAgYXdhaXQgdHJhbnNwb3J0MS5zZW5kKFwicGVlci0yXCIsIG5ldyBVaW50OEFycmF5KFs0LCA1LCA2XSkpO1xuXG4gICAgICBleHBlY3QodHJhbnNwb3J0MS5zZW50TWVzc2FnZXMubGVuZ3RoKS50b0JlKDIpO1xuICAgICAgZXhwZWN0KHRyYW5zcG9ydDIucmVjZWl2ZWRNZXNzYWdlcy5sZW5ndGgpLnRvQmUoMik7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBicm9hZGNhc3QgdG8gYWxsIGNvbm5lY3RlZCBwZWVyc1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0cmFuc3BvcnQxID0gbmV3IE1vY2tUcmFuc3BvcnQoXCJwZWVyLTFcIik7XG4gICAgICBjb25zdCB0cmFuc3BvcnQyID0gbmV3IE1vY2tUcmFuc3BvcnQoXCJwZWVyLTJcIik7XG4gICAgICBjb25zdCB0cmFuc3BvcnQzID0gbmV3IE1vY2tUcmFuc3BvcnQoXCJwZWVyLTNcIik7XG5cbiAgICAgIGNvbnN0IHJlY2VpdmVkMjogVHJhbnNwb3J0TWVzc2FnZVtdID0gW107XG4gICAgICBjb25zdCByZWNlaXZlZDM6IFRyYW5zcG9ydE1lc3NhZ2VbXSA9IFtdO1xuXG4gICAgICBhd2FpdCB0cmFuc3BvcnQxLnN0YXJ0KHsgb25NZXNzYWdlOiBqZXN0LmZuKCkgfSk7XG4gICAgICBhd2FpdCB0cmFuc3BvcnQyLnN0YXJ0KHsgb25NZXNzYWdlOiAobTogVHJhbnNwb3J0TWVzc2FnZSkgPT4gcmVjZWl2ZWQyLnB1c2gobSkgfSk7XG4gICAgICBhd2FpdCB0cmFuc3BvcnQzLnN0YXJ0KHsgb25NZXNzYWdlOiAobTogVHJhbnNwb3J0TWVzc2FnZSkgPT4gcmVjZWl2ZWQzLnB1c2gobSkgfSk7XG5cbiAgICAgIGF3YWl0IHRyYW5zcG9ydDEuY29ubmVjdChcInBlZXItMlwiKTtcbiAgICAgIGF3YWl0IHRyYW5zcG9ydDEuY29ubmVjdChcInBlZXItM1wiKTtcblxuICAgICAgYXdhaXQgdHJhbnNwb3J0MS5icm9hZGNhc3QobmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKFwiQnJvYWRjYXN0IVwiKSk7XG5cbiAgICAgIGV4cGVjdChyZWNlaXZlZDIubGVuZ3RoKS50b0JlKDEpO1xuICAgICAgZXhwZWN0KHJlY2VpdmVkMy5sZW5ndGgpLnRvQmUoMSk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBleGNsdWRlIHNwZWNpZmllZCBwZWVyIGZyb20gYnJvYWRjYXN0XCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zcG9ydDEgPSBuZXcgTW9ja1RyYW5zcG9ydChcInBlZXItMVwiKTtcbiAgICAgIGNvbnN0IHRyYW5zcG9ydDIgPSBuZXcgTW9ja1RyYW5zcG9ydChcInBlZXItMlwiKTtcbiAgICAgIGNvbnN0IHRyYW5zcG9ydDMgPSBuZXcgTW9ja1RyYW5zcG9ydChcInBlZXItM1wiKTtcblxuICAgICAgY29uc3QgcmVjZWl2ZWQyOiBUcmFuc3BvcnRNZXNzYWdlW10gPSBbXTtcbiAgICAgIGNvbnN0IHJlY2VpdmVkMzogVHJhbnNwb3J0TWVzc2FnZVtdID0gW107XG5cbiAgICAgIGF3YWl0IHRyYW5zcG9ydDEuc3RhcnQoeyBvbk1lc3NhZ2U6IGplc3QuZm4oKSB9KTtcbiAgICAgIGF3YWl0IHRyYW5zcG9ydDIuc3RhcnQoeyBvbk1lc3NhZ2U6IChtOiBUcmFuc3BvcnRNZXNzYWdlKSA9PiByZWNlaXZlZDIucHVzaChtKSB9KTtcbiAgICAgIGF3YWl0IHRyYW5zcG9ydDMuc3RhcnQoeyBvbk1lc3NhZ2U6IChtOiBUcmFuc3BvcnRNZXNzYWdlKSA9PiByZWNlaXZlZDMucHVzaChtKSB9KTtcblxuICAgICAgYXdhaXQgdHJhbnNwb3J0MS5jb25uZWN0KFwicGVlci0yXCIpO1xuICAgICAgYXdhaXQgdHJhbnNwb3J0MS5jb25uZWN0KFwicGVlci0zXCIpO1xuXG4gICAgICBhd2FpdCB0cmFuc3BvcnQxLmJyb2FkY2FzdChuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoXCJCcm9hZGNhc3QhXCIpLCBcInBlZXItMlwiKTtcblxuICAgICAgZXhwZWN0KHJlY2VpdmVkMi5sZW5ndGgpLnRvQmUoMCk7XG4gICAgICBleHBlY3QocmVjZWl2ZWQzLmxlbmd0aCkudG9CZSgxKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGRpc2Nvbm5lY3QgcGVlcnMgY29ycmVjdGx5XCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zcG9ydDEgPSBuZXcgTW9ja1RyYW5zcG9ydChcInBlZXItMVwiKTtcbiAgICAgIGNvbnN0IHRyYW5zcG9ydDIgPSBuZXcgTW9ja1RyYW5zcG9ydChcInBlZXItMlwiKTtcblxuICAgICAgY29uc3QgZGlzY29ubmVjdGVkOiBUcmFuc3BvcnRQZWVySWRbXSA9IFtdO1xuXG4gICAgICBjb25zdCBldmVudHMxOiBUcmFuc3BvcnRFdmVudHMgPSB7XG4gICAgICAgIG9uTWVzc2FnZTogamVzdC5mbigpLFxuICAgICAgICBvblBlZXJEaXNjb25uZWN0ZWQ6IChpZDogVHJhbnNwb3J0UGVlcklkKSA9PiBkaXNjb25uZWN0ZWQucHVzaChpZCksXG4gICAgICB9O1xuXG4gICAgICBhd2FpdCB0cmFuc3BvcnQxLnN0YXJ0KGV2ZW50czEpO1xuICAgICAgYXdhaXQgdHJhbnNwb3J0Mi5zdGFydCh7IG9uTWVzc2FnZTogamVzdC5mbigpIH0pO1xuICAgICAgYXdhaXQgdHJhbnNwb3J0MS5jb25uZWN0KFwicGVlci0yXCIpO1xuXG4gICAgICBleHBlY3QodHJhbnNwb3J0MS5nZXRDb25uZWN0ZWRQZWVycygpKS50b0NvbnRhaW4oXCJwZWVyLTJcIik7XG5cbiAgICAgIGF3YWl0IHRyYW5zcG9ydDEuZGlzY29ubmVjdChcInBlZXItMlwiKTtcblxuICAgICAgZXhwZWN0KHRyYW5zcG9ydDEuZ2V0Q29ubmVjdGVkUGVlcnMoKSkubm90LnRvQ29udGFpbihcInBlZXItMlwiKTtcbiAgICAgIGV4cGVjdChkaXNjb25uZWN0ZWQpLnRvQ29udGFpbihcInBlZXItMlwiKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGhhbmRsZSBjb25uZWN0aW9uIGZhaWx1cmVzXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zcG9ydCA9IG5ldyBNb2NrVHJhbnNwb3J0KFwicGVlci0xXCIsIHsgZmFpbENvbm5lY3Rpb25zOiB0cnVlIH0pO1xuICAgICAgY29uc3QgZXJyb3JzOiBFcnJvcltdID0gW107XG5cbiAgICAgIGF3YWl0IHRyYW5zcG9ydC5zdGFydCh7XG4gICAgICAgIG9uTWVzc2FnZTogamVzdC5mbigpLFxuICAgICAgICBvbkVycm9yOiAoZXJyOiBFcnJvcikgPT4gZXJyb3JzLnB1c2goZXJyKSxcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBleHBlY3QodHJhbnNwb3J0LmNvbm5lY3QoXCJwZWVyLTJcIikpLnJlamVjdHMudG9UaHJvdyhcIkNvbm5lY3Rpb24gdG8gcGVlci0yIGZhaWxlZFwiKTtcbiAgICAgIGV4cGVjdChlcnJvcnMubGVuZ3RoKS50b0JlKDEpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgaGFuZGxlIHNlbmQgZmFpbHVyZXNcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdHJhbnNwb3J0MSA9IG5ldyBNb2NrVHJhbnNwb3J0KFwicGVlci0xXCIpO1xuICAgICAgY29uc3QgdHJhbnNwb3J0MiA9IG5ldyBNb2NrVHJhbnNwb3J0KFwicGVlci0yXCIpO1xuXG4gICAgICBjb25zdCBlcnJvcnM6IEVycm9yW10gPSBbXTtcbiAgICAgIGF3YWl0IHRyYW5zcG9ydDEuc3RhcnQoe1xuICAgICAgICBvbk1lc3NhZ2U6IGplc3QuZm4oKSxcbiAgICAgICAgb25FcnJvcjogKGVycjogRXJyb3IpID0+IGVycm9ycy5wdXNoKGVyciksXG4gICAgICB9KTtcbiAgICAgIGF3YWl0IHRyYW5zcG9ydDIuc3RhcnQoeyBvbk1lc3NhZ2U6IGplc3QuZm4oKSB9KTtcbiAgICAgIGF3YWl0IHRyYW5zcG9ydDEuY29ubmVjdChcInBlZXItMlwiKTtcblxuICAgICAgdHJhbnNwb3J0MS51cGRhdGVDb25maWcoeyBmYWlsU2VuZHM6IHRydWUgfSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdCh0cmFuc3BvcnQxLnNlbmQoXCJwZWVyLTJcIiwgbmV3IFVpbnQ4QXJyYXkoWzFdKSkpLnJlamVjdHMudG9UaHJvdygpO1xuICAgICAgZXhwZWN0KGVycm9ycy5sZW5ndGgpLnRvQmUoMSk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBzaW11bGF0ZSBsYXRlbmN5XCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zcG9ydDEgPSBuZXcgTW9ja1RyYW5zcG9ydChcInBlZXItMVwiLCB7IGxhdGVuY3lNczogNTAgfSk7XG4gICAgICBjb25zdCB0cmFuc3BvcnQyID0gbmV3IE1vY2tUcmFuc3BvcnQoXCJwZWVyLTJcIik7XG5cbiAgICAgIGxldCByZWNlaXZlZEF0ID0gMDtcbiAgICAgIGF3YWl0IHRyYW5zcG9ydDEuc3RhcnQoeyBvbk1lc3NhZ2U6IGplc3QuZm4oKSB9KTtcbiAgICAgIGF3YWl0IHRyYW5zcG9ydDIuc3RhcnQoe1xuICAgICAgICBvbk1lc3NhZ2U6ICgpID0+IHtcbiAgICAgICAgICByZWNlaXZlZEF0ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgICAgYXdhaXQgdHJhbnNwb3J0MS5jb25uZWN0KFwicGVlci0yXCIpO1xuXG4gICAgICBjb25zdCBzZW50QXQgPSBEYXRlLm5vdygpO1xuICAgICAgYXdhaXQgdHJhbnNwb3J0MS5zZW5kKFwicGVlci0yXCIsIG5ldyBVaW50OEFycmF5KFsxXSkpO1xuXG4gICAgICAvLyBTaG91bGQgaGF2ZSBzb21lIGxhdGVuY3lcbiAgICAgIGV4cGVjdChyZWNlaXZlZEF0IC0gc2VudEF0KS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDQwKTsgLy8gQWxsb3cgc29tZSB2YXJpYW5jZVxuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgc2ltdWxhdGUgcGFja2V0IGxvc3NcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdHJhbnNwb3J0MSA9IG5ldyBNb2NrVHJhbnNwb3J0KFwicGVlci0xXCIsIHsgcGFja2V0TG9zc1JhdGU6IDEgfSk7IC8vIDEwMCUgbG9zc1xuICAgICAgY29uc3QgdHJhbnNwb3J0MiA9IG5ldyBNb2NrVHJhbnNwb3J0KFwicGVlci0yXCIpO1xuXG4gICAgICBjb25zdCByZWNlaXZlZDogVHJhbnNwb3J0TWVzc2FnZVtdID0gW107XG5cbiAgICAgIGF3YWl0IHRyYW5zcG9ydDEuc3RhcnQoeyBvbk1lc3NhZ2U6IGplc3QuZm4oKSB9KTtcbiAgICAgIGF3YWl0IHRyYW5zcG9ydDIuc3RhcnQoeyBvbk1lc3NhZ2U6IChtOiBUcmFuc3BvcnRNZXNzYWdlKSA9PiByZWNlaXZlZC5wdXNoKG0pIH0pO1xuICAgICAgYXdhaXQgdHJhbnNwb3J0MS5jb25uZWN0KFwicGVlci0yXCIpO1xuXG4gICAgICBhd2FpdCB0cmFuc3BvcnQxLnNlbmQoXCJwZWVyLTJcIiwgbmV3IFVpbnQ4QXJyYXkoWzFdKSk7XG4gICAgICBhd2FpdCB0cmFuc3BvcnQxLnNlbmQoXCJwZWVyLTJcIiwgbmV3IFVpbnQ4QXJyYXkoWzJdKSk7XG4gICAgICBhd2FpdCB0cmFuc3BvcnQxLnNlbmQoXCJwZWVyLTJcIiwgbmV3IFVpbnQ4QXJyYXkoWzNdKSk7XG5cbiAgICAgIGV4cGVjdChyZWNlaXZlZC5sZW5ndGgpLnRvQmUoMCk7IC8vIEFsbCBtZXNzYWdlcyBsb3N0XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBnZXQgcGVlciBpbmZvIGNvcnJlY3RseVwiLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0cmFuc3BvcnQxID0gbmV3IE1vY2tUcmFuc3BvcnQoXCJwZWVyLTFcIik7XG4gICAgICBjb25zdCB0cmFuc3BvcnQyID0gbmV3IE1vY2tUcmFuc3BvcnQoXCJwZWVyLTJcIik7XG5cbiAgICAgIGF3YWl0IHRyYW5zcG9ydDEuc3RhcnQoeyBvbk1lc3NhZ2U6IGplc3QuZm4oKSB9KTtcbiAgICAgIGF3YWl0IHRyYW5zcG9ydDIuc3RhcnQoeyBvbk1lc3NhZ2U6IGplc3QuZm4oKSB9KTtcbiAgICAgIGF3YWl0IHRyYW5zcG9ydDEuY29ubmVjdChcInBlZXItMlwiKTtcblxuICAgICAgY29uc3QgcGVlckluZm8gPSB0cmFuc3BvcnQxLmdldFBlZXJJbmZvKFwicGVlci0yXCIpO1xuICAgICAgZXhwZWN0KHBlZXJJbmZvKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHBlZXJJbmZvPy5wZWVySWQpLnRvQmUoXCJwZWVyLTJcIik7XG4gICAgICBleHBlY3QocGVlckluZm8/LnN0YXRlKS50b0JlKFwiY29ubmVjdGVkXCIpO1xuICAgICAgZXhwZWN0KHBlZXJJbmZvPy50cmFuc3BvcnRUeXBlKS50b0JlKFwibW9ja1wiKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIHRyYWNrIGNvbm5lY3Rpb24gYXR0ZW1wdHNcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdHJhbnNwb3J0ID0gbmV3IE1vY2tUcmFuc3BvcnQoXCJwZWVyLTFcIik7XG4gICAgICBhd2FpdCB0cmFuc3BvcnQuc3RhcnQoeyBvbk1lc3NhZ2U6IGplc3QuZm4oKSB9KTtcblxuICAgICAgYXdhaXQgdHJhbnNwb3J0LmNvbm5lY3QoXCJwZWVyLTJcIik7XG4gICAgICBhd2FpdCB0cmFuc3BvcnQuY29ubmVjdChcInBlZXItM1wiKTtcblxuICAgICAgZXhwZWN0KHRyYW5zcG9ydC5jb25uZWN0aW9uQXR0ZW1wdHMpLnRvRXF1YWwoW1wicGVlci0yXCIsIFwicGVlci0zXCJdKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIHJlc2V0IHRyYWNraW5nIGRhdGFcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdHJhbnNwb3J0ID0gbmV3IE1vY2tUcmFuc3BvcnQoXCJwZWVyLTFcIik7XG4gICAgICBhd2FpdCB0cmFuc3BvcnQuc3RhcnQoeyBvbk1lc3NhZ2U6IGplc3QuZm4oKSB9KTtcblxuICAgICAgYXdhaXQgdHJhbnNwb3J0LmNvbm5lY3QoXCJwZWVyLTJcIik7XG4gICAgICB0cmFuc3BvcnQuc2VudE1lc3NhZ2VzLnB1c2goe30gYXMgVHJhbnNwb3J0TWVzc2FnZSk7XG4gICAgICB0cmFuc3BvcnQucmVjZWl2ZWRNZXNzYWdlcy5wdXNoKHt9IGFzIFRyYW5zcG9ydE1lc3NhZ2UpO1xuXG4gICAgICB0cmFuc3BvcnQucmVzZXRUcmFja2luZygpO1xuXG4gICAgICBleHBlY3QodHJhbnNwb3J0LnNlbnRNZXNzYWdlcy5sZW5ndGgpLnRvQmUoMCk7XG4gICAgICBleHBlY3QodHJhbnNwb3J0LnJlY2VpdmVkTWVzc2FnZXMubGVuZ3RoKS50b0JlKDApO1xuICAgICAgZXhwZWN0KHRyYW5zcG9ydC5jb25uZWN0aW9uQXR0ZW1wdHMubGVuZ3RoKS50b0JlKDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZShcIlRyYW5zcG9ydFJlZ2lzdHJ5XCIsICgpID0+IHtcbiAgICBpdChcInNob3VsZCByZWdpc3RlciBhbmQgcmV0cmlldmUgdHJhbnNwb3J0IGZhY3Rvcmllc1wiLCAoKSA9PiB7XG4gICAgICBjb25zdCByZWdpc3RyeSA9IG5ldyBEZWZhdWx0VHJhbnNwb3J0UmVnaXN0cnkoKTtcbiAgICAgIGNvbnN0IGZhY3RvcnkgPSBqZXN0LmZuKCgpID0+IG5ldyBNb2NrVHJhbnNwb3J0KFwidGVzdFwiKSk7XG5cbiAgICAgIHJlZ2lzdHJ5LnJlZ2lzdGVyKFwidGVzdC10cmFuc3BvcnRcIiwgZmFjdG9yeSk7XG5cbiAgICAgIGNvbnN0IHJldHJpZXZlZCA9IHJlZ2lzdHJ5LmdldChcInRlc3QtdHJhbnNwb3J0XCIpO1xuICAgICAgZXhwZWN0KHJldHJpZXZlZCkudG9CZShmYWN0b3J5KTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIHJldHVybiB1bmRlZmluZWQgZm9yIHVucmVnaXN0ZXJlZCB0eXBlc1wiLCAoKSA9PiB7XG4gICAgICBjb25zdCByZWdpc3RyeSA9IG5ldyBEZWZhdWx0VHJhbnNwb3J0UmVnaXN0cnkoKTtcbiAgICAgIGV4cGVjdChyZWdpc3RyeS5nZXQoXCJub25leGlzdGVudFwiKSkudG9CZVVuZGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgbGlzdCBhbGwgcmVnaXN0ZXJlZCB0eXBlc1wiLCAoKSA9PiB7XG4gICAgICBjb25zdCByZWdpc3RyeSA9IG5ldyBEZWZhdWx0VHJhbnNwb3J0UmVnaXN0cnkoKTtcbiAgICAgIHJlZ2lzdHJ5LnJlZ2lzdGVyKFwidHlwZTFcIiwgamVzdC5mbigpKTtcbiAgICAgIHJlZ2lzdHJ5LnJlZ2lzdGVyKFwidHlwZTJcIiwgamVzdC5mbigpKTtcbiAgICAgIHJlZ2lzdHJ5LnJlZ2lzdGVyKFwidHlwZTNcIiwgamVzdC5mbigpKTtcblxuICAgICAgY29uc3QgdHlwZXMgPSByZWdpc3RyeS5nZXRUeXBlcygpO1xuICAgICAgZXhwZWN0KHR5cGVzKS50b0NvbnRhaW4oXCJ0eXBlMVwiKTtcbiAgICAgIGV4cGVjdCh0eXBlcykudG9Db250YWluKFwidHlwZTJcIik7XG4gICAgICBleHBlY3QodHlwZXMpLnRvQ29udGFpbihcInR5cGUzXCIpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZShcImNsZWFyTW9ja05ldHdvcmtcIiwgKCkgPT4ge1xuICAgIGl0KFwic2hvdWxkIGNsZWFyIGFsbCByZWdpc3RlcmVkIG1vY2sgdHJhbnNwb3J0c1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0cmFuc3BvcnQxID0gbmV3IE1vY2tUcmFuc3BvcnQoXCJwZWVyLTFcIik7XG4gICAgICBjb25zdCB0cmFuc3BvcnQyID0gbmV3IE1vY2tUcmFuc3BvcnQoXCJwZWVyLTJcIik7XG5cbiAgICAgIGF3YWl0IHRyYW5zcG9ydDEuc3RhcnQoeyBvbk1lc3NhZ2U6IGplc3QuZm4oKSB9KTtcbiAgICAgIGF3YWl0IHRyYW5zcG9ydDIuc3RhcnQoeyBvbk1lc3NhZ2U6IGplc3QuZm4oKSB9KTtcblxuICAgICAgZXhwZWN0KGdldE1vY2tOZXR3b3JrUGVlcnMoKS5sZW5ndGgpLnRvQmUoMik7XG5cbiAgICAgIGNsZWFyTW9ja05ldHdvcmsoKTtcblxuICAgICAgZXhwZWN0KGdldE1vY2tOZXR3b3JrUGVlcnMoKS5sZW5ndGgpLnRvQmUoMCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=